


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>woo.pyderived &#8212; Woo 1.0+rev1-git-ea14c91 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/cloud.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="shortcut icon" href="_static/woo-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="woo.qt" href="woo.qt.html" />
    <link rel="prev" title="woo.pre" href="woo.pre.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="woo.qt.html" title="woo.qt"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="woo.pre.html" title="woo.pre"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="index.html">Woo 1.0+rev1-git-ea14c91 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="wooMods.html" accesskey="U">Woo modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">woo.pyderived</span></code></a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-woo.pyderived">
<span id="woo-pyderived"></span><h1><a class="reference internal" href="#module-woo.pyderived" title="woo.pyderived"><code class="xref py py-mod docutils literal notranslate"><span class="pre">woo.pyderived</span></code></a><a class="headerlink" href="#module-woo.pyderived" title="Permalink to this headline">¶</a></h1>
<p>Support subclassing c++ objects in python, with some limitations. Useful primarily for pure-python preprocessors.</p>
<dl class="py class">
<dt class="sig sig-object py" id="woo.pyderived.PyAttrTrait">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">woo.pyderived.</span></span><span class="sig-name descname"><span class="pre">PyAttrTrait</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noGui</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noDump</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rgbColor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startGroup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hideIf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">choice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buttons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altUnits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">existingFilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triggerPostLoad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guiReadonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noGuiResize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deprecated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/woo/pyderived.html#PyAttrTrait"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#woo.pyderived.PyAttrTrait" title="Permalink to this definition">¶</a></dt>
<dd><p>Class mimicking the <cite>AttrTrait</cite> template in c++, to be used when deriving from <a class="reference internal" href="#woo.pyderived.PyWooObject" title="woo.pyderived.PyWooObject"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PyWooObject</span></code></a>, like in this example (can be found in <cite>woo.pyderived</cite> module’s source):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">_SamplePyDerivedPreprocessor</span><span class="p">(</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Preprocessor</span><span class="p">,</span><span class="n">PyWooObject</span><span class="p">):</span>
    <span class="s1">&#39;Sample preprocessor written in pure python&#39;</span>
    <span class="n">_attrTraits</span><span class="o">=</span><span class="p">[</span>
        <span class="n">PyAttrTrait</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span><span class="s1">&#39;switch&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="s2">&quot;Some bool switch, starting group&quot;</span><span class="p">,</span><span class="n">startGroup</span><span class="o">=</span><span class="s1">&#39;General&#39;</span><span class="p">),</span>
        <span class="n">PyAttrTrait</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Integer argument in python&quot;</span><span class="p">),</span>
        <span class="n">PyAttrTrait</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;whatever&#39;</span><span class="p">,</span><span class="s2">&quot;String argument in python&quot;</span><span class="p">),</span>
        <span class="n">PyAttrTrait</span><span class="p">([</span><span class="n">Node</span><span class="p">,],</span><span class="s1">&#39;c&#39;</span><span class="p">,[],</span><span class="s2">&quot;List of nodes in python&quot;</span><span class="p">),</span>
        <span class="n">PyAttrTrait</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="s2">&quot;Parameter with range&quot;</span><span class="p">,</span><span class="nb">range</span><span class="o">=</span><span class="n">Vector2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">7</span><span class="p">),</span><span class="n">startGroup</span><span class="o">=</span><span class="s1">&#39;Advanced&#39;</span><span class="p">),</span>
        <span class="n">PyAttrTrait</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="s1">&#39;choice&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Param with choice&quot;</span><span class="p">,</span><span class="n">choice</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;choice0&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;choice1&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;choice2&#39;</span><span class="p">)]),</span>
        <span class="n">PyAttrTrait</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="s1">&#39;flags&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;Param with bits&quot;</span><span class="p">,</span><span class="n">bits</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bit0&#39;</span><span class="p">,</span><span class="s1">&#39;bit1&#39;</span><span class="p">,</span><span class="s1">&#39;bit2&#39;</span><span class="p">,</span><span class="s1">&#39;bit3&#39;</span><span class="p">,</span><span class="s1">&#39;bit4&#39;</span><span class="p">],</span><span class="n">buttons</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;Clear flags&#39;</span><span class="p">,</span><span class="s1">&#39;self.flags=0&#39;</span><span class="p">,</span><span class="s1">&#39;Set flags to zero&#39;</span><span class="p">],</span><span class="kc">True</span><span class="p">)),</span>
        <span class="n">PyAttrTrait</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="s1">&#39;choice2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Param with unnamed choice&#39;</span><span class="p">,</span><span class="n">choice</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
        <span class="n">PyAttrTrait</span><span class="p">(</span><span class="n">Vector3</span><span class="p">,</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="n">Vector3</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span><span class="o">.</span><span class="mi">2</span><span class="p">),</span><span class="s2">&quot;Color parameter&quot;</span><span class="p">,</span><span class="n">rgbColor</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">PyAttrTrait</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="s1">&#39;length&#39;</span><span class="p">,</span><span class="mf">1.5e-3</span><span class="p">,</span><span class="s2">&quot;Length&quot;</span><span class="p">,</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;mm&#39;</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="c1"># this is needed for new-style pickling with pybind11</span>
    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">=</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">klass</span><span class="p">)</span>
        <span class="c1"># do not use self.__class__ here, it would break classes derived further from this class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wooPyInit</span><span class="p">(</span><span class="n">SamplePyDerivedPreprocessor</span><span class="p">,</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Preprocessor</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="c1"># this is needed for old-style pickling with boost::python</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Preprocessor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wooPyInit</span><span class="p">(</span><span class="n">SamplePyDerivedPreprocessor</span><span class="p">,</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Preprocessor</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span> 
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
        <span class="c1"># ...</span>
</pre></div>
</div>
<p>This class will be represented like this in the GUI:</p>
<img alt="_images/pyderived-gui.png" src="_images/pyderived-gui.png" />
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyType</strong> – <p>python type object; can be</p>
<ul>
<li><p>primitive type (like <cite>bool</cite>, <cite>float</cite>, <cite>Vector3</cite>, <cite>str</cite>, …)</p></li>
<li><p>sequence of primitive types, written as 1-list: <cite>[bool,]</cite>, <cite>[float,]</cite>, …</p></li>
<li><p><a class="reference internal" href="woo.core.html#woo.core.Object" title="woo.core.Object"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo</span> <span class="pre">Object</span></code></a> or any derived type (<a class="reference internal" href="woo.core.html#woo.core.Node" title="woo.core.Node"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.core.Node</span></code></a>, <a class="reference internal" href="woo.dem.html#woo.dem.Sphere" title="woo.dem.Sphere"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.dem.Sphere</span></code></a>, …)</p></li>
<li><p>sequence of woo objects, e.g. <cite>[woo.core.Node,]</cite></p></li>
</ul>
<p>When a value is assigned to the attribute, provided type must be convertible to <em>pyType</em>, otherwise <cite>TypeError</cite> is raised. There are some additional restrictions:</p>
<ul>
<li><p><cite>str</cite> and <cite>unicode</cite> values will <em>not</em> be converted to <cite>floats</cite> and such − although python will accept <cite>float(‘1.23’)</cite></p></li>
</ul>
</p></li>
<li><p><strong>name</strong> – name of the attribute, given as <cite>str</cite></p></li>
<li><p><strong>ini</strong> – initial (default) value of the attribute</p></li>
<li><p><strong>doc</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – documentation for this attribute, as it appears in generated docs and tooltips in the UI</p></li>
<li><p><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>unit given as string, which is looked up in <code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.unit</span></code>; the multiplier is the ratio between <em>unit</em> and associated basic unit, which is found automatically.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><cite>unit</cite> only determines multiplier for the GUI representation; it has no impact on the internal value used; in particular, the <em>ini</em> value is <em>unit-less</em>. If you want to give units to the initial value, say something like <code class="docutils literal notranslate"><span class="pre">PyAttrTrait(float,'angle',60*woo.unit['deg'],units='deg','This</span> <span class="pre">is</span> <span class="pre">some</span> <span class="pre">angle')</span></code>.</p>
</div>
</p></li>
<li><p><strong>noGui</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – do not show this attribute in the GUI; use this for attributes which the GUI does not know how to represent (such as python objects, numpy arrays and such), to avoid warnings.</p></li>
<li><p><strong>noDump</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – skip this attribute when dumping/loading this object; that means that after loading (or after a <code class="xref py py-obj docutils literal notranslate"><span class="pre">PyWooObjects.deepcopy</span></code>), the attribute will be default-initialized.</p></li>
<li><p><strong>rgbColor</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – this attribute is color in the RGB space (its type must be <cite>Vector3</cite>); the GUI will show color picker.</p></li>
<li><p><strong>startGroup</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – start new attribute group, which is represented as collapsible blocks in the GUI.</p></li>
<li><p><strong>hideIf</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – python expression which determines whether the GUI hide/show this attribute entry dynamically; use <cite>self</cite> to refer to the instance, as usual.</p></li>
<li><p><strong>range</strong> – give range (<cite>Vector2</cite> or <cite>Vector2i</cite>) to this numerical (<cite>float</cite> or <cite>int</cite>) attribute − a slider will be shown in the GUI.</p></li>
<li><p><strong>choice</strong> – <p>this attribute chooses from predefined set of integer values; <cite>choice</cite> itself can be</p>
<ul>
<li><p>list of unnamed values, e.g. <cite>[0,1,2,3,4]</cite> to choose from;</p></li>
<li><p>list of named values, e.g. <cite>[(0,’choice0’),(1,’choice1’),(2,’choice2’)]</cite>, where the name will be displayed in the GUI, and the number will be assigned when the choice is made.</p></li>
</ul>
</p></li>
<li><p><strong>bits</strong> – give names for bit values which this (integer) attribute which represents; they will be shown as array of checkboxes in the GUI.</p></li>
<li><p><strong>buttons</strong> – <p>Tuple of <em>list</em> and <em>bool</em>; in the flat list of strings, where each consecutive triplet contains</p>
<ol class="arabic simple">
<li><p>button label</p></li>
<li><p>python expression to evaluate when the button is clicked</p></li>
<li><p>label to be shown as button description in the GUI</p></li>
</ol>
<p>The bool at the end determined whether the button is created above (<em>True</em>) or below (<em>False</em>) the current attribute.</p>
</p></li>
<li><p><strong>filename</strong> – <cite>str</cite> attribute representing filename with file picker in the GUI; the file is possibly non-existent.</p></li>
<li><p><strong>existingFilename</strong> – <cite>str</cite> attribute for existing filename, with file picker in the GUI.</p></li>
<li><p><strong>dirname</strong> – <cite>str</cite> attribute for existing directory name, with directory picker in the GUI.</p></li>
<li><p><strong>triggerPostLoad</strong> – when this attribute is being assigned to, <cite>self.postLoad(‘attrName’)</cite> will be called.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="woo.pyderived.PyAttrTrait.coerceValue">
<span class="sig-name descname"><span class="pre">coerceValue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/woo/pyderived.html#PyAttrTrait.coerceValue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#woo.pyderived.PyAttrTrait.coerceValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether <em>val</em> has type compatible with declared type (pyType). Raise exception if not. Values converted to required types are returned (it is safe to ignore the return value). In addition, validate the (converted) value, if a validator is defined</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woo.pyderived.PyAttrTrait.primitiveTypes">
<span class="sig-name descname"><span class="pre">primitiveTypes</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{&lt;class</span> <span class="pre">'int'&gt;:</span> <span class="pre">'int',</span> <span class="pre">&lt;class</span> <span class="pre">'str'&gt;:</span> <span class="pre">'string',</span> <span class="pre">&lt;class</span> <span class="pre">'float'&gt;:</span> <span class="pre">'Real',</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;:</span> <span class="pre">'bool',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.Vector2'&gt;:</span> <span class="pre">'Vector2r',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.Vector3'&gt;:</span> <span class="pre">'Vector3r',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.Vector6'&gt;:</span> <span class="pre">'Vector6r',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.Matrix3'&gt;:</span> <span class="pre">'Matrix3r',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.Matrix6'&gt;:</span> <span class="pre">'Matrix6r',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.Quaternion'&gt;:</span> <span class="pre">'Quaternionr',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.Vector2i'&gt;:</span> <span class="pre">'Vector2i',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.Vector3i'&gt;:</span> <span class="pre">'Vector3i',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.Vector6i'&gt;:</span> <span class="pre">'Vector6i',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.AlignedBox3'&gt;:</span> <span class="pre">'AlignedBox3r',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.MatrixX'&gt;:</span> <span class="pre">'MatrixXr',</span> <span class="pre">&lt;class</span> <span class="pre">'_wooEigen11.VectorX'&gt;:</span> <span class="pre">'VectorXr'}</span></em><a class="headerlink" href="#woo.pyderived.PyAttrTrait.primitiveTypes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woo.pyderived.PyAttrTrait.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/woo/pyderived.html#PyAttrTrait.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#woo.pyderived.PyAttrTrait.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when the attribute is set</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woo.pyderived.PyWooObject">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">woo.pyderived.</span></span><span class="sig-name descname"><span class="pre">PyWooObject</span></span><a class="reference internal" href="_modules/woo/pyderived.html#PyWooObject"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#woo.pyderived.PyWooObject" title="Permalink to this definition">¶</a></dt>
<dd><p>Define some c++-compatibility functions for python classes. Derived class is created as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeClass</span><span class="p">(</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span><span class="n">woo</span><span class="o">.</span><span class="n">pyderived</span><span class="o">.</span><span class="n">PyWooObject</span><span class="p">):</span> <span class="c1"># order of base classes important!</span>
    <span class="n">_attrTraits</span><span class="o">=</span><span class="p">[</span>
        <span class="c1"># see below</span>
    <span class="p">]</span>
    <span class="c1"># new-style pickling with pybind11</span>
    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">=</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">klass</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wooPyInit</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="c1"># for old-style pickling with boost::python</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wooPyInit</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>   <span class="c1"># do NOT use self.__class__ instead of SomeClass, that would break classes deriving from SomeClass</span>
</pre></div>
</div>
<p>This new class automatically obtains several features:</p>
<ul class="simple">
<li><p>dumping/loading via <a class="reference internal" href="woo.core.html#woo.core.Object.dump" title="woo.core.Object.dump"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.core.Object.dump</span></code></a> etc works.</p></li>
<li><p>the GUI (<a class="reference internal" href="woo.qt.html#module-woo.qt.ObjectEditor" title="woo.qt.ObjectEditor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.qt.ObjectEditor</span></code></a>) will know how to present this class.</p></li>
<li><p>documentation for this class will be generated</p></li>
<li><p>all attributes are type-checked when assigned</p></li>
<li><p>support for postLoad hooks (see below)</p></li>
</ul>
<p>The <cite>_attrTraits</cite> ist a list of <a class="reference internal" href="#woo.pyderived.PyAttrTrait" title="woo.pyderived.PyAttrTrait"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PyAttrTrait</span></code></a>; each attribute
is defined via its traits, which declare its type, default value, documentation and so on – this
is documented with <a class="reference internal" href="#woo.pyderived.PyAttrTrait" title="woo.pyderived.PyAttrTrait"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PyAttrTrait</span></code></a>.</p>
<p>This example shows trait definitions, and also the <cite>triggerPostLoad</cite> flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeClass</span><span class="p">(</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span><span class="n">woo</span><span class="o">.</span><span class="n">pyderived</span><span class="o">.</span><span class="n">PyWooObject</span><span class="p">):</span>
    <span class="n">_PAT</span><span class="o">=</span><span class="n">woo</span><span class="o">.</span><span class="n">pyderived</span><span class="o">.</span><span class="n">PyAttrTrait</span> <span class="c1"># alias for class name, to save typing</span>
    <span class="n">_attrTraits</span><span class="o">=</span><span class="p">[</span>
        <span class="n">_PAT</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="s1">&#39;aF&#39;</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="s1">&#39;float attr&#39;</span><span class="p">),</span>
        <span class="n">_PAT</span><span class="p">([</span><span class="nb">float</span><span class="p">,],</span><span class="s1">&#39;aFF&#39;</span><span class="p">,[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">],</span><span class="s1">&#39;list of floats attr&#39;</span><span class="p">),</span>
        <span class="n">_PAT</span><span class="p">(</span><span class="n">Vector2</span><span class="p">,</span><span class="s1">&#39;aV2&#39;</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="s1">&#39;vector2 attr&#39;</span><span class="p">),</span>
        <span class="n">_PAT</span><span class="p">([</span><span class="n">Vector2</span><span class="p">,],</span><span class="s1">&#39;aVV2&#39;</span><span class="p">,[(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)],</span><span class="s1">&#39;list of vector2 attr&#39;</span><span class="p">),</span>
        <span class="n">_PAT</span><span class="p">(</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Node</span><span class="p">,</span><span class="s1">&#39;aNode&#39;</span><span class="p">,</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="s1">&#39;node attr&#39;</span><span class="p">),</span>
        <span class="n">_PAT</span><span class="p">([</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Node</span><span class="p">,],</span><span class="s1">&#39;aNNode&#39;</span><span class="p">,[</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))],</span><span class="s1">&#39;List of nodes&#39;</span><span class="p">),</span>
        <span class="n">_PAT</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="s1">&#39;aF_trigger&#39;</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">triggerPostLoad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Float triggering postLoad&#39;</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="k">def</span> <span class="nf">postLoad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">I</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">I</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>                  <span class="c1"># called when constructed/loaded</span>
        <span class="k">elif</span> <span class="n">I</span><span class="o">==</span><span class="s1">&#39;aF_trigger&#39;</span><span class="p">:</span> <span class="k">pass</span> <span class="c1"># called when aF_trigger is modified</span>
    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">pass</span>
        <span class="c1"># ...</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">pass</span>
        <span class="c1"># ...</span>
</pre></div>
</div>
<p>The <cite>postLoad</cite> function is called with</p>
<ul>
<li><p><cite>None</cite> when the instance has just been created (or loaded); it <em>shoud</em> be idempotent, i.e. calling <cite>postLoad(None)</cite> the second time should have no effect:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SomeClass</span><span class="p">()</span>         <span class="c1"># default-constructed; will call postLoad(None)</span>
<span class="n">SomeClass</span><span class="p">(</span><span class="n">aF</span><span class="o">=</span><span class="mf">3.</span><span class="p">)</span>    <span class="c1"># default-construct, assign, call postLoad(None)</span>
</pre></div>
</div>
</li>
<li><p><cite>id(self.attr)</cite> when <cite>self.attr</cite> is modified; this can be used to check for some particular conditions or modify other variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">instance</span><span class="o">=</span><span class="n">SomeClass</span><span class="p">()</span>  <span class="c1"># calls instance.postLoad(None)</span>
<span class="n">instance</span><span class="o">.</span><span class="n">aF_trigger</span><span class="o">=</span><span class="mi">3</span> <span class="c1"># calls instance.postLoad(&#39;aF_trigger&#39;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pay attention to not call <cite>postLoad</cite> in infinite regression.</p>
</div>
</li>
</ul>
<p>Python classes may be further derived from in python, along those lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeChild</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">):</span> <span class="c1"># python base class only</span>
    <span class="n">_PAT</span><span class="o">=</span><span class="n">woo</span><span class="o">.</span><span class="n">pyderived</span><span class="o">.</span><span class="n">PyAttrTrait</span>
    <span class="n">_attrTraits</span><span class="o">=</span><span class="p">[</span>
        <span class="n">_PAT</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="s1">&#39;extraAttr&#39;</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">triggerPostLoad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Attributes as usual; postLoad is supported.&#39;</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="k">def</span> <span class="nf">postLoad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">I</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">I</span><span class="o">==</span><span class="s1">&#39;extraAttr&#39;</span><span class="p">:</span> <span class="k">pass</span>
        <span class="c1"># don&#39;t forget to eventually call parent&#39;s class postLoad, if you define postLoad in the derived class</span>
        <span class="c1"># otherwise the triggers from the parents class would not work</span>
        <span class="k">else</span><span class="p">:</span> <span class="nb">super</span><span class="p">(</span><span class="n">SomeChild</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">postLoad</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
    <span class="c1"># newer pickling (pybind11)</span>
    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">=</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">klass</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wooPyInit</span><span class="p">(</span><span class="n">SomeChild</span><span class="p">,</span><span class="n">SomeClass</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span> <span class="c1"># this class, parent class, keywords</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="c1"># older pickling (boost::python)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">SomeClass</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="c1"># default-construct the parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wooPyInit</span><span class="p">(</span><span class="n">SomeChild</span><span class="p">,</span><span class="n">SomeClass</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span> <span class="c1"># this class, parent class, keywords</span>
</pre></div>
</div>
<p>Derived classes should suppor pickling, GUI, documentation, type-checking, postLoad just like python class deriving from c++ directly. The internal machinery is checked by <code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.tests.core.TestPyDerived</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="woo.pyderived.PyWooObject.wooPyInit">
<span class="sig-name descname"><span class="pre">wooPyInit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">derivedClass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cxxBaseClass</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/woo/pyderived.html#PyWooObject.wooPyInit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#woo.pyderived.PyWooObject.wooPyInit" title="Permalink to this definition">¶</a></dt>
<dd><p>Inject methods into derivedClass, so that it behaves like woo.core.Object,
for the purposes of the GUI and expression dumps</p>
</dd></dl>

</dd></dl>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Report issues or inclarities to <a class="reference external" href="https://github.com/woodem/woo/issues">github</a>.</p>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="woo.pre.html"
                          title="Previous page">&larr; <code class="xref py py-mod docutils literal notranslate"><span class="pre">woo.pre</span></code></a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="woo.qt.html"
                          title="Next page">&rarr; <code class="xref py py-mod docutils literal notranslate"><span class="pre">woo.qt</span></code></a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/woo.pyderived.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="woo.qt.html" title="woo.qt"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="woo.pre.html" title="woo.pre"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="index.html">Woo 1.0+rev1-git-ea14c91 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="wooMods.html" >Woo modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">woo.pyderived</span></code></a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2012−2022, Václav Šmilauer &lt;eu@doxos.eu&gt;.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>