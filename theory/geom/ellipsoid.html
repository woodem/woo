


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Ellipsoid &#8212; Woo 1.0+rev1-git-6a4ccd2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/cloud.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script>window.MathJax = {"loader": {"load": ["[tex]/boldsymbol"]}, "tex": {"macros": {"prev": ["#1^-", 1], "pprev": ["#1^{\\ominus}", 1], "curr": ["#1^{\\circ}", 1], "nnext": ["#1^{\\oplus}", 1], "next": ["#1^{+}", 1], "Dt": "\\Delta t", "tens": ["{\\bf #1}", 1], "vec": ["{\\bf #1}", 1], "quat": ["{\\bf #1}", 1], "mat": ["{\\bf #1}", 1], "u": ["\\,\\mathrm{#1}", 1], "normalized": ["\\frac{#1}{|\\cdot|}", 1], "d": "\\mathrm{d}\\,", "phi": "\\varphi", "eps": "\\varepsilon", "epsilon": "\\varepsilon", "tr": "\\mathop{\\rm tr}\\nolimits"}, "packages": {"[+]": ["boldsymbol"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    
    
     
        <script src="../../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../../_static/cloud.base.js"></script>
    

    
     
        <script src="../../_static/cloud.js"></script>
    

    <link rel="shortcut icon" href="../../_static/woo-favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Capsule" href="capsule.html" />
    <link rel="prev" title="Sphere" href="sphere.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="capsule.html" title="Capsule"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="sphere.html" title="Sphere"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">Woo 1.0+rev1-git-6a4ccd2 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Geometry</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Ellipsoid</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="ellipsoid">
<span id="theory-geom-ellipsoid"></span><h1>Ellipsoid<a class="headerlink" href="#ellipsoid" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="../../woo.dem.html#woo.dem.Ellipsoid" title="woo.dem.Ellipsoid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Elllipsoids</span></code></a> are defined by their local coordinates and three <a class="reference internal" href="../../woo.dem.html#woo.dem.Ellipsoid.semiAxes" title="woo.dem.Ellipsoid.semiAxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">semi-axes</span></code></a>.</p>
<section id="ellipsoid-ellipsoid-contact">
<h2>Ellipsoid-Ellipsoid contact<a class="headerlink" href="#ellipsoid-ellipsoid-contact" title="Permalink to this headline">¶</a></h2>
<p>Thsi algorithm is implemented in by <a class="reference internal" href="../../woo.dem.html#woo.dem.Cg2_Ellipsoid_Ellipsoid_L6Geom" title="woo.dem.Cg2_Ellipsoid_Ellipsoid_L6Geom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.dem.Cg2_Ellipsoid_Ellipsoid_L6Geom</span></code></a>.</p>
<p>Following <span id="id1">[<a class="reference internal" href="../../references.html#id23" title="John W Perram, John Rasmussen, Eigil Præstgaard, and Joel L Lebowitz. Ellipsoid contact potential: theory and relation to overlap potentials. Physical Review E, 54(6):6565, 1996.">PRPraestgaardL96</a>]</span>, we note <a class="reference internal" href="../../woo.dem.html#woo.dem.Ellipsoid.semiAxes" title="woo.dem.Ellipsoid.semiAxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">semi-axes</span></code></a> <span class="math notranslate nohighlight">\(a_i\)</span> and <span class="math notranslate nohighlight">\(b_i\)</span> as <span class="math notranslate nohighlight">\(i\in\{1,2,3\}\)</span>; local axes are given as sets of orthonormal vectors <span class="math notranslate nohighlight">\(\vec{u}_i\)</span>, <span class="math notranslate nohighlight">\(\vec{v}_i\)</span>. The intercenter vector reads <span class="math notranslate nohighlight">\(\vec{R}=\vec{r}_b-\vec{r}_a\)</span>, with <span class="math notranslate nohighlight">\(\vec{r}_a\)</span> and <span class="math notranslate nohighlight">\(\vec{r}_b\)</span> being positions of ellipsoid centroids. We define matrices</p>
<div class="math notranslate nohighlight">
\begin{align*}
   \mat{A}&amp;=\sum_{i=1}^{3} a_i^{-1}\vec{u}_i\vec{u}_i^T \\
   \mat{B}&amp;=\sum_{i=1}^{3} b_i^{-1}\vec{v}_i\vec{v}_i^T
\end{align*}</div><p>which are both invertible for non-vanishing semi-axes; then we define the function</p>
<div class="math notranslate nohighlight" id="equation-perram-wertheim-s-lambda">
<span class="eqno">(1)<a class="headerlink" href="#equation-perram-wertheim-s-lambda" title="Permalink to this equation">¶</a></span>\[S(\lambda)=\lambda(1-\lambda)\vec{R}^T\big[\underbrace{(1-\lambda)\mat{A}^{-1}+\lambda\mat{B}^{-1}}_{\mat{G}}\big]^{-1}\vec{R}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\in[0,1]\)</span> is an unknown parameter. The function <span class="math notranslate nohighlight">\(S(\lambda)\)</span> is concave and non-zero for <span class="math notranslate nohighlight">\(\lambda\in[0,1]\)</span> and zero at both end-points. It therefore has a sigle maximum. Using the <a class="reference external" href="http://en.wikipedia.org/wiki/Brent_method">Brent’s method</a>, we obtain the maximum value <span class="math notranslate nohighlight">\(\Lambda\)</span> for which <span class="math notranslate nohighlight">\(S(\Lambda)\)</span> is maximal.</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>This computation can be (perhaps substantially) sped up by using other iterative methods, such as Newton-Raphson, finding root of <span class="math notranslate nohighlight">\(S'(\lambda)\)</span>, and re-using the value from the previous step as the initial guess. There are also papers suggesting better algorithms such as <span id="id2">[<a class="reference internal" href="../../references.html#id25" title="Xiaoyu Zheng, Wilder Iglesias, and Peter Palffy-Muhoray. Distance of closest approach of two arbitrary hard ellipsoids. Physical Review E, 79(5):057702, 2009.">ZIPM09</a>]</span>.</p>
</div>
<p>We define the Perram-Wertham potential (first introduced in <span id="id4">[<a class="reference internal" href="../../references.html#id24" title="John W Perram and MS Wertheim. Statistical mechanics of hard ellipsoids. i. overlap algorithm and the contact function. Journal of Computational Physics, 58(3):409–416, 1985.">PW85</a>]</span>) as</p>
<div class="math notranslate nohighlight">
\[F_{AB}=\{\max S(\lambda)|\lambda\in[0,1]\}=S(\Lambda)\]</div>
<p>for which (<span id="id5">[<a class="reference internal" href="../../references.html#id24" title="John W Perram and MS Wertheim. Statistical mechanics of hard ellipsoids. i. overlap algorithm and the contact function. Journal of Computational Physics, 58(3):409–416, 1985.">PW85</a>]</span>)</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(F_{AB}&lt;1\)</span> if both ellipsoids overlap,</p></li>
<li><p><span class="math notranslate nohighlight">\(F_{AB}=1\)</span> if they are externaly tangent,</p></li>
<li><p><span class="math notranslate nohighlight">\(F_{AB}&gt;1\)</span> if the ellipsoids do not overlap.</p></li>
</ul>
<p><span id="id6">[<a class="reference internal" href="../../references.html#id24" title="John W Perram and MS Wertheim. Statistical mechanics of hard ellipsoids. i. overlap algorithm and the contact function. Journal of Computational Physics, 58(3):409–416, 1985.">PW85</a>]</span> gives a geometrical interpretation of <span class="math notranslate nohighlight">\(F_{AB}\)</span>, where</p>
<div class="math notranslate nohighlight">
\[F_{AB}=\mu^2\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is scaling factor which must be applied to both ellipses to be tangent.</p>
<p>Following <span id="id7">[<a class="reference internal" href="../../references.html#id22" title="Aleksandar Donev, Salvatore Torquato, and Frank H Stillinger. Neighbor list collision-driven molecular dynamics simulation for nonspherical hard particles.: ii. applications to ellipses and ellipsoids. Journal of Computational Physics, 202(2):765–793, 2005. URL: ftp://crack.seismo.unr.edu/downloads/russell/doven_2005_neighbor_list_collision_driven_MD_II.PDF.">DTS05</a>]</span> eq (18), we can compute the contact normal and the contact point of two ellipsoids as</p>
<div class="math notranslate nohighlight">
\begin{align*}
   \vec{n}_c&amp;=\mat{G}^{-1}\mat{R} \\
   \vec{r}_c&amp;=\vec{r}_a+(1-\Lambda)\mat{A}^{-1}\cdot
\end{align*}</div><p>with <span class="math notranslate nohighlight">\(\mat{G}\)</span> defined in <a class="reference internal" href="#equation-perram-wertheim-s-lambda">(1)</a>; note that <span class="math notranslate nohighlight">\(\vec{n}_c\)</span> is not normalized.</p>
<p>The penetration depth (overlap distance) can be reasoned out as follows. <span class="math notranslate nohighlight">\(\mu\)</span> scaled ellipsoid sizes while keeping their distance, so that they become externally tangent. Therefore <span class="math notranslate nohighlight">\(1/\mu\)</span> scales ellipsoid distance while keeping their sizes. With <span class="math notranslate nohighlight">\(d=|\mat{R}|\)</span> being the current inter-center distance, we obtain</p>
<div class="math notranslate nohighlight">
\[u_n'=d-d_0=d-\frac{1}{\mu}d=d\left(1-\frac{1}{\mu}\right).\]</div>
<p>This is the displacement that msut be performed along <span class="math notranslate nohighlight">\(\vec{R}\)</span> while the contact normal may be oriented differently; we therefore project <span class="math notranslate nohighlight">\(u_n'\)</span> along <span class="math notranslate nohighlight">\(\vec{R}\)</span> onto (normalized) <span class="math notranslate nohighlight">\(\vec{n}_c\)</span> obtaining</p>
<div class="math notranslate nohighlight">
\[u_n=d\left(1-\frac{1}{\mu}\right)\normalized{\vec{R}}\cdot\normalized{\vec{n}_c}.\]</div>
<p>The <span class="math notranslate nohighlight">\(u_n\)</span>, <span class="math notranslate nohighlight">\(\normalized{\vec{n}}\)</span>, <span class="math notranslate nohighlight">\(\vec{r}_c\)</span> can be fed to <a class="reference internal" href="l6geom.html#contact-geometry-l6gom-generic"><span class="std std-ref">Generic contact routine</span></a> for further computation.</p>
</section>
<section id="ellipsoid-wall-intersection">
<h2>Ellipsoid-Wall intersection<a class="headerlink" href="#ellipsoid-wall-intersection" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id8">
<p class="admonition-title">Todo</p>
<p>Write.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Report issues or inclarities to <a class="reference external" href="https://github.com/woodem/woo/issues">github</a>.</p>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="../../contents.html">Page contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Ellipsoid</a><ul>
<li><a class="reference internal" href="#ellipsoid-ellipsoid-contact">Ellipsoid-Ellipsoid contact</a></li>
<li><a class="reference internal" href="#ellipsoid-wall-intersection">Ellipsoid-Wall intersection</a></li>
</ul>
</li>
</ul>

  </div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="sphere.html"
                          title="Previous page">&larr; Sphere</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="capsule.html"
                          title="Next page">&rarr; Capsule</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/theory/geom/ellipsoid.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="capsule.html" title="Capsule"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="sphere.html" title="Sphere"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">Woo 1.0+rev1-git-6a4ccd2 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Geometry</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Ellipsoid</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2012−2022, Václav Šmilauer &lt;eu@doxos.eu&gt;.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>