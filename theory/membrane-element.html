


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Membrane element &#8212; Woo 1.0+rev1-git-797b069 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/cloud.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"loader": {"load": ["[tex]/boldsymbol"]}, "TeX": {"Macros": {"prev": ["#1^-", 1], "pprev": ["#1^{\\ominus}", 1], "curr": ["#1^{\\circ}", 1], "nnext": ["#1^{\\oplus}", 1], "next": ["#1^{+}", 1], "Dt": "\\Delta t", "tens": ["{\\bf #1}", 1], "vec": ["{\\bf #1}", 1], "quat": ["{\\bf #1}", 1], "mat": ["{\\bf #1}", 1], "u": ["\\,\\mathrm{#1}", 1], "normalized": ["\\frac{#1}{|\\cdot|}", 1], "d": "\\mathrm{d}\\,", "phi": "\\varphi", "eps": "\\varepsilon", "epsilon": "\\varepsilon", "tr": "\\mathop{\\rm tr}\\nolimits"}, "packages": {"[+]": ["boldsymbol"]}}})</script>
    <script>window.MathJax = {"loader": {"load": ["[tex]/boldsymbol"]}, "TeX": {"Macros": {"prev": ["#1^-", 1], "pprev": ["#1^{\\ominus}", 1], "curr": ["#1^{\\circ}", 1], "nnext": ["#1^{\\oplus}", 1], "next": ["#1^{+}", 1], "Dt": "\\Delta t", "tens": ["{\\bf #1}", 1], "vec": ["{\\bf #1}", 1], "quat": ["{\\bf #1}", 1], "mat": ["{\\bf #1}", 1], "u": ["\\,\\mathrm{#1}", 1], "normalized": ["\\frac{#1}{|\\cdot|}", 1], "d": "\\mathrm{d}\\,", "phi": "\\varphi", "eps": "\\varepsilon", "epsilon": "\\varepsilon", "tr": "\\mathop{\\rm tr}\\nolimits"}, "packages": {"[+]": ["boldsymbol"]}}}</script>

    
    
     
        <script src="../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../_static/cloud.base.js"></script>
    

    
     
        <script src="../_static/cloud.js"></script>
    

    <link rel="shortcut icon" href="../_static/woo-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Particle size distribution" href="granular/psd.html" />
    <link rel="prev" title="Tet4 element" href="tet4-element.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="granular/psd.html" title="Particle size distribution"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="tet4-element.html" title="Tet4 element"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">Woo 1.0+rev1-git-797b069 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Theory</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Membrane element</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="membrane-element">
<span id="id1"></span><h1>Membrane element<a class="headerlink" href="#membrane-element" title="Permalink to this headline">¶</a></h1>
<p>Membrane elements are special 3-node particles in DEM. They have their mass lumped into nodes and respond to plane-stress stretching (CST element) and bending (DKT element; optional, enabled by setting the <code class="xref py py-obj docutils literal notranslate"><span class="pre">bending</span> <span class="pre">flag</span></code>). These two elements are superposed. The element has constant thickness. Each node has 6 DoFs:</p>
<ol class="arabic simple">
<li><p>two in-plane translations (gathered in <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.uXy" title="woo.fem.Membrane.uXy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.fem.Membrane.uXy</span></code></a> for all nodes as a 6-vector), used by the CST element;</p></li>
<li><p>one out-of-plane translation – defines rigid motion of the whole element and causes no internal response;</p></li>
<li><p>two in-plane rotations (gathered in <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.phiXy" title="woo.fem.Membrane.phiXy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.fem.Membrane.phiXy</span></code></a> for all nodes as a 6-vector), used by the DKT element;</p></li>
<li><p>one out-of-plane rotation (drilling DoF), which is ignored.</p></li>
</ol>
<p>Mass and intertia of nodes are computed and lumped into nodes (this only requires geometry and material density), but it must be requested by calling <a class="reference internal" href="../woo.dem.html#woo.dem.DemData.setOriMassInertia" title="woo.dem.DemData.setOriMassInertia"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.dem.DemData.setOriMassInertia</span></code></a> on the node, once all its attached particles are in place. Details <a class="reference internal" href="#membrane-lumped"><span class="std std-ref">below</span></a>.</p>
<section id="element-coordinate-system">
<h2>Element coordinate system<a class="headerlink" href="#element-coordinate-system" title="Permalink to this headline">¶</a></h2>
<p>When the element is first used, its configuration defines the reference configuration which is stored in <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.refPos" title="woo.fem.Membrane.refPos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.fem.Membrane.refPos</span></code></a> and <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.refRot" title="woo.fem.Membrane.refRot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.fem.Membrane.refRot</span></code></a>.</p>
<p>The element coordinate system (held in <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.node" title="woo.fem.Membrane.node"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.fem.Membrane.node</span></code></a>) is always such that</p>
<ol class="arabic">
<li><p>local origin coindices with centroid of the (deformed) triangle;</p></li>
<li><p>the local <span class="math notranslate nohighlight">\(z\)</span>-axis is normal to the plane defined by element nodes in their current positions;</p></li>
<li><p>local <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> axes are oriented in a way which minimizes displacements of nodes in the local plane relative to the <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.refPos" title="woo.fem.Membrane.refPos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reference</span> <span class="pre">positions</span></code></a>, and tries to represent their mutual displacements as rigid body motion as much as possible.</p>
<p>This point is trivially satisfied in the reference configuration (first time the element is used) when displacements are zero with arbitrary orientation of the local <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> axes. (The implementation currently chooses to rotate the <span class="math notranslate nohighlight">\(x\)</span>-axis so that it passes through the first node.)</p>
<p>Otherwise, we are looking for a best-fit rotation; the algorithm is described in <span id="id2">[<a class="reference internal" href="../references.html#id13" title="Carlos Felippa. Nonlinear Finite Element Methods (ASEN 6107). online course at http://www.colorado.edu/engineering/cas/courses.d/NFEM.d/, 1999. URL: http://www.colorado.edu/engineering/cas/courses.d/NFEM.d/.">Fel99b</a>]</span> in <a class="reference external" href="http://www.colorado.edu/engineering/cas/courses.d/NFEM.d/NFEM.AppC.d/NFEM.AppC.pdf">Appendix C</a>. Nodes positions are projected onto (not yet properly rotated) local <span class="math notranslate nohighlight">\(xy\)</span> plane, and best-fit angle is computed (from reference positions <span class="math notranslate nohighlight">\(X_i\)</span>, <span class="math notranslate nohighlight">\(Y_i\)</span> and current local positions <span class="math notranslate nohighlight">\(x_i\)</span>, <span class="math notranslate nohighlight">\(y_1\)</span>) as</p>
<div class="math notranslate nohighlight">
\[\tan\theta_3=\frac{x_1 Y_1 + x_2 Y_2 + x_3 Y_3 - y_1 X1 - y_2 X_2 - y_3 X_3}{x_1 X_1 + x_2 X_2 + y_3 Y_3 + y_1 Y_1 + y_2 Y_2 + y_3 Y_3}\]</div>
<p>where the numerator and denominator are computed separately in the implementation and <span class="math notranslate nohighlight">\(\tan\phi_3\)</span> is obtained vi via the <a class="reference external" href="http://en.wikipedia.org/wiki/Atan2">atan2</a> function as to preserve quadrant information and handle zero denominator correctly. The <span class="math notranslate nohighlight">\(\theta_3\)</span> rotation is then added to the previous rotation of the <span class="math notranslate nohighlight">\(xy\)</span> plane, obtaining the best-fit coordinate system.</p>
</li>
</ol>
<p>Once the local coordinate system is established, displacements are evaluated. Evaluating <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.uXy" title="woo.fem.Membrane.uXy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.fem.Membrane.uXy</span></code></a> is done as trivial subtraction of reference nodal positions from the current ones in the local system. Rotations <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.phiXy" title="woo.fem.Membrane.phiXy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.fem.Membrane.phiXy</span></code></a> are computed by rotation “subtraction” (conjugate product) using quaternions (<a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.refRot" title="woo.fem.Membrane.refRot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.fem.Membrane.refRot</span></code></a> holds the rotation necessary to obtain each node orientation from global element orientation). See the source code for details.</p>
</section>
<section id="constant-strain-triangle-cst-element">
<h2>Constant Strain Triangle (CST) Element<a class="headerlink" href="#constant-strain-triangle-cst-element" title="Permalink to this headline">¶</a></h2>
<p>The CST element is implemented following <span id="id3">[<a class="reference internal" href="../references.html#id12" title="Carlos Felippa. Introduction to Finite Element Methods (ASEN 5007). online course at http://www.colorado.edu/engineering/cas/courses.d/IFEM.d/, 1998. URL: http://www.colorado.edu/engineering/cas/courses.d/IFEM.d/.">Fel98</a>]</span>, <a class="reference external" href="http://www.colorado.edu/engineering/cas/courses.d/IFEM.d/IFEM.Ch15.d/IFEM.Ch15.pdf">chapter 15</a>. The strain-displacement matrix is computed as (15.17):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mat{B}=\frac{1}{2A}\begin{pmatrix}y_{23} &amp; 0 &amp; y_{31} &amp; 0 y_{12} &amp; 0 \\ 0 &amp; x_{23} &amp; 0 &amp; x_{12} &amp; 0 &amp; x_{21} \\ x_{32} &amp; y_{23} &amp; x_{12} &amp; y_{31} &amp; x_{21} &amp; y_{12}\end{pmatrix}\begin{pmatrix} u_{x1} \\ u_{y1} \\ y_{x2} \\ u_{y2} \\ u_{x3} \\ u_{y3}\end{pmatrix}.\end{split}\]</div>
<p>The elastic stiffness matrix for plane-stress conditions reads</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mat{E}=\frac{E}{1-\nu^2}\begin{pmatrix}1 &amp; \nu &amp; 0 \\ \nu &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; \frac{1-\nu}{2}\end{pmatrix}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(E\)</span> is <a class="reference internal" href="../woo.dem.html#woo.dem.ElastMat.young" title="woo.dem.ElastMat.young"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Young</span> <span class="pre">modulus</span></code></a> and <span class="math notranslate nohighlight">\(\nu\)</span> is the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Poisson</span> <span class="pre">ratio</span></code>.</p>
<p>Since <code class="xref py py-obj docutils literal notranslate"><span class="pre">membrane</span> <span class="pre">thickness</span></code> <span class="math notranslate nohighlight">\(h\)</span> is constant over the element, we may write the stiffness matrix as (<span id="id4">[<a class="reference internal" href="../references.html#id12" title="Carlos Felippa. Introduction to Finite Element Methods (ASEN 5007). online course at http://www.colorado.edu/engineering/cas/courses.d/IFEM.d/, 1998. URL: http://www.colorado.edu/engineering/cas/courses.d/IFEM.d/.">Fel98</a>]</span>, (15.21)):</p>
<div class="math notranslate nohighlight" id="equation-cst-kahbeb">
<span class="eqno">(35)<a class="headerlink" href="#equation-cst-kahbeb" title="Permalink to this equation">¶</a></span>\[\mat{K^{\mathrm{CST}}}=A h \mat{B}^T \mat E \mat B.\]</div>
<p>This matrix is stored as <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.KKcst" title="woo.fem.Membrane.KKcst"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.fem.Membrane.KKcst</span></code></a>.</p>
<p><a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.uXy" title="woo.fem.Membrane.uXy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Displacements</span></code></a> <span class="math notranslate nohighlight">\(\vec{u}\)</span> (6-vector) are computed by subtracting <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.refPos" title="woo.fem.Membrane.refPos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reference</span> <span class="pre">positions</span></code></a> from the current nodal positions in best-fit local coordinates. Nodal forces (6-vector) are</p>
<div class="math notranslate nohighlight" id="equation-cst-fku">
<span class="eqno">(36)<a class="headerlink" href="#equation-cst-fku" title="Permalink to this equation">¶</a></span>\[\begin{split}\vec{F}^{\mathrm{CST}}=\begin{pmatrix}F_{x1}\\F_{y1}\\F_{x2}\\F_{y2}\\F_{x3}\\F_{y3}\end{pmatrix}=\mat{K}^{\mathrm{CST}}\vec{u}.\end{split}\]</div>
<p>This is an example of a CST-only mesh, no bending (<a class="reference external" href="https://github.com/woodem/woo/tree/master/examples/membrane1.py">examples/membrane1.py</a>):</p>
<iframe src="https://www.youtube.com/embed/jimWu0_8oLc" style="border: 0; height: 345px; width: 560px">
</iframe><section id="stresses">
<span id="cst-stresses"></span><h3>Stresses<a class="headerlink" href="#stresses" title="Permalink to this headline">¶</a></h3>
<p>Stresses don’t come up as such in the FEM, being hidden in eqs. <a class="reference internal" href="#equation-cst-kahbeb">(35)</a> and <a class="reference internal" href="#equation-cst-fku">(36)</a>:</p>
<div class="math notranslate nohighlight">
\[\vec{F}^\mathrm{CST}=A h \mat{B}^T \underbrace{\mat{E}\mat{B}\vec{u}}_{\vec{\sigma}^\mathrm{CST}}.\]</div>
<p>Note that <span class="math notranslate nohighlight">\(\vec{\sigma}^\mathrm{CST}\)</span> are in local coordinates, that’s why they are then converted (by left-multiplication) to forces in global coordinates through <span class="math notranslate nohighlight">\(Ah\mat{B}^T\)</span>.</p>
<p>In the implementation, the <span class="math notranslate nohighlight">\(\mat{E}\mat{B}\)</span> product is normally not stored in element, since it is not used in reaction computation. For that reason, it must be explicitly requested by setting <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.enableStress" title="woo.fem.Membrane.enableStress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Membrane.enableStress</span></code></a> before stiffness matrix is evaluated. When stiffness matrix is then built, the <span class="math notranslate nohighlight">\(\mat{E}\mat{B}\)</span> product will be stored in <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.EBcst" title="woo.fem.Membrane.EBcst"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Membrane.EBcst</span></code></a> as side-effect. It can be then used to compute stresses either explicitly by multiplying <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.EBcst" title="woo.fem.Membrane.EBcst"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EBcst</span></code></a> × <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.uXy" title="woo.fem.Membrane.uXy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uXy</span></code></a>, or using the shorthand <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.stressCst" title="woo.fem.Membrane.stressCst"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Membrane.stressCst</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Stresses returned are in element-local coordinates and they are constant over the entire element; the order is <span class="math notranslate nohighlight">\((\sigma_x,\sigma_y,\sigma_{xy})\)</span>; to transform to global coordinates, call <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.stressCst" title="woo.fem.Membrane.stressCst"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Membrane.stressCst(glob=True)</span></code></a> (the result will be stress tensor represented as 3×3 matrix).</p>
</div>
</section>
</section>
<section id="discrete-krichhoff-triangle-dkt-element">
<h2>Discrete Krichhoff Triangle (DKT) Element<a class="headerlink" href="#discrete-krichhoff-triangle-dkt-element" title="Permalink to this headline">¶</a></h2>
<p>The DKT (bending) element is implemented following <span id="id5">[<a class="reference internal" href="../references.html#id16" title="Jean-Louis Batoz, Klaus-JÜRgen Bathe, and Lee-Wing Ho. A study of three-node triangular plate bending elements. International Journal for Numerical Methods in Engineering, 15(12):1771–1812, 1980. URL: http://web.mit.edu/kjb/www/Publications_Prior_to_1998/A_Study_of_Three-Node_Triangular_Plate_Bending_Elements.pdf.">BBH80</a>]</span>. The bending elasticity matrix for constant thickness is computed as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mat{D}_b=\frac{E h^3}{12(1-\nu^2)}\begin{pmatrix}1 &amp; \nu &amp; 0 \\ \nu &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; \frac{1-\nu}{2}\end{pmatrix}\end{split}\]</div>
<p>where the thickness <span class="math notranslate nohighlight">\(h\)</span> may be <code class="xref py py-obj docutils literal notranslate"><span class="pre">different</span> <span class="pre">thickness</span></code> than the one used for the CST element (different thicknesses are mostly not useful). The strain-displacement transformation matrix for bending reads (<span id="id6">[<a class="reference internal" href="../references.html#id16" title="Jean-Louis Batoz, Klaus-JÜRgen Bathe, and Lee-Wing Ho. A study of three-node triangular plate bending elements. International Journal for Numerical Methods in Engineering, 15(12):1771–1812, 1980. URL: http://web.mit.edu/kjb/www/Publications_Prior_to_1998/A_Study_of_Three-Node_Triangular_Plate_Bending_Elements.pdf.">BBH80</a>]</span>, (30))</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mat{B}_{b}(\xi,\eta)=\frac{1}{2A}\begin{pmatrix}y_{31}\vec{H}_{x,\xi}^T+y_{12}\vec{H}_{x,\eta}^T \\ -x_{31}\vec{H}_{y,\xi}^T-x_{12}\vec{H}_{y,\eta}^T \\ -x_{31}\vec{H}_{x,\xi}^T-x_{12}\vec{H}_{x,\eta}^T+y_{31}\vec{H}_{y,\xi}^T+y_{12}\vec{H}_{y,\eta}^T \end{pmatrix}.\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{ij}\equiv x_i-x_j\)</span>, <span class="math notranslate nohighlight">\(y_{ij}\equiv y_i-y_j\)</span> and <span class="math notranslate nohighlight">\((\xi,\eta)\)</span> are natural (≡barycentric) coordinates on the triangle. Refer to Appendix A of <span id="id7">[<a class="reference internal" href="../references.html#id16" title="Jean-Louis Batoz, Klaus-JÜRgen Bathe, and Lee-Wing Ho. A study of three-node triangular plate bending elements. International Journal for Numerical Methods in Engineering, 15(12):1771–1812, 1980. URL: http://web.mit.edu/kjb/www/Publications_Prior_to_1998/A_Study_of_Three-Node_Triangular_Plate_Bending_Elements.pdf.">BBH80</a>]</span> (or the source code of <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane" title="woo.fem.Membrane"><code class="xref py py-obj docutils literal notranslate"><span class="pre">woo.fem.Membrane</span></code></a>) for formulation of <span class="math notranslate nohighlight">\(\vec{H}_{x,\xi}\)</span>, <span class="math notranslate nohighlight">\(\vec{H}_{x,\eta}\)</span>, <span class="math notranslate nohighlight">\(\vec{H}_{y,\xi}\)</span>, <span class="math notranslate nohighlight">\(\vec{H}_{y,\eta}\)</span>, which are rather convolved.</p>
<p>The stiffness matrix is integrated over the triangle as (<span id="id8">[<a class="reference internal" href="../references.html#id16" title="Jean-Louis Batoz, Klaus-JÜRgen Bathe, and Lee-Wing Ho. A study of three-node triangular plate bending elements. International Journal for Numerical Methods in Engineering, 15(12):1771–1812, 1980. URL: http://web.mit.edu/kjb/www/Publications_Prior_to_1998/A_Study_of_Three-Node_Triangular_Plate_Bending_Elements.pdf.">BBH80</a>]</span>, (31))</p>
<div class="math notranslate nohighlight">
\[\mat{K}^{\mathrm{DKT}}=2A\int_0^1\int_0^{1-\eta}\mat{B}^T\mat{D}_b\mat{B}\d\xi\,\d\eta\]</div>
<p>and can be integrated numerically (see <span id="id9">[<a class="reference internal" href="../references.html#id17" title="Kaushalkumar Kansara. Development of membrane, plate and flat shell elements in java. PhD thesis, Virginia Polytechnic, 2004. URL: http://scholar.lib.vt.edu/theses/available/etd-05142004-234133/unrestricted/Thesis.pdf.">Kan04</a>]</span>, pg. 48) using the <a class="reference external" href="http://en.wikipedia.org/wiki/Gaussian_quadrature">Gauss quadrature</a> (Gauss points are mid-points of triangle sides, <span class="math notranslate nohighlight">\(w\)</span> is vector of point weights) over the unit triangle as</p>
<div class="math notranslate nohighlight">
\begin{align*}
   \vec{\xi}&amp;=\left(\frac{1}{2},\frac{1}{2},0\right),\\
   \vec{\eta}&amp;=\left(0,\frac{1}{2},\frac{1}{2}\right),\\
   \vec{w}&amp;=\left(\frac{1}{3},\frac{1}{2},\frac{1}{2}\right),\\
   \mat{K}^{\mathrm{DKT}}&amp;=2A\sum_{j=1}^{3}\sum_{i=1}^{3} w_j w_i \mat{B}_b^T(\xi_i,\eta_j) \mat{D}_b \mat{B}_b(\xi_i,\eta_j).
\end{align*}</div><p>Generalized nodal forces are computed as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{F}^{\mathrm{DKT}}=\begin{pmatrix} F_{z1} \\ T_{x1} \\ T_{y1} \\ F_{z2} \\ T_{x1} \\ T_{x2} \\ F_{z3} \\ T_{x3}  \\ T_{y3}\end{pmatrix}=\mat{K}^{\mathrm{DKT}}\begin{pmatrix}u_{z1}\equiv0\\ \phi_{x1} \\ \phi_{y1} \\ u_{z2}\equiv0 \\ \phi_{x2} \\ \phi_{y2} \\ u_{z3}\equiv 0 \\ \phi_{x3} \\ \phi_{y3}\end{pmatrix},\end{split}\]</div>
<p>Since out-of-plane translations <span class="math notranslate nohighlight">\(u_{zi}\)</span> are always zero (they determine rigid body rotation of the element), we may condense those rows from <span class="math notranslate nohighlight">\(\mat{K}_{\mathrm{DKT}}\)</span> away, making it 9×6 rather than 9×9, and removing zero elements from the generalized displacement vector as well. Note that corresponding DoFs may nevertheless have non-zero forces <span class="math notranslate nohighlight">\(F_{zi}\)</span>.</p>
<p>The <a class="reference external" href="https://github.com/woodem/woo/tree/master/examples/membrane2.py">examples/membrane2.py</a> script shows the combined response of CST and DKT elements:</p>
<iframe src="https://www.youtube.com/embed/KmQWD_MfR8M" style="border: 0; height: 345px; width: 560px">
</iframe><section id="id10">
<h3>Stresses<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is not functional yet in the code.</p>
</div>
<p>Moments can be computed as (<span id="id11">[<a class="reference internal" href="../references.html#id16" title="Jean-Louis Batoz, Klaus-JÜRgen Bathe, and Lee-Wing Ho. A study of three-node triangular plate bending elements. International Journal for Numerical Methods in Engineering, 15(12):1771–1812, 1980. URL: http://web.mit.edu/kjb/www/Publications_Prior_to_1998/A_Study_of_Three-Node_Triangular_Plate_Bending_Elements.pdf.">BBH80</a>]</span>, (32))</p>
<div class="math notranslate nohighlight">
\[\mat{M}(x,y)=\mat{D}_b\mat{B}(x,y)\vec{U}\]</div>
<p>Similar as with <a class="reference internal" href="#cst-stresses"><span class="std std-ref">with CST</span></a>, stress evaluation needs some extra data (namely, the <span class="math notranslate nohighlight">\(\mat{D}_b\mat{B}(x,y)\)</span> term) of which availability must be requested by the user through <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.enableStress" title="woo.fem.Membrane.enableStress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Membrane.enableStress</span></code></a>; <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.DBdkt" title="woo.fem.Membrane.DBdkt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DBdkt</span></code></a> will be stored when stiffness matrix is computed as side-effect; stress can be obtained by hand-multiplication with rotations (<a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.phiXy" title="woo.fem.Membrane.phiXy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">phiXy</span></code></a>) or using the shorthand function <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.stressDkt" title="woo.fem.Membrane.stressDkt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Membrane.stressDkt</span></code></a>.</p>
</section>
</section>
<section id="total-nodal-forces">
<h2>Total nodal forces<a class="headerlink" href="#total-nodal-forces" title="Permalink to this headline">¶</a></h2>
<p>Total nodal forces are  superimposed from both elements and also from contact forces on the particle and from a special load type on membranes, hydrostatic pressure. We note force and torque contributions as <span class="math notranslate nohighlight">\(\Delta \vec{F}_i\)</span>, <span class="math notranslate nohighlight">\(\Delta \vec{T}_i\)</span> for <span class="math notranslate nohighlight">\(i\)</span>-th node, <span class="math notranslate nohighlight">\(i\in\{1,2,3\}\)</span>.</p>
<section id="hydrostatic-pressure">
<h3>Hydrostatic pressure<a class="headerlink" href="#hydrostatic-pressure" title="Permalink to this headline">¶</a></h3>
<p>Elements may be under <a class="reference internal" href="../woo.fem.html#woo.fem.Membrane.surfLoad" title="woo.fem.Membrane.surfLoad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">surface</span> <span class="pre">load</span></code></a> which is always perpendicular to the element plane, thus representing hydrostatic pressure. Such pressure <span class="math notranslate nohighlight">\(p\)</span> is distributed into nodes as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Delta\vec{F}_i = \begin{pmatrix} 0 \\ 0 \\ p\frac{A^*}{3} \end{pmatrix}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(A^*\)</span> is the current (not reference) element surface area.</p>
</section>
<section id="contact-forces">
<h3>Contact forces<a class="headerlink" href="#contact-forces" title="Permalink to this headline">¶</a></h3>
<p>Contact forces defined by contact point <span class="math notranslate nohighlight">\(\vec{c}\)</span>, force <span class="math notranslate nohighlight">\(\vec{F}_c\)</span> and torque <span class="math notranslate nohighlight">\(\vec{T}_c\)</span> are simply distributed onto all nodes, so that each node <span class="math notranslate nohighlight">\(i\)</span> (positioned at <span class="math notranslate nohighlight">\(\vec{x}_i\)</span>) receives for each contact the contribution</p>
<div class="math notranslate nohighlight">
\begin{align*}
   \Delta\vec{F}_i&amp;=\frac{\vec{F}_c}{3}, \\
   \Delta\vec{T}_i&amp;=(\vec{x}_i-\vec{c})\times\vec{F}_c+\vec{T}_c.
\end{align*}</div></section>
<section id="cst-dkt">
<h3>CST + DKT<a class="headerlink" href="#cst-dkt" title="Permalink to this headline">¶</a></h3>
<p>Generalized forces from elements are distributed to nodes as follows:</p>
<div class="math notranslate nohighlight">
\begin{align*}
   \Delta\vec{F}_i&amp;=\begin{pmatrix} \vec{F}^{\mathrm{CST}}_{xi} \\ \vec{F}^{\mathrm{CST}}_{yi} \\ -\vec{F}^{\mathrm{DKT}}_{zi} \end{pmatrix}, \\
   \Delta\vec{T}_i&amp;=\begin{pmatrix} \vec{F}^{\mathrm{DKT}}_{\phi_{xi}} \\ \vec{F}^{\mathrm{DKT}}_{\phi_{yi}} \\ 0 \end{pmatrix}.
\end{align*}</div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The value of <span class="math notranslate nohighlight">\(\vec{T}_{zi}\)</span> (drilling torque) is always zero; therefore, drilling motion of nodes is unconstrained (though still governed by dynamics). This can lead to some problems in special cases, manifesting as wobbly rotation of nodes which does not go away.</p>
</div>
<p>This video demonstrates the <a class="reference internal" href="../woo.pre.html#woo.pre.cylTriax.CylTriaxTest" title="woo.pre.cylTriax.CylTriaxTest"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cylindrical</span> <span class="pre">triaxial</span> <span class="pre">test</span></code></a> which includes CST+DKT elements with hydrostatic pressure and interaction with particles inside the membrane (displacements are scaled 10×):</p>
<iframe src="https://www.youtube.com/embed/Li13NrIyMYU" style="border: 0; height: 345px; width: 560px">
</iframe></section>
</section>
<section id="lumped-mass-and-inertia">
<span id="membrane-lumped"></span><h2>Lumped mass and inertia<a class="headerlink" href="#lumped-mass-and-inertia" title="Permalink to this headline">¶</a></h2>
<p>Triangle mass and inertia are computed supposing the entire <a class="reference internal" href="../woo.dem.html#woo.dem.Facet.halfThick" title="woo.dem.Facet.halfThick"><code class="xref py py-obj docutils literal notranslate"><span class="pre">thickness</span></code></a> in the triangle plane. The “sleeve” rounding the edges is ignored for the purposes of computing mass and inertia.</p>
<p>Inertia computation is described at <a class="reference external" href="http://en.wikipedia.org/wiki/Inertia_tensor_of_triangle">Wikipedia</a> and summarized here. For triangle with vertices <span class="math notranslate nohighlight">\(\vec{a}\)</span>, <span class="math notranslate nohighlight">\(\vec{b}\)</span>, <span class="math notranslate nohighlight">\(\vec{c}\)</span>, its double-area is computed as</p>
<div class="math notranslate nohighlight">
\[A=\left|(\vec{b}-\vec{a})\times(\vec{c}-\vec{a})\right|.\]</div>
<p>Using covariance of unit triangle</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mat{S}=\frac{1}{24}\begin{pmatrix}2&amp;1&amp;1\\1&amp;2&amp;1\\1&amp;1&amp;2\end{pmatrix}\end{split}\]</div>
<p>and transformation matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mat{V}=\begin{pmatrix}\vec{a}^T \\ \vec{b}^T \\ \vec{c}^T\end{pmatrix},\end{split}\]</div>
<p>we compute the covariance as</p>
<div class="math notranslate nohighlight">
\[\mat{C}=\frac{A}{2}\mat{V}^T\mat{S}\mat{V}.\]</div>
<p>Inertia tensor (with respect to global origin and axes) is then evaluated as usually,</p>
<div class="math notranslate nohighlight">
\[\mat{J}=\operatorname{tr}(\mat{C})\mat{I}_3-\mat{C}.\]</div>
<p>When lumping mass and inertia, only the part adjacent to each node is considered according to Voronoi tesselation; triangle is partitioned into 6 sub-triangles. With midpoints <span class="math notranslate nohighlight">\(\vec{m}_{ab}=\frac{\vec{a}+\vec{b}}{2}\)</span> etc., the part adjacent to <span class="math notranslate nohighlight">\(\vec{a}\)</span> are triangles <span class="math notranslate nohighlight">\(\{\vec{a},\vec{m}_{ab},\vec{m}_{ac}\}\)</span> and <span class="math notranslate nohighlight">\(\{\vec{m}_{ab},\vec{C},\vec{m}_{ac}\}\)</span>, as shown on the image:</p>
<figure class="align-center" id="id12">
<img alt="../_images/triangle-partition.svg" src="../_images/triangle-partition.svg" /><figcaption>
<p><span class="caption-number">Fig. 29 </span><span class="caption-text">Partitioning triangle where 2 sub-triangles belong to each node for the purposes of lumping mass and inertia (greenish, reddish and yellowish colors to <span class="math notranslate nohighlight">\(\vec{a}\)</span>, <span class="math notranslate nohighlight">\(\vec{b}\)</span>, <span class="math notranslate nohighlight">\(\vec{c}\)</span> respectively)</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Report issues or inclarities to <a class="reference external" href="https://github.com/woodem/woo/issues">github</a>.</p>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="../contents.html">Page contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Membrane element</a><ul>
<li><a class="reference internal" href="#element-coordinate-system">Element coordinate system</a></li>
<li><a class="reference internal" href="#constant-strain-triangle-cst-element">Constant Strain Triangle (CST) Element</a><ul>
<li><a class="reference internal" href="#stresses">Stresses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#discrete-krichhoff-triangle-dkt-element">Discrete Krichhoff Triangle (DKT) Element</a><ul>
<li><a class="reference internal" href="#id10">Stresses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#total-nodal-forces">Total nodal forces</a><ul>
<li><a class="reference internal" href="#hydrostatic-pressure">Hydrostatic pressure</a></li>
<li><a class="reference internal" href="#contact-forces">Contact forces</a></li>
<li><a class="reference internal" href="#cst-dkt">CST + DKT</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lumped-mass-and-inertia">Lumped mass and inertia</a></li>
</ul>
</li>
</ul>

  </div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="tet4-element.html"
                          title="Previous page">&larr; Tet4 element</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="granular/psd.html"
                          title="Next page">&rarr; Particle size distribution</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/theory/membrane-element.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="granular/psd.html" title="Particle size distribution"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="tet4-element.html" title="Tet4 element"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">Woo 1.0+rev1-git-797b069 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >Theory</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Membrane element</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2012−2021, Václav Šmilauer &lt;eu@doxos.eu&gt;.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>