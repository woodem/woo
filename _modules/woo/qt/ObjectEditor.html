


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>woo.qt.ObjectEditor &#8212; Woo 1.0+rev1-git-681f22d documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/cloud.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>

    
    
     
        <script src="../../../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../../../_static/cloud.base.js"></script>
    

    
     
        <script src="../../../_static/cloud.js"></script>
    

    <link rel="shortcut icon" href="../../../_static/woo-favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../../index.html">Woo 1.0+rev1-git-681f22d documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qt.html" accesskey="U">woo.qt</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">woo.qt.ObjectEditor</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for woo.qt.ObjectEditor</h1><div class="highlight"><pre>
<span></span><span class="c1"># encoding: utf-8</span>

<span class="kn">import</span> <span class="nn">woo.config</span>
<span class="k">if</span> <span class="s1">&#39;qt5&#39;</span> <span class="ow">in</span> <span class="n">woo</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="k">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="k">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="k">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">PyQt5</span> <span class="k">import</span> <span class="n">QtGui</span>

<span class="kn">from</span> <span class="nn">minieigen</span> <span class="k">import</span> <span class="o">*</span>
<span class="c1"># don&#39;t import * from woo, it would be circular import</span>
<span class="kn">from</span> <span class="nn">woo.core</span> <span class="k">import</span> <span class="n">Object</span>

<span class="kn">import</span> <span class="nn">re</span><span class="o">,</span><span class="nn">itertools</span><span class="o">,</span><span class="nn">math</span>
<span class="kn">import</span> <span class="nn">woo.core</span><span class="o">,</span> <span class="nn">woo.utils</span>
<span class="n">log</span><span class="o">=</span><span class="n">woo</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">makeLog</span><span class="p">(</span><span class="s1">&#39;ObjectEditor&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">woo.qt</span>
<span class="kn">import</span> <span class="nn">woo.document</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os.path</span><span class="o">,</span> <span class="nn">os</span>



<span class="kn">from</span> <span class="nn">.ExceptionDialog</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">seqObjectShowType</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># show type headings in serializable sequences (takes vertical space, but makes the type hyperlinked)</span>

<span class="c1"># BUG: cursor is moved to the beginnign of the input field even if it has focus</span>
<span class="c1">#</span>
<span class="c1"># checking for focus seems to return True always and cursor is never moved</span>
<span class="c1">#</span>
<span class="c1"># the &#39;True or&#39; part effectively disables the condition (so that the cursor is moved always), but it might be fixed in the future somehow</span>
<span class="c1">#</span>
<span class="c1"># if True or w.hasFocus(): w.home(False)</span>
<span class="c1">#</span>
<span class="c1">#</span>

<span class="n">colormapIconSize</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_ensureUnicode</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="n">s</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">s</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="makeColormapIcons"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.makeColormapIcons">[docs]</a><span class="k">def</span> <span class="nf">makeColormapIcons</span><span class="p">():</span>
    <span class="n">ret</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">cmap</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">woo</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">cmaps</span><span class="p">)):</span>
        <span class="n">wd</span><span class="p">,</span><span class="n">ht</span><span class="o">=</span><span class="n">colormapIconSize</span>
        <span class="n">img</span><span class="o">=</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QImage</span><span class="p">(</span><span class="n">wd</span><span class="p">,</span><span class="n">ht</span><span class="p">,</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QImage</span><span class="o">.</span><span class="n">Format_RGB32</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">wd</span><span class="p">):</span>
            <span class="n">c</span><span class="o">=</span><span class="mi">255</span><span class="o">*</span><span class="n">woo</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">mapColor</span><span class="p">(</span><span class="n">col</span><span class="o">*</span><span class="mf">1.</span><span class="o">/</span><span class="n">wd</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
            <span class="c1">#c=(0,0,0)</span>
            <span class="n">cc</span><span class="o">=</span><span class="n">QtGui</span><span class="o">.</span><span class="n">qRgb</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ht</span><span class="p">):</span>
                <span class="n">img</span><span class="o">.</span><span class="n">setPixel</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">cc</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="o">.</span><span class="n">fromImage</span><span class="p">(</span><span class="n">img</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">ret</span></div>

<span class="c1"># construct colormap icons, for later use</span>
<span class="c1"># use this proxy function so that makeColormapIcons is not called at import time</span>
<span class="c1"># since that leads to crash (qt is not fully initialized yet)</span>
<span class="n">_colormapIcons</span><span class="o">=</span><span class="p">[]</span>
<div class="viewcode-block" id="getColormapIcons"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.getColormapIcons">[docs]</a><span class="k">def</span> <span class="nf">getColormapIcons</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">_colormapIcons</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_colormapIcons</span><span class="p">:</span> <span class="n">_colormapIcons</span><span class="o">=</span><span class="n">makeColormapIcons</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">_colormapIcons</span></div>


<div class="viewcode-block" id="WidgetUpdatesDisabled"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.WidgetUpdatesDisabled">[docs]</a><span class="k">class</span> <span class="nc">WidgetUpdatesDisabled</span><span class="p">():</span>
    <span class="s1">&#39;Context manager/decorator for disabling updates of qt widgets temporarily&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">widget</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">=</span><span class="n">widget</span>
    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">setUpdatesEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">eType</span><span class="p">,</span><span class="n">eValue</span><span class="p">,</span><span class="n">eTrace</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">setUpdatesEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>



<span class="c1"># HACK: extend the QLineEdit class</span>
<span class="c1"># set text but preserve cursor position</span>
<div class="viewcode-block" id="QLineEdit_setTextStable"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.QLineEdit_setTextStable">[docs]</a><span class="k">def</span> <span class="nf">QLineEdit_setTextStable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
    <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cursorPosition</span><span class="p">();</span> <span class="bp">self</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">setCursorPosition</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></div>
<div class="viewcode-block" id="QSpinBox_setValueStable"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.QSpinBox_setValueStable">[docs]</a><span class="k">def</span> <span class="nf">QSpinBox_setValueStable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
    <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit</span><span class="p">()</span><span class="o">.</span><span class="n">cursorPosition</span><span class="p">();</span> <span class="bp">self</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit</span><span class="p">()</span><span class="o">.</span><span class="n">setCursorPosition</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></div>
<span class="n">QLineEdit</span><span class="o">.</span><span class="n">setTextStable</span><span class="o">=</span><span class="n">QLineEdit_setTextStable</span>
<span class="n">QSpinBox</span><span class="o">.</span><span class="n">setValueStable</span><span class="o">=</span><span class="n">QSpinBox_setValueStable</span>

<div class="viewcode-block" id="AttrEditor"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Abstract base class handing some aspects common to all attribute editors.</span>
<span class="sd">    Holds exacly one attribute which is updated whenever it changes.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">setter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="o">=</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hot</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readonly</span><span class="o">=</span><span class="kc">False</span>
<div class="viewcode-block" id="AttrEditor.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span></div>
<div class="viewcode-block" id="AttrEditor.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span></div>
<div class="viewcode-block" id="AttrEditor.isHot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor.isHot">[docs]</a>    <span class="k">def</span> <span class="nf">isHot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">hot</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="s2">&quot;Called when the widget gets focus; mark it hot, change colors etc.&quot;</span>
        <span class="k">if</span> <span class="n">hot</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hot</span><span class="p">:</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hot</span><span class="o">=</span><span class="n">hot</span>
        <span class="k">if</span> <span class="n">hot</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;QWidget { background: red }&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;QWidget { background: none }&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor.sizeHint"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor.sizeHint">[docs]</a>    <span class="k">def</span> <span class="nf">sizeHint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor.trySetter"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor.trySetter">[docs]</a>    <span class="k">def</span> <span class="nf">trySetter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Error setting value </span><span class="si">{val}</span><span class="s1">: {type(e)} </span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span></div>
                <span class="c1"># self.setEnabled(False)</span>
                <span class="c1"># log.exception(f&#39;Error setting value {val}:&#39;)</span>
        <span class="c1"># self.isHot(False)</span>
<div class="viewcode-block" id="AttrEditor.multiplierChanged"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor.multiplierChanged">[docs]</a>    <span class="k">def</span> <span class="nf">multiplierChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">convSpec</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This widget </span><span class="si">%s</span><span class="s2"> has no multiplierChanged method defined.&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor.focusInEvent"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor.focusInEvent">[docs]</a>    <span class="k">def</span> <span class="nf">focusInEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="c1"># log.info(f&#39;AttrEditor.focusInEvent {self}&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doFocusIn</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">focusInEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor.focusOutEvent"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor.focusOutEvent">[docs]</a>    <span class="k">def</span> <span class="nf">focusOutEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="c1"># log.info(f&#39;AttrEditor.focusOutEvent {self}&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doFocusOut</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">focusOutEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor.doFocusIn"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor.doFocusIn">[docs]</a>    <span class="k">def</span> <span class="nf">doFocusIn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># log.info(f&#39;AttrEditor.doFocusIn {self}&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor.doFocusOut"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor.doFocusOut">[docs]</a>    <span class="k">def</span> <span class="nf">doFocusOut</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># log.info(f&#39;AttrEditor.doFocusOut {self}&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div></div>
        <span class="c1">#super().focusOutEvent(event)</span>

<div class="viewcode-block" id="AttrEditor_Bool"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Bool">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Bool</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">=</span><span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">=</span><span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="n">lay</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">lay</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="n">lay</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="p">);</span> <span class="n">lay</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
<div class="viewcode-block" id="AttrEditor_Bool.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Bool.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">())</span></div>
<div class="viewcode-block" id="AttrEditor_Bool.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Bool.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span></div></div>

<div class="viewcode-block" id="AttrEditor_Int"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Int">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Int</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QSpinBox</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QSpinBox</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="mf">1e9</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e9</span><span class="p">));</span> <span class="bp">self</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
<div class="viewcode-block" id="AttrEditor_Int.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Int.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setValueStable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">())</span></div>
<div class="viewcode-block" id="AttrEditor_Int.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Int.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">())</span></div></div>

<div class="viewcode-block" id="AttrEditor_Str"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Str">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Str</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QLineEdit</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QLineEdit</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># self.textEdited.connect(self.isHot)</span>
        <span class="c1">#self.selectionChanged.connect(self.isHot)</span>
        <span class="c1">#self.editingFinished.connect(self.update)</span>
<div class="viewcode-block" id="AttrEditor_Str.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Str.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setTextStable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">())</span></div>
<div class="viewcode-block" id="AttrEditor_Str.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Str.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span></div></div>

<div class="viewcode-block" id="AttrEditor_Float"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Float">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Float</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QLineEdit</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QLineEdit</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1">#self.textEdited.connect(self.isHot)</span>
        <span class="c1">#self.selectionChanged.connect(self.isHot)</span>
        <span class="c1">#self.editingFinished.connect(self.update)</span>
<div class="viewcode-block" id="AttrEditor_Float.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Float.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">v</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">:</span> <span class="n">v</span><span class="o">*=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setTextStable</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span></div>
<div class="viewcode-block" id="AttrEditor_Float.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Float.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># when everything is deleted, don&#39;t refresh because of float(&#39;&#39;) raising ValueError</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hot</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">():</span> <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">v</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">:</span> <span class="n">v</span><span class="o">/=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div>
<div class="viewcode-block" id="AttrEditor_Float.multiplierChanged"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Float.multiplierChanged">[docs]</a>    <span class="k">def</span> <span class="nf">multiplierChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">convSpec</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Float cannot have multiple units.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;Converting </span><span class="si">%s</span><span class="s1"> (× </span><span class="si">%g</span><span class="s1">)&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">convSpec</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="AttrEditor_Quaternion"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Quaternion">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Quaternion</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">=</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">f</span><span class="o">=</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">VLine</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Sunken</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># add vertical divider (axis | angle)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">w</span><span class="o">=</span><span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">w</span><span class="p">);</span>
            <span class="n">w</span><span class="o">.</span><span class="n">textEdited</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">)</span>
            <span class="n">w</span><span class="o">.</span><span class="n">selectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">)</span>
            <span class="n">w</span><span class="o">.</span><span class="n">editingFinished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
<div class="viewcode-block" id="AttrEditor_Quaternion.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Quaternion.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span> <span class="n">axis</span><span class="p">,</span><span class="n">angle</span><span class="o">=</span><span class="n">val</span><span class="o">.</span><span class="n">toAxisAngle</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">();</span> <span class="n">w</span><span class="o">.</span><span class="n">setTextStable</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span> <span class="k">else</span> <span class="n">angle</span><span class="p">));</span></div>
            <span class="c1">#if True or not w.hasFocus(): w.home(False)</span>
<div class="viewcode-block" id="AttrEditor_Quaternion.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Quaternion.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">q</span><span class="o">=</span><span class="n">Quaternion</span><span class="p">(</span><span class="n">Vector3</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">q</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span> <span class="c1"># from axis-angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> </div>
<div class="viewcode-block" id="AttrEditor_Quaternion.setFocus"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Quaternion.setFocus">[docs]</a>    <span class="k">def</span> <span class="nf">setFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="AttrEditor_IntRange"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_IntRange">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_IntRange</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span> 
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">=</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">curr</span><span class="p">,(</span><span class="n">mn</span><span class="p">,</span><span class="n">mx</span><span class="p">)</span><span class="o">=</span><span class="n">getter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">=</span><span class="n">QSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span><span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># rowSpan=1,columnSpan=2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="n">mn</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="n">mx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="n">mn</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="n">mx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ClickFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateFromSpin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">sliderMoved</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliderMoved</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">sliderReleased</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateFromSlider</span><span class="p">)</span>
<div class="viewcode-block" id="AttrEditor_IntRange.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_IntRange.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="n">curr</span><span class="p">,(</span><span class="n">mn</span><span class="p">,</span><span class="n">mx</span><span class="p">)</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">.</span><span class="n">lineEdit</span><span class="p">()</span><span class="o">.</span><span class="n">cursorPosition</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">.</span><span class="n">setValueStable</span><span class="p">(</span><span class="n">curr</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="n">mn</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="n">mx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">.</span><span class="n">lineEdit</span><span class="p">()</span><span class="o">.</span><span class="n">setCursorPosition</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_IntRange.updateFromSpin"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_IntRange.updateFromSpin">[docs]</a>    <span class="k">def</span> <span class="nf">updateFromSpin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">value</span><span class="p">())</span></div>
<div class="viewcode-block" id="AttrEditor_IntRange.updateFromSlider"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_IntRange.updateFromSlider">[docs]</a>    <span class="k">def</span> <span class="nf">updateFromSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">value</span><span class="p">())</span></div>
<div class="viewcode-block" id="AttrEditor_IntRange.sliderMoved"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_IntRange.sliderMoved">[docs]</a>    <span class="k">def</span> <span class="nf">sliderMoved</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># self.slider.value())</span></div>
<div class="viewcode-block" id="AttrEditor_IntRange.setFocus"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_IntRange.setFocus">[docs]</a>    <span class="k">def</span> <span class="nf">setFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="AttrEditor_FloatRange"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FloatRange">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_FloatRange</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="n">sliDiv</span><span class="o">=</span><span class="mi">500</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span> 
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">curr</span><span class="p">,(</span><span class="n">mn</span><span class="p">,</span><span class="n">mx</span><span class="p">)</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multipliedGetter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">=</span><span class="n">QSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span><span class="n">QLineEdit</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">curr</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">=</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setStretchFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setStretchFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliDiv</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ClickFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">textEdited</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">selectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">editingFinished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateFromText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">sliderMoved</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliderMoved</span><span class="p">)</span> <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">sliderReleased</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliderReleased</span><span class="p">)</span> <span class="c1">#</span>
<div class="viewcode-block" id="AttrEditor_FloatRange.multipliedGetter"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FloatRange.multipliedGetter">[docs]</a>    <span class="k">def</span> <span class="nf">multipliedGetter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">curr</span><span class="p">,(</span><span class="n">mn</span><span class="p">,</span><span class="n">mx</span><span class="p">)</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">:</span>
            <span class="n">curr</span><span class="o">*=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">;</span> <span class="n">mn</span><span class="o">*=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">;</span> <span class="n">mx</span><span class="o">*=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span>
        <span class="k">return</span> <span class="n">curr</span><span class="p">,(</span><span class="n">mn</span><span class="p">,</span><span class="n">mx</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_FloatRange.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FloatRange.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">curr</span><span class="p">,(</span><span class="n">mn</span><span class="p">,</span><span class="n">mx</span><span class="p">)</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multipliedGetter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">setTextStable</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">curr</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">curr</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliDiv</span><span class="o">*</span><span class="p">((</span><span class="mf">1.</span><span class="o">*</span><span class="n">curr</span><span class="o">-</span><span class="n">mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">mx</span><span class="o">-</span><span class="n">mn</span><span class="p">))))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_FloatRange.updateFromText"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FloatRange.updateFromText">[docs]</a>    <span class="k">def</span> <span class="nf">updateFromText</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">curr</span><span class="p">,(</span><span class="n">mn</span><span class="p">,</span><span class="n">mx</span><span class="p">)</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multipliedGetter</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliDiv</span><span class="o">*</span><span class="p">((</span><span class="mf">1.</span><span class="o">*</span><span class="n">value</span><span class="o">-</span><span class="n">mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">mx</span><span class="o">-</span><span class="n">mn</span><span class="p">))))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div>
<div class="viewcode-block" id="AttrEditor_FloatRange.sliderPosToNum"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FloatRange.sliderPosToNum">[docs]</a>    <span class="k">def</span> <span class="nf">sliderPosToNum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sliderValue</span><span class="p">):</span>
        <span class="n">curr</span><span class="p">,(</span><span class="n">mn</span><span class="p">,</span><span class="n">mx</span><span class="p">)</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">mn</span><span class="o">+</span><span class="n">sliderValue</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sliDiv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">mx</span><span class="o">-</span><span class="n">mn</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_FloatRange.sliderMoved"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FloatRange.sliderMoved">[docs]</a>    <span class="k">def</span> <span class="nf">sliderMoved</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">newSliderPos</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">sliderPosToNum</span><span class="p">(</span><span class="n">newSliderPos</span><span class="p">))</span></div>
<div class="viewcode-block" id="AttrEditor_FloatRange.sliderReleased"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FloatRange.sliderReleased">[docs]</a>    <span class="k">def</span> <span class="nf">sliderReleased</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sliderPosToNum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">:</span> <span class="n">value</span><span class="o">/=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_FloatRange.setFocus"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FloatRange.setFocus">[docs]</a>    <span class="k">def</span> <span class="nf">setFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div>
<div class="viewcode-block" id="AttrEditor_FloatRange.multiplierChanged"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FloatRange.multiplierChanged">[docs]</a>    <span class="k">def</span> <span class="nf">multiplierChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">convSpec</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Float range cannot have multiple units.&quot;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;New multiplier is &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Unit-conversion </span><span class="si">%s</span><span class="s2">: factor </span><span class="si">%g</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">convSpec</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div></div>
        <span class="c1">#pass # this is OK</span>

<div class="viewcode-block" id="AttrEditor_Choice"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Choice">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Choice</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">isColormap</span><span class="p">):</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">curr</span><span class="p">,</span><span class="n">choices</span><span class="o">=</span><span class="n">getter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="o">=</span><span class="n">choices</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">choices</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;There are 0 choices for this attribute?&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">=</span><span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># if choices are single items, then we choose from those values</span>
        <span class="c1"># otherwise the first item is code value and second is the displayed value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">justValues</span><span class="o">=</span><span class="p">(</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__class__</span><span class="o">!=</span><span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">admitValues</span><span class="o">=</span><span class="p">[(</span><span class="n">c</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">justValues</span> <span class="k">else</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__class__</span><span class="o">==</span><span class="nb">tuple</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">!=</span><span class="mi">2</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Choice must be either single items or 2-tuples of code-value,display-value&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">justValues</span> <span class="k">else</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> 
        <span class="c1">### hack for COLORMAPS!!, only based on length of the choice list</span>
        <span class="k">if</span> <span class="n">isColormap</span><span class="p">:</span>
            <span class="n">nCmaps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">woo</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">cmaps</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">choices</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">nCmaps</span><span class="p">,</span><span class="n">nCmaps</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;Number of colormap choices not equal to the number of known colormaps?&quot;</span> <span class="c1"># +1 for default</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">choices</span><span class="p">)</span><span class="o">==</span><span class="n">nCmaps</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">choices</span><span class="p">)):</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setItemIcon</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">getColormapIcons</span><span class="p">()[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">woo</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">cmap</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">choices</span><span class="p">)):</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setItemIcon</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">getColormapIcons</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="n">colormapIconSize</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">colormapIconSize</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">=</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
<div class="viewcode-block" id="AttrEditor_Choice.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Choice.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">curr</span><span class="p">,</span><span class="n">choices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="c1"># print curr,choices</span>
        <span class="c1">#if self.justValues:</span>
        <span class="c1">#else:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span><span class="o">==</span><span class="nb">int</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">curr</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">curr</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">admitValues</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Current value out of range?&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">curr</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">curr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">admitValues</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Choice attribute value &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; is not within admitted values &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">admitValues</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">admitValues</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()]</span><span class="o">!=</span><span class="n">curr</span><span class="p">:</span> <span class="c1"># update the combo</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">admitValues</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">curr</span><span class="p">))</span></div>

<div class="viewcode-block" id="AttrEditor_Choice.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Choice.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()]</span>
        <span class="n">val</span><span class="o">=</span><span class="n">choice</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">justValues</span> <span class="k">else</span> <span class="n">choice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_Choice.setFocus"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Choice.setFocus">[docs]</a>    <span class="k">def</span> <span class="nf">setFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div>
<div class="viewcode-block" id="AttrEditor_Choice.multiplierChanged"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Choice.multiplierChanged">[docs]</a>    <span class="k">def</span> <span class="nf">multiplierChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">convSpec</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Float choice cannot have multiple units.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">):</span>
            <span class="n">val</span><span class="o">=</span><span class="n">c</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">justValues</span> <span class="k">else</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="vm">__class__</span><span class="o">!=</span><span class="nb">float</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Only float choices can meaningfully support unit multipliers&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">:</span> <span class="n">val</span><span class="o">*=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setItemText</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="AttrEditor_Bits"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Bits">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Bits</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="n">checkersPerRow</span><span class="o">=</span><span class="mi">3</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">curr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">bits</span><span class="o">=</span><span class="n">getter</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bits</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;There are 0 bits for this attribute?&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkers</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># current value of checkboxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">=</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bits</span><span class="p">):</span>
            <span class="n">w</span><span class="o">=</span><span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">w</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="n">w</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">i</span><span class="o">//</span><span class="bp">self</span><span class="o">.</span><span class="n">checkersPerRow</span><span class="p">,</span><span class="n">i</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">checkersPerRow</span><span class="p">)</span>
<div class="viewcode-block" id="AttrEditor_Bits.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Bits.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">curr</span><span class="p">,</span><span class="n">bits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">curr</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">curr</span><span class="o">&gt;=</span><span class="mi">2</span><span class="o">**</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkers</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Value </span><span class="si">%d</span><span class="s2"> exceeds maximum value </span><span class="si">%d</span><span class="s2"> (=2^</span><span class="si">%d</span><span class="s2">-1) representable by the UI bitfield&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">curr</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkers</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkers</span><span class="p">)))</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">=</span><span class="n">curr</span>
        <span class="k">for</span> <span class="n">bit</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkers</span><span class="p">):</span>
            <span class="n">b</span><span class="o">=</span><span class="n">curr</span><span class="o">&amp;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">bit</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">b</span><span class="o">!=</span><span class="n">w</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span> <span class="n">w</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_Bits.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Bits.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">val</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">bit</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkers</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span> <span class="n">val</span><span class="o">|=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">bit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_Bits.setFocus"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Bits.setFocus">[docs]</a>    <span class="k">def</span> <span class="nf">setFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="AttrEditor_RgbColor"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_RgbColor">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_RgbColor</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">=</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">butt</span><span class="o">=</span><span class="n">QPushButton</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">butt</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dialogShow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">=</span><span class="n">QCheckBox</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;padding: 0px;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">butt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgbWidgets</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prevR</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">w</span><span class="o">=</span><span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">w</span><span class="o">.</span><span class="n">textEdited</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">)</span>
            <span class="n">w</span><span class="o">.</span><span class="n">selectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">)</span>
            <span class="n">w</span><span class="o">.</span><span class="n">editingFinished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rgbWidgets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<div class="viewcode-block" id="AttrEditor_RgbColor.toggled"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_RgbColor.toggled">[docs]</a>    <span class="k">def</span> <span class="nf">toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">enabled</span><span class="p">):</span>
        <span class="n">rgb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">enabled</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="n">rgb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prevR</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgbWidgets</span><span class="o">+</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">butt</span><span class="p">]:</span> <span class="n">w</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_RgbColor.to256c"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_RgbColor.to256c">[docs]</a>    <span class="k">def</span> <span class="nf">to256c</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">f</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="o">*</span><span class="mi">256</span><span class="p">)))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span></div>
<div class="viewcode-block" id="AttrEditor_RgbColor.to256"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_RgbColor.to256">[docs]</a>    <span class="k">def</span> <span class="nf">to256</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to256c</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="bp">self</span><span class="o">.</span><span class="n">to256c</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="bp">self</span><span class="o">.</span><span class="n">to256c</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span></div>
<div class="viewcode-block" id="AttrEditor_RgbColor.to256str"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_RgbColor.to256str">[docs]</a>    <span class="k">def</span> <span class="nf">to256str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">):</span> <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to256c</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to256c</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to256c</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]))])</span></div>
<div class="viewcode-block" id="AttrEditor_RgbColor.dialogShow"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_RgbColor.dialogShow">[docs]</a>    <span class="k">def</span> <span class="nf">dialogShow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rgb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">=</span><span class="n">QColorDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">.</span><span class="n">setCurrentColor</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">to256</span><span class="p">(</span><span class="n">rgb</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">.</span><span class="n">setOptions</span><span class="p">(</span><span class="n">QColorDialog</span><span class="o">.</span><span class="n">NoButtons</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">.</span><span class="n">currentColorChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dialogChanged</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
<div class="viewcode-block" id="AttrEditor_RgbColor.dialogChanged"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_RgbColor.dialogChanged">[docs]</a>    <span class="k">def</span> <span class="nf">dialogChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rgba</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">.</span><span class="n">currentColor</span><span class="p">()</span><span class="o">.</span><span class="n">getRgb</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">Vector3</span><span class="p">(</span><span class="o">*</span><span class="n">rgba</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div>
<div class="viewcode-block" id="AttrEditor_RgbColor.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_RgbColor.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rgb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rgbWidgets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setTextStable</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="bp">self</span><span class="o">.</span><span class="n">prevR</span><span class="o">=</span><span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">butt</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;QPushButton { background-color: rgb(</span><span class="si">%s</span><span class="s1">) }&#39;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to256str</span><span class="p">(</span><span class="n">rgb</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_RgbColor.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_RgbColor.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rgb</span><span class="o">=</span><span class="n">Vector3</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbWidgets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="AttrEditor_FileDir"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FileDir">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_FileDir</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">isDir</span><span class="p">,</span><span class="n">isExisting</span><span class="p">):</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isDir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">isExisting</span><span class="o">=</span><span class="n">isDir</span><span class="p">,</span><span class="n">isExisting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">=</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nameEdit</span><span class="o">=</span><span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">textEdited</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">selectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">editingFinished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
        <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">butt</span><span class="o">=</span><span class="n">QPushButton</span><span class="p">()</span>
        <span class="n">style</span><span class="o">=</span><span class="n">QApplication</span><span class="o">.</span><span class="n">style</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">isDir</span><span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">standardIcon</span><span class="p">(</span><span class="n">QStyle</span><span class="o">.</span><span class="n">SP_DirIcon</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">standardIcon</span><span class="p">(</span><span class="n">QStyle</span><span class="o">.</span><span class="n">SP_FileIcon</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">butt</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dialogShow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">butt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">rel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rel</span><span class="o">=</span><span class="n">QPushButton</span><span class="p">()</span>
        <span class="n">rel</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">rel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;rel&#39;</span><span class="p">)</span>
        <span class="n">rel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;Toggle absolute/relative path.</span><span class="se">\n</span><span class="s1">Paths are relative to the current directory,</span><span class="se">\n</span><span class="s1">which is now </span><span class="si">%s</span><span class="s1">.&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())))</span>
        <span class="n">rel</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relToggled</span><span class="p">)</span>
        <span class="n">rel</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;padding: 0px;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">rel</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        
<div class="viewcode-block" id="AttrEditor_FileDir.dialogShow"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FileDir.dialogShow">[docs]</a>    <span class="k">def</span> <span class="nf">dialogShow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">curr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nameEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isDir</span><span class="p">:</span>    <span class="n">f</span><span class="o">=</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Select directory&#39;</span><span class="p">,</span><span class="n">curr</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">isExisting</span><span class="p">:</span> <span class="n">f</span><span class="o">=</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Select existing file&#39;</span><span class="p">,</span><span class="n">curr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">f</span><span class="o">=</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Select file name&#39;</span><span class="p">,</span><span class="n">curr</span><span class="p">,</span><span class="n">options</span><span class="o">=</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontConfirmOverwrite</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="p">:</span> <span class="k">return</span> <span class="c1"># cancelled</span>
        <span class="n">f</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rel</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span> <span class="n">f</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_FileDir.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FileDir.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nameEdit</span><span class="o">.</span><span class="n">setTextStable</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rel</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">f</span><span class="p">))</span></div>
<div class="viewcode-block" id="AttrEditor_FileDir.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FileDir.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">f</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nameEdit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rel</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">f</span><span class="p">))</span></div>
<div class="viewcode-block" id="AttrEditor_FileDir.relToggled"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_FileDir.relToggled">[docs]</a>    <span class="k">def</span> <span class="nf">relToggled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">isRel</span><span class="p">):</span>
        <span class="n">f</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nameEdit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="c1"># do nothing for empty path</span>
        <span class="k">if</span> <span class="n">isRel</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">f</span><span class="p">))</span></div></div>
        
    

<div class="viewcode-block" id="AttrEditor_Se3"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Se3">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Se3</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">=</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span><span class="n">col</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span> <span class="c1"># one additional column for vertical line in quaternion</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span><span class="o">==</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span><span class="o">==</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;←&lt;i&gt;pos&lt;/i&gt; ↙&lt;i&gt;ori&lt;/i&gt;&#39;</span><span class="p">,</span><span class="bp">self</span><span class="p">),</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">);</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span><span class="o">==</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">f</span><span class="o">=</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">VLine</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Sunken</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">);</span> <span class="k">continue</span>
            <span class="n">w</span><span class="o">=</span><span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">);</span>
            <span class="n">w</span><span class="o">.</span><span class="n">textEdited</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">)</span>
            <span class="n">w</span><span class="o">.</span><span class="n">selectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isHot</span><span class="p">)</span>
            <span class="n">w</span><span class="o">.</span><span class="n">editingFinished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
<div class="viewcode-block" id="AttrEditor_Se3.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Se3.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pos</span><span class="p">,</span><span class="n">ori</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span> <span class="n">axis</span><span class="p">,</span><span class="n">angle</span><span class="o">=</span><span class="n">ori</span><span class="o">.</span><span class="n">toAxisAngle</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">();</span> <span class="n">w</span><span class="o">.</span><span class="n">setTextStable</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span> <span class="k">else</span> <span class="n">angle</span><span class="p">));</span>
            <span class="c1">#if True or not w.hasFocus(): w.home(False)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">();</span> <span class="n">w</span><span class="o">.</span><span class="n">setTextStable</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span></div>
            <span class="c1">#if True or not w.hasFocus(): w.home(False)</span>
<div class="viewcode-block" id="AttrEditor_Se3.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Se3.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">q</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)]</span>
            <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">qq</span><span class="o">=</span><span class="n">Quaternion</span><span class="p">(</span><span class="n">Vector3</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">qq</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span> <span class="c1"># from axis-angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">((</span><span class="n">v</span><span class="p">,</span><span class="n">qq</span><span class="p">))</span> </div>
<div class="viewcode-block" id="AttrEditor_Se3.setFocus"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Se3.setFocus">[docs]</a>    <span class="k">def</span> <span class="nf">setFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="QLineEdit_subattr"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.QLineEdit_subattr">[docs]</a><span class="k">class</span> <span class="nc">QLineEdit_subattr</span><span class="p">(</span><span class="n">QLineEdit</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span><span class="n">AttrEditor</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Parent of QLineEdit_subattr must be AttrEditor (not {type(parent).__qualname__}).&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">=</span><span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
<div class="viewcode-block" id="QLineEdit_subattr.focusInEvent"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.QLineEdit_subattr.focusInEvent">[docs]</a>    <span class="k">def</span> <span class="nf">focusInEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;QLineEdit_subattr.focusInEvent&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">doFocusIn</span><span class="p">()</span>
        <span class="n">QLineEdit</span><span class="o">.</span><span class="n">focusInEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">)</span> <span class="c1"># show cursors etc</span></div>
<div class="viewcode-block" id="QLineEdit_subattr.focusOutEvent"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.QLineEdit_subattr.focusOutEvent">[docs]</a>    <span class="k">def</span> <span class="nf">focusOutEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;QLineEdit_subattr.focusOutEvent&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">doFocusOut</span><span class="p">()</span>
        <span class="n">QLineEdit</span><span class="o">.</span><span class="n">focusOutEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">)</span> <span class="c1"># hides cursor etc</span></div></div>


<div class="viewcode-block" id="AttrEditor_MatrixX"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_MatrixX">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_MatrixX</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="n">idxConverter</span><span class="p">):</span>
        <span class="s1">&#39;idxConverter converts row,col tuple to either (row,col), (col) etc depending on what access is used for []&#39;</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QWidget</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idxConverter</span><span class="o">=</span><span class="n">idxConverter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">=</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span><span class="n">col</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)):</span>
            <span class="n">w</span><span class="o">=</span><span class="n">QLineEdit_subattr</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span>
<div class="viewcode-block" id="AttrEditor_MatrixX.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_MatrixX.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span><span class="n">col</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)):</span>
            <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>
            <span class="n">v</span><span class="o">=</span><span class="n">val</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idxConverter</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)]</span>
            <span class="n">mult</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mult</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span> <span class="n">v</span><span class="o">*=</span><span class="n">mult</span>
            <span class="n">w</span><span class="o">.</span><span class="n">setTextStable</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span></div>
            <span class="c1">#if True or not w.hasFocus: w.home(False) # make the left-most part visible, if the text is wider than the widget</span>
<div class="viewcode-block" id="AttrEditor_MatrixX.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_MatrixX.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">row</span><span class="p">,</span><span class="n">col</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)):</span>
                <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">isModified</span><span class="p">():</span>
                    <span class="n">v</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                    <span class="n">mult</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">mult</span><span class="p">:</span> <span class="n">v</span><span class="o">/=</span><span class="n">mult</span>
                    <span class="n">val</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idxConverter</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)]</span><span class="o">=</span><span class="n">v</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;setting&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div>
<div class="viewcode-block" id="AttrEditor_MatrixX.setFocus"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_MatrixX.setFocus">[docs]</a>    <span class="k">def</span> <span class="nf">setFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div>
<div class="viewcode-block" id="AttrEditor_MatrixX.multiplierChanged"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_MatrixX.multiplierChanged">[docs]</a>    <span class="k">def</span> <span class="nf">multiplierChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">convSpec</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">convSpec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Multiplier changed to &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="AttrEditor_MatrixXi"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_MatrixXi">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_MatrixXi</span><span class="p">(</span><span class="n">AttrEditor</span><span class="p">,</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="n">idxConverter</span><span class="p">):</span>
        <span class="s1">&#39;idxConverter converts row,col tuple to either (row,col), (col) etc depending on what access is used for []&#39;</span>
        <span class="n">AttrEditor</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idxConverter</span><span class="o">=</span><span class="n">idxConverter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">=</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span><span class="n">col</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)):</span>
            <span class="n">w</span><span class="o">=</span><span class="n">QSpinBox</span><span class="p">()</span>
            <span class="n">w</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="mf">1e9</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e9</span><span class="p">));</span> <span class="n">w</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span> <span class="c1"># refresh before connecting signals!</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span><span class="n">col</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
<div class="viewcode-block" id="AttrEditor_MatrixXi.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_MatrixXi.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span><span class="n">col</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)):</span>
            <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setValueStable</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idxConverter</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)])</span></div>
<div class="viewcode-block" id="AttrEditor_MatrixXi.update"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_MatrixXi.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span> <span class="n">modified</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span><span class="n">col</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)):</span>
            <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="o">!=</span><span class="n">val</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idxConverter</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)]:</span>
                <span class="n">modified</span><span class="o">=</span><span class="kc">True</span><span class="p">;</span> <span class="n">val</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idxConverter</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)]</span><span class="o">=</span><span class="n">w</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">modified</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;setting&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trySetter</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_MatrixXi.setFocus"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_MatrixXi.setFocus">[docs]</a>    <span class="k">def</span> <span class="nf">setFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="AttrEditor_Vector6i"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Vector6i">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Vector6i</span><span class="p">(</span><span class="n">AttrEditor_MatrixXi</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor_MatrixXi</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_Vector3i"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Vector3i">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Vector3i</span><span class="p">(</span><span class="n">AttrEditor_MatrixXi</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor_MatrixXi</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_Vector2i"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Vector2i">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Vector2i</span><span class="p">(</span><span class="n">AttrEditor_MatrixXi</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor_MatrixXi</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span></div>

<div class="viewcode-block" id="AttrEditor_VectorX"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_VectorX">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_VectorX</span><span class="p">(</span><span class="n">AttrEditor_MatrixX</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">val</span><span class="o">=</span><span class="n">getter</span><span class="p">()</span>
        <span class="n">AttrEditor_MatrixX</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_Vector6"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Vector6">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Vector6</span><span class="p">(</span><span class="n">AttrEditor_MatrixX</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor_MatrixX</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_Vector3"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Vector3">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Vector3</span><span class="p">(</span><span class="n">AttrEditor_MatrixX</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor_MatrixX</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_Vector2"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Vector2">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Vector2</span><span class="p">(</span><span class="n">AttrEditor_MatrixX</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor_MatrixX</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span></div>
<div class="viewcode-block" id="AttrEditor_Matrix3"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_Matrix3">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_Matrix3</span><span class="p">(</span><span class="n">AttrEditor_MatrixX</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor_MatrixX</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">:(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">))</span></div>
<div class="viewcode-block" id="AttrEditor_MatrixXX"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_MatrixXX">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_MatrixXX</span><span class="p">(</span><span class="n">AttrEditor_MatrixX</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">val</span><span class="o">=</span><span class="n">getter</span><span class="p">()</span>
        <span class="n">AttrEditor_MatrixX</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">val</span><span class="o">.</span><span class="n">rows</span><span class="p">(),</span><span class="n">val</span><span class="o">.</span><span class="n">cols</span><span class="p">(),</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">:(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">))</span></div>
<div class="viewcode-block" id="AttrEditor_AlignedBox3"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_AlignedBox3">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_AlignedBox3</span><span class="p">(</span><span class="n">AttrEditor_MatrixX</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor_MatrixX</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">:(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">))</span></div>
<div class="viewcode-block" id="AttrEditor_AlignedBox2"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.AttrEditor_AlignedBox2">[docs]</a><span class="k">class</span> <span class="nc">AttrEditor_AlignedBox2</span><span class="p">(</span><span class="n">AttrEditor_MatrixX</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">):</span>
        <span class="n">AttrEditor_MatrixX</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">:(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">))</span></div>

<div class="viewcode-block" id="Se3FakeType"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.Se3FakeType">[docs]</a><span class="k">class</span> <span class="nc">Se3FakeType</span><span class="p">:</span> <span class="k">pass</span></div>

<span class="n">_fundamentalEditorMap</span><span class="o">=</span><span class="p">{</span><span class="nb">bool</span><span class="p">:</span><span class="n">AttrEditor_Bool</span><span class="p">,</span><span class="nb">str</span><span class="p">:</span><span class="n">AttrEditor_Str</span><span class="p">,</span><span class="nb">int</span><span class="p">:</span><span class="n">AttrEditor_Int</span><span class="p">,</span><span class="nb">float</span><span class="p">:</span><span class="n">AttrEditor_Float</span><span class="p">,</span><span class="n">Quaternion</span><span class="p">:</span><span class="n">AttrEditor_Quaternion</span><span class="p">,</span><span class="n">Vector2</span><span class="p">:</span><span class="n">AttrEditor_Vector2</span><span class="p">,</span><span class="n">Vector3</span><span class="p">:</span><span class="n">AttrEditor_Vector3</span><span class="p">,</span><span class="n">Vector6</span><span class="p">:</span><span class="n">AttrEditor_Vector6</span><span class="p">,</span><span class="n">Matrix3</span><span class="p">:</span><span class="n">AttrEditor_Matrix3</span><span class="p">,</span><span class="n">Vector6i</span><span class="p">:</span><span class="n">AttrEditor_Vector6i</span><span class="p">,</span><span class="n">Vector3i</span><span class="p">:</span><span class="n">AttrEditor_Vector3i</span><span class="p">,</span><span class="n">Vector2i</span><span class="p">:</span><span class="n">AttrEditor_Vector2i</span><span class="p">,</span><span class="n">MatrixX</span><span class="p">:</span><span class="n">AttrEditor_MatrixXX</span><span class="p">,</span><span class="n">VectorX</span><span class="p">:</span><span class="n">AttrEditor_VectorX</span><span class="p">,</span><span class="n">Se3FakeType</span><span class="p">:</span><span class="n">AttrEditor_Se3</span><span class="p">,</span><span class="n">AlignedBox3</span><span class="p">:</span><span class="n">AttrEditor_AlignedBox3</span><span class="p">,</span><span class="n">AlignedBox2</span><span class="p">:</span><span class="n">AttrEditor_AlignedBox2</span><span class="p">}</span>
<span class="n">_fundamentalInitValues</span><span class="o">=</span><span class="p">{</span><span class="nb">bool</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="nb">str</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nb">int</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nb">float</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span><span class="n">Quaternion</span><span class="p">:</span><span class="n">Quaternion</span><span class="o">.</span><span class="n">Identity</span><span class="p">,</span><span class="n">Vector3</span><span class="p">:</span><span class="n">Vector3</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span><span class="n">Matrix3</span><span class="p">:</span><span class="n">Matrix3</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span><span class="n">Vector6</span><span class="p">:</span><span class="n">Vector6</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span><span class="n">Vector6i</span><span class="p">:</span><span class="n">Vector6i</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span><span class="n">Vector3i</span><span class="p">:</span><span class="n">Vector3i</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span><span class="n">Vector2i</span><span class="p">:</span><span class="n">Vector2i</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span><span class="n">Vector2</span><span class="p">:</span><span class="n">Vector2</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span><span class="n">Se3FakeType</span><span class="p">:(</span><span class="n">Vector3</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span><span class="n">Quaternion</span><span class="o">.</span><span class="n">Identity</span><span class="p">),</span><span class="n">AlignedBox3</span><span class="p">:(</span><span class="n">Vector3</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span><span class="n">Vector3</span><span class="o">.</span><span class="n">Zero</span><span class="p">),</span><span class="n">AlignedBox2</span><span class="p">:(</span><span class="n">Vector2</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span><span class="n">Vector2</span><span class="o">.</span><span class="n">Zero</span><span class="p">),</span><span class="n">MatrixX</span><span class="p">:</span><span class="n">MatrixX</span><span class="p">(),</span><span class="n">VectorX</span><span class="p">:</span><span class="n">VectorX</span><span class="p">()}</span>

<span class="n">_attributeGuessedTypeMap</span><span class="o">=</span><span class="p">{</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">NodeList</span><span class="p">:(</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Node</span><span class="p">,),</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">ObjectList</span><span class="p">:(</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Object</span><span class="p">,)</span> <span class="p">}</span>

<div class="viewcode-block" id="hasActiveLabel"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.hasActiveLabel">[docs]</a><span class="k">def</span> <span class="nf">hasActiveLabel</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="s1">&#39;label&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span>  <span class="n">s</span><span class="o">.</span><span class="n">label</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">_getAllTraits</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">activeLabel</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="ObjQLabel"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjQLabel">[docs]</a><span class="k">class</span> <span class="nc">ObjQLabel</span><span class="p">(</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">tooltip</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">ser</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">elide</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">searchSlot</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">=</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="n">lay</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="n">lay</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qlabel</span><span class="o">=</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">=</span><span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">=</span><span class="n">ser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minWd</span><span class="o">=-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setTextToolTip</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">tooltip</span><span class="p">,</span><span class="n">elide</span><span class="o">=</span><span class="n">elide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qlabel</span><span class="o">.</span><span class="n">linkActivated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">woo</span><span class="o">.</span><span class="n">qt</span><span class="o">.</span><span class="n">openUrl</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">searchSlot</span><span class="p">:</span>
            <span class="n">le</span><span class="o">=</span><span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">le</span><span class="o">.</span><span class="n">setTextMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">le</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
            <span class="n">le</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
            <span class="n">le</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">searchSlot</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">=</span><span class="n">le</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">le</span><span class="p">)</span>
            <span class="n">lay</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qlabel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">searchSlot</span><span class="p">:</span>
            <span class="n">lay</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1">#def sizeHint(self): return QSize(self.minWd,20)</span>
    <span class="c1">#def minimumSizeHint(self): return QSize(self.minWd,20)</span>
<div class="viewcode-block" id="ObjQLabel.setColor"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjQLabel.setColor">[docs]</a>    <span class="k">def</span> <span class="nf">setColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">match</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">match</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;PaleGreen&#39;</span>
        <span class="k">elif</span> <span class="n">match</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;OrangeRed&#39;</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;QLineEdit{ background: </span><span class="si">%s</span><span class="s1">; }&#39;</span><span class="o">%</span><span class="n">color</span><span class="p">)</span></div>
<div class="viewcode-block" id="ObjQLabel.setTextToolTip"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjQLabel.setTextToolTip">[docs]</a>    <span class="k">def</span> <span class="nf">setTextToolTip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">tooltip</span><span class="p">,</span><span class="n">elide</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># ignore UnicodeDecodeError (appears sometimes under Windows), perhaps there are non-ascii characters in docstrings somewhere?</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">elide</span><span class="p">:</span>
                <span class="c1"># label is the text description; elide it at some fixed width</span>
                <span class="c1">#self.minWd=100</span>
                <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fontMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">elidedText</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">Qt</span><span class="o">.</span><span class="n">ElideRight</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">()))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
                <span class="c1">#self.minWd=60</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qlabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="c1">#self.adjustSize()</span>
            <span class="k">if</span> <span class="n">tooltip</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">qlabel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">((</span><span class="s1">&#39;&lt;b&gt;&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;&lt;/b&gt;&lt;br&gt;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">tooltip</span> <span class="k">if</span> <span class="n">tooltip</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">qlabel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span></div>
<div class="viewcode-block" id="ObjQLabel.mousePressEvent"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjQLabel.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span><span class="p">()</span><span class="o">!=</span><span class="n">Qt</span><span class="o">.</span><span class="n">MidButton</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">();</span> <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ser</span> <span class="ow">and</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AltModifier</span> <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ControlModifier</span><span class="p">):</span>
            <span class="c1"># open this object in new window</span>
            <span class="n">se</span><span class="o">=</span><span class="n">ObjectEditor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">showType</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">labelIsVar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">showChecks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">showUnits</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">objManip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">se</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="c1"># no path set</span>
        <span class="c1"># middle button clicked, paste pasteText to clipboard</span>
        <span class="n">cb</span><span class="o">=</span><span class="n">QApplication</span><span class="o">.</span><span class="n">clipboard</span><span class="p">()</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">QClipboard</span><span class="o">.</span><span class="n">Clipboard</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">QClipboard</span><span class="o">.</span><span class="n">Selection</span><span class="p">)</span> <span class="c1"># X11 global selection buffer</span>
        <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span></div></div>

<span class="k">def</span> <span class="nf">_unicodeUnit</span><span class="p">(</span><span class="n">u</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">u</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>

<div class="viewcode-block" id="makeLibraryBrowser"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.makeLibraryBrowser">[docs]</a><span class="k">def</span> <span class="nf">makeLibraryBrowser</span><span class="p">(</span><span class="n">parentmenu</span><span class="p">,</span><span class="n">callback</span><span class="p">,</span><span class="n">types</span><span class="p">,</span><span class="n">libName</span><span class="o">=</span><span class="s1">&#39;Library&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create menu under *parentmenu* named *libName*. *types* are passed to :obj:`woo.objectlibrary.checkout`. *callback* is called with chosen (name,object) as arguments.&#39;&#39;&#39;</span>
    <span class="kn">import</span> <span class="nn">woo.objectlibrary</span>
    <span class="c1"># root=parentmenu.addMenu(&#39;libName&#39;)</span>
    <span class="n">objs</span><span class="o">=</span><span class="n">woo</span><span class="o">.</span><span class="n">objectlibrary</span><span class="o">.</span><span class="n">checkout</span><span class="p">(</span><span class="n">types</span><span class="o">=</span><span class="n">types</span><span class="p">)</span>
    <span class="n">menus</span><span class="o">=</span><span class="p">{():</span><span class="n">parentmenu</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="n">libName</span><span class="p">)}</span>
    <span class="k">if</span> <span class="n">objs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="n">objs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># create submenus</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">key</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">menus</span><span class="p">:</span>
                    <span class="n">menus</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">menus</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1"># create menu item</span>
            <span class="n">item</span><span class="o">=</span><span class="n">menus</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">item</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">checked</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="n">val</span><span class="p">:</span> <span class="n">callback</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">obj</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">menus</span><span class="p">[()]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># disable library menu if there are no objects in there</span></div>




<div class="viewcode-block" id="ObjectEditor"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor">[docs]</a><span class="k">class</span> <span class="nc">ObjectEditor</span><span class="p">(</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="s2">&quot;Class displaying and modifying attributes of a woo object, or of unrelated attributes of different objects.&quot;</span>
    <span class="kn">import</span> <span class="nn">collections</span>
    <span class="kn">import</span> <span class="nn">logging</span>
    <span class="c1"># each attribute has one entry associated with itself</span>

    <span class="c1"># maximum nesting level in the UI, to avoid cycles and freezes</span>
    <span class="n">maxNest</span><span class="o">=</span><span class="mi">6</span>
    <span class="c1"># maximum length of inline lists</span>
    <span class="n">maxListLen</span><span class="o">=</span><span class="mi">40</span> 


<div class="viewcode-block" id="ObjectEditor.EntryData"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.EntryData">[docs]</a>    <span class="k">class</span> <span class="nc">EntryData</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">groupNo</span><span class="p">,</span><span class="n">trait</span><span class="p">,</span><span class="n">containingClass</span><span class="p">,</span><span class="n">editor</span><span class="p">,</span><span class="n">label</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">groupNo</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">containingClass</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">trait</span><span class="p">,</span><span class="n">groupNo</span><span class="p">,</span><span class="n">containingClass</span><span class="p">,</span><span class="n">label</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">=</span><span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span><span class="o">=</span><span class="kc">False</span> <span class="c1"># this overrides the &quot;visible&quot; attribute</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gridAndRow</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span><span class="o">=</span><span class="p">{}</span> <span class="c1">#{&#39;label&#39;:None,&#39;value&#39;:None,&#39;unit&#39;:None}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">=</span><span class="n">editor</span>
<div class="viewcode-block" id="ObjectEditor.EntryData.propertyId"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.EntryData.propertyId">[docs]</a>        <span class="k">def</span> <span class="nf">propertyId</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">id</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">containingClass</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="ObjectEditor.EntryData.unitChanged"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.EntryData.unitChanged">[docs]</a>        <span class="k">def</span> <span class="nf">unitChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ix0</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">forceBaseUnit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">unit</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">altUnits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">return</span>
            <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitLayout</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">multiUnit</span><span class="p">:</span>
                <span class="c1">#print self.name,self.containingClass.__name__,self.trait.unit</span>
                <span class="n">ix</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">forceBaseUnit</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ix</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="c1"># base unit:</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">multiplier</span><span class="o">=</span><span class="kc">None</span>
                    <span class="c1"># print(self.obj,self.containingClass,self.name)</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">multiplierChanged</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">multiplier</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">altUnits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ix</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="c1"># print 20*&#39;!&#39;,self.trait.name,self.editor</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">multiplierChanged</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> × </span><span class="si">%g</span><span class="s1"> = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">_unicodeUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">altUnits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ix</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">ix</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">w</span><span class="o">.</span><span class="n">multiplier</span><span class="p">,</span><span class="n">_unicodeUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">unit</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># multiplier is a tuple applied to each column separately</span>
                <span class="n">mult</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="p">[],[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">unit</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">altUnits</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="c1"># not empty, there is a combo box</span>
                        <span class="n">ix</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">forceBaseUnit</span> <span class="k">else</span> <span class="mi">0</span>
                        <span class="n">mult</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span> <span class="k">if</span> <span class="n">ix</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">altUnits</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">ix</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">mult</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span> <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> × </span><span class="si">%g</span><span class="s1"> = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">_unicodeUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">altUnits</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">ix</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">ix</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">mult</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">_unicodeUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">unit</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
                        <span class="k">else</span><span class="p">:</span> <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="n">w</span><span class="o">.</span><span class="n">multiplier</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">mult</span><span class="p">)</span>
                <span class="n">w</span><span class="o">.</span><span class="n">multiplierChanged</span><span class="p">(</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span></div>
<div class="viewcode-block" id="ObjectEditor.EntryData.toggleChecked"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.EntryData.toggleChecked">[docs]</a>        <span class="k">def</span> <span class="nf">toggleChecked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">checked</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="ow">not</span> <span class="n">checked</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="ow">not</span> <span class="n">checked</span><span class="p">)</span></div>
<div class="viewcode-block" id="ObjectEditor.EntryData.eval_hideIf"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.EntryData.eval_hideIf">[docs]</a>        <span class="k">def</span> <span class="nf">eval_hideIf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">hideIf</span> <span class="ow">and</span> <span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">hideIf</span><span class="p">,</span><span class="nb">globals</span><span class="p">(),{</span><span class="s1">&#39;self&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">ser</span><span class="p">})</span></div>
<div class="viewcode-block" id="ObjectEditor.EntryData.setVisible"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.EntryData.setVisible">[docs]</a>        <span class="k">def</span> <span class="nf">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">visible</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">visible</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">visible</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">visible</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visible</span><span class="o">=</span><span class="n">visible</span>
            <span class="c1"># if visible, the entry can be nevertheless hidden due to hideIf</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_hideIf</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="s1">&#39;unit&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span> <span class="ow">and</span> <span class="n">w</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]:</span> <span class="n">w</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">showUnits</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="s1">&#39;check&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span> <span class="ow">and</span> <span class="n">w</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">]:</span> <span class="n">w</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">showChecks</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div></div>
            
            
<div class="viewcode-block" id="ObjectEditor.EntryGroupData"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.EntryGroupData">[docs]</a>    <span class="k">class</span> <span class="nc">EntryGroupData</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">number</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">=</span><span class="n">number</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expander</span><span class="o">=</span><span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">style</span><span class="o">=</span><span class="n">QCommonStyle</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rightArrow</span><span class="o">=</span><span class="n">style</span><span class="o">.</span><span class="n">standardIcon</span><span class="p">(</span><span class="n">QStyle</span><span class="o">.</span><span class="n">SP_ArrowRight</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">downArrow</span> <span class="o">=</span><span class="n">style</span><span class="o">.</span><span class="n">standardIcon</span><span class="p">(</span><span class="n">QStyle</span><span class="o">.</span><span class="n">SP_ArrowDown</span><span class="p">)</span>
<div class="viewcode-block" id="ObjectEditor.EntryGroupData.makeExpander"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.EntryGroupData.makeExpander">[docs]</a>        <span class="k">def</span> <span class="nf">makeExpander</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">expanded</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expander</span><span class="o">=</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expander</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expander</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">expanded</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expander</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;text-align: left; padding: 0pt; padding-left: 6px; &#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expander</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">StrongFocus</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expander</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggleExpander</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setExpanderIcon</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expander</span></div>
<div class="viewcode-block" id="ObjectEditor.EntryGroupData.setExpanderIcon"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.EntryGroupData.setExpanderIcon">[docs]</a>        <span class="k">def</span> <span class="nf">setExpanderIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">expander</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">downArrow</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expander</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightArrow</span><span class="p">)</span></div>

<div class="viewcode-block" id="ObjectEditor.EntryGroupData.toggleExpander"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.EntryGroupData.toggleExpander">[docs]</a>        <span class="k">def</span> <span class="nf">toggleExpander</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">WidgetUpdatesDisabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expander</span><span class="o">.</span><span class="n">parentWidget</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setExpanderIcon</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
                    <span class="n">e</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expander</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span></div></div>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ser</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ignoredAttrs</span><span class="o">=</span><span class="nb">set</span><span class="p">(),</span><span class="n">objAttrLabelList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">showType</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">labelIsVar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">showChecks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">showUnits</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">objManip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">nesting</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="s2">&quot;Construct window, *ser* is the object we want to show.&quot;</span>
        <span class="c1"># print path</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">=</span><span class="n">ser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oneObject</span><span class="o">=</span><span class="n">ser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Preferred</span><span class="p">,</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
        <span class="c1">#where do widgets go in the grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;check&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span>
        <span class="c1"># set path or use label, if active (allows &#39;label&#39; attributes which don&#39;t imply automatic python variables of that name)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;woo.master.scene.lab.&#39;</span><span class="o">+</span><span class="n">ser</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">ser</span><span class="o">!=</span><span class="kc">None</span> <span class="ow">and</span> <span class="n">hasActiveLabel</span><span class="p">(</span><span class="n">ser</span><span class="p">)</span> <span class="k">else</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showType</span><span class="o">=</span><span class="n">showType</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nesting</span><span class="o">=</span><span class="n">nesting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelIsVar</span><span class="o">=</span><span class="n">labelIsVar</span> <span class="c1"># show variable name; if false, docstring is used instead</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showChecks</span><span class="o">=</span><span class="n">showChecks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showUnits</span><span class="o">=</span><span class="n">showUnits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objManip</span><span class="o">=</span><span class="n">objManip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hot</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignoredAttrs</span><span class="o">=</span><span class="n">ignoredAttrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hasSer</span><span class="o">=</span><span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">searchText</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prevSearchText</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objQLabel</span><span class="o">=</span><span class="kc">None</span>

        <span class="k">if</span> <span class="n">nesting</span><span class="o">&gt;</span><span class="n">ObjectEditor</span><span class="o">.</span><span class="n">maxNest</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mkStub</span><span class="p">()</span>
            <span class="k">return</span>
        
        <span class="k">if</span> <span class="n">objAttrLabelList</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hasSer</span><span class="o">=</span><span class="kc">False</span>
            <span class="c1"># create entries for given attributes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addListObjAttrEntries</span><span class="p">(</span><span class="n">objAttrLabelList</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># no objAttrLabelList</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;New None Object&#39;</span><span class="p">)</span>
                <span class="c1"># show None</span>
                <span class="n">lay</span><span class="o">=</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="n">lay</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">lay</span><span class="o">.</span><span class="n">setVerticalSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">lab</span><span class="o">=</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;&lt;b&gt;None&lt;/b&gt;&#39;</span><span class="p">);</span> <span class="n">lab</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Box</span><span class="p">);</span> <span class="n">lab</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Sunken</span><span class="p">);</span> <span class="n">lab</span><span class="o">.</span><span class="n">setLineWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">lab</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span><span class="p">);</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">showType</span><span class="p">:</span> <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">return</span> <span class="c1"># no timers, nothing will change at all</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;New Object of type </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">ser</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="c1"># create entries for all attributes of this object</span>
        <span class="k">if</span> <span class="n">ser</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ser</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addSerAttrEntries</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">WidgetUpdatesDisabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">mkWidgets</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshTimer</span><span class="o">=</span><span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshTimer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshTimer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>

<div class="viewcode-block" id="ObjectEditor.addListObjAttrEntries"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.addListObjAttrEntries">[docs]</a>    <span class="k">def</span> <span class="nf">addListObjAttrEntries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">objAttrLabelList</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">obj</span><span class="p">,</span><span class="n">attr</span><span class="p">,</span><span class="n">label</span> <span class="ow">in</span> <span class="n">objAttrLabelList</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Object</span><span class="p">):</span> <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not a woo.core.Object (attribtue </span><span class="si">%s</span><span class="s1"> requested)&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span><span class="n">attr</span><span class="p">))</span>
            <span class="n">ii</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">_getAllTraitsWithClasses</span><span class="p">()</span> <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">==</span><span class="n">attr</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">!=</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">ii</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Object </span><span class="si">%s</span><span class="s1"> has no attribute trait </span><span class="si">%s</span><span class="s1">.&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">attr</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Object </span><span class="si">%s</span><span class="s1"> has multiple attribute traits named </span><span class="si">%s</span><span class="s1">??&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">attr</span><span class="p">))</span>
                <span class="k">continue</span>
            <span class="n">trait</span><span class="p">,</span><span class="n">klass</span><span class="o">=</span><span class="n">ii</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addAttrEntry</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span><span class="n">trait</span><span class="o">=</span><span class="n">trait</span><span class="p">,</span><span class="n">klass</span><span class="o">=</span><span class="n">klass</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span></div>

<div class="viewcode-block" id="ObjectEditor.addSerAttrEntries"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.addSerAttrEntries">[docs]</a>    <span class="k">def</span> <span class="nf">addSerAttrEntries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">trait</span><span class="p">,</span><span class="n">klass</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">oneObject</span><span class="o">.</span><span class="n">_getAllTraitsWithClasses</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addAttrEntry</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="p">,</span><span class="n">trait</span><span class="o">=</span><span class="n">trait</span><span class="p">,</span><span class="n">klass</span><span class="o">=</span><span class="n">klass</span><span class="p">)</span></div>

<div class="viewcode-block" id="ObjectEditor.addAttrEntry"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.addAttrEntry">[docs]</a>    <span class="k">def</span> <span class="nf">addAttrEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">trait</span><span class="p">,</span><span class="n">klass</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="s1">&#39;Return attribute entry where *obj* is the parent object, *trait* is the attribute trait, *klass* is the class of the attribute (as python type; if 1-tuple, list of those types). *label* is what will be shown in the UI; if omitted, trait.name will be used by default.&#39;</span>
        <span class="k">if</span> <span class="n">trait</span><span class="o">.</span><span class="n">hidden</span> <span class="ow">or</span> <span class="n">trait</span><span class="o">.</span><span class="n">noGui</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">trait</span><span class="o">.</span><span class="n">name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">val</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span> <span class="c1"># get the value using serattt, as it might be different from what the dictionary provides (e.g. Body.blockedDOFs)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="c1"># no conversion possible</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;To-python conversion failed for </span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">!&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">trait</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="n">t</span><span class="o">=</span><span class="kc">None</span>
        <span class="n">doc</span><span class="o">=</span><span class="n">trait</span><span class="o">.</span><span class="n">doc</span>
        <span class="c1"># remove sphinx markup from docstrings</span>
        <span class="n">doc</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;:[a-zA-Z0-9_-]+:`([^`]*)`&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;&lt;i&gt;\1&lt;/i&gt;&#39;</span><span class="p">,</span><span class="n">doc</span><span class="p">)</span>
        <span class="n">doc</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;``([^`]+)``&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;&lt;tt&gt;\1&lt;/tt&gt;&#39;</span><span class="p">,</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignoredAttrs</span><span class="p">:</span> <span class="k">return</span>

        <span class="c1"># this attribute starts a new attribute group</span>
        <span class="k">if</span> <span class="n">trait</span><span class="o">.</span><span class="n">startGroup</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EntryGroupData</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="n">trait</span><span class="o">.</span><span class="n">startGroup</span><span class="p">))</span>

        <span class="c1"># determine entry type</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">t</span><span class="o">=</span><span class="n">woo</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">guessListTypeFromCxxType</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span><span class="n">trait</span><span class="p">,</span><span class="n">warnFail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">t</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,)</span> <span class="c1"># 1-tuple is list of the contained type</span>
            <span class="c1">#if not t: raise RuntimeError(&#39;Unable to guess type of &#39;+str(obj)+&#39;.&#39;+attr)</span>
        <span class="k">elif</span> <span class="n">val</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">_attributeGuessedTypeMap</span><span class="p">:</span> <span class="n">t</span><span class="o">=</span><span class="n">_attributeGuessedTypeMap</span><span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="vm">__class__</span><span class="p">]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Object</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">t</span><span class="o">=</span><span class="n">val</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># for Woo objects, determine base class if manipulation is allowed; if not, use current instance type (it can&#39;t be changed anyway) or Object (it the value is None)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objManip</span><span class="p">:</span> <span class="n">t</span><span class="o">=</span><span class="n">woo</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">guessInstanceTypeFromCxxType</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span><span class="n">trait</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">val</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span> <span class="n">t</span><span class="o">=</span><span class="n">val</span><span class="o">.</span><span class="vm">__class__</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">t</span><span class="o">=</span><span class="n">Object</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EntryGroupData</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">groupNo</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

        <span class="c1">#if not match: print &#39;No attr match for docstring of %s.%s&#39;%(obj.__class__.__name__,attr)</span>
        <span class="c1">#log.debug(&#39;Attr %s is of type %s&#39;%(attr,((t[0].__name__,) if isinstance(t,tuple) else t.__name__)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EntryData</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">groupNo</span><span class="o">=</span><span class="n">groupNo</span><span class="p">,</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">,</span><span class="n">trait</span><span class="o">=</span><span class="n">trait</span><span class="p">,</span><span class="n">containingClass</span><span class="o">=</span><span class="n">klass</span><span class="p">,</span><span class="n">editor</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">))</span></div>

<div class="viewcode-block" id="ObjectEditor.getDocstring"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.getDocstring">[docs]</a>    <span class="k">def</span> <span class="nf">getDocstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">attr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="s2">&quot;If attr is *None*, return docstring of the Object itself&quot;</span>
        <span class="k">if</span> <span class="n">attr</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oneObject</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
                <span class="n">doc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">oneObject</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__doc__</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Class </span><span class="si">%s</span><span class="s1"> __doc__ is None?&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ee</span><span class="o">=</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">doc</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="o">==</span><span class="n">attr</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ee</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No entry for attribute named </span><span class="si">%s</span><span class="s1">?&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">attr</span><span class="p">))</span>
                <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;[no documentation found]&#39;</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">doc</span><span class="o">=</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">doc</span>
        <span class="c1"># doc=re.sub(&#39;:[a-zA-Z0-9_-]+:`([^`]*)`&#39;,r&#39;&lt;i&gt;\1&lt;/i&gt;&#39;,doc)</span>
        <span class="kn">import</span> <span class="nn">textwrap</span>
        <span class="n">wrapper</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">TextWrapper</span><span class="p">(</span><span class="n">replace_whitespace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span></div>

<div class="viewcode-block" id="ObjectEditor.handleRanges"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.handleRanges">[docs]</a>    <span class="k">def</span> <span class="nf">handleRanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
        <span class="n">rg</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span>
        <span class="c1"># return editor for given attribute; no-op, unless float with associated range attribute</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="o">==</span><span class="nb">float</span> <span class="ow">and</span> <span class="n">rg</span> <span class="ow">and</span> <span class="n">rg</span><span class="o">.</span><span class="vm">__class__</span><span class="o">==</span><span class="n">Vector2</span><span class="p">:</span>
            <span class="c1"># getter returns tuple value,range</span>
            <span class="c1"># setter needs just the value itself</span>
            <span class="k">return</span> <span class="n">AttrEditor_FloatRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">),</span><span class="n">rg</span><span class="p">),</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="o">==</span><span class="nb">int</span> <span class="ow">and</span> <span class="n">rg</span> <span class="ow">and</span> <span class="n">rg</span><span class="o">.</span><span class="vm">__class__</span><span class="o">==</span><span class="n">Vector2i</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">AttrEditor_IntRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">),</span><span class="n">rg</span><span class="p">),</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
        <span class="c1"># range for sequences has the special meaning of minimum and maximum lenth; handled in SeqEditor, not here</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Invalid range object for &quot;</span><span class="o">+</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s2">&quot;: type is &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;, range is &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rg</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; (of type &quot;</span><span class="o">+</span><span class="n">rg</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="ObjectEditor.handleChoices"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.handleChoices">[docs]</a>    <span class="k">def</span> <span class="nf">handleChoices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
        <span class="c1"># choice for sequences has the special meaning of descriptions of individual items; handled in SeqEditor, not here</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
        <span class="n">choice</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">choice</span>
        <span class="k">return</span> <span class="n">AttrEditor_Choice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">),</span><span class="n">choice</span><span class="p">),</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">isColormap</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">colormap</span><span class="p">)</span></div>
<div class="viewcode-block" id="ObjectEditor.handleBits"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.handleBits">[docs]</a>    <span class="k">def</span> <span class="nf">handleBits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
        <span class="n">bits</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">bits</span>
        <span class="k">return</span> <span class="n">AttrEditor_Bits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">),</span><span class="n">bits</span><span class="p">),</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">x</span><span class="p">))</span></div>
<div class="viewcode-block" id="ObjectEditor.handleRgbColor"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.handleRgbColor">[docs]</a>    <span class="k">def</span> <span class="nf">handleRgbColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AttrEditor_RgbColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">)</span></div>
<div class="viewcode-block" id="ObjectEditor.handleFileDir"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.handleFileDir">[docs]</a>    <span class="k">def</span> <span class="nf">handleFileDir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AttrEditor_FileDir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">isDir</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">dirname</span><span class="p">,</span><span class="n">isExisting</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">existingFilename</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="ObjectEditor.mkWidget"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.mkWidget">[docs]</a>    <span class="k">def</span> <span class="nf">mkWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
            <span class="c1">#print &#39;return None for %s.%s&#39;%(entry.obj.__class__.__name__,entry.name)</span>
            <span class="k">return</span> <span class="kc">None</span>
        

        <span class="c1"># single fundamental object</span>
        <span class="n">widget</span><span class="o">=</span><span class="kc">None</span>
        <span class="c1"># default getter and setter</span>
        <span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># try to find specific widget first based on traits</span>
        <span class="c1"># these functions may return none, indicating that it won&#39;t be handled specially</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span><span class="p">:</span> <span class="n">widget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">handleRanges</span><span class="p">(</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">entry</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">choice</span><span class="p">:</span> <span class="n">widget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">handleChoices</span><span class="p">(</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">entry</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">bits</span><span class="p">:</span> <span class="n">widget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">handleBits</span><span class="p">(</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">entry</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">rgbColor</span><span class="p">:</span> <span class="n">widget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">handleRgbColor</span><span class="p">(</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">entry</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">filename</span> <span class="ow">or</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">existingFilename</span> <span class="ow">or</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">dirname</span><span class="p">:</span> <span class="n">widget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">handleFileDir</span><span class="p">(</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">entry</span><span class="p">)</span>
        <span class="c1"># no specific widget found, try one for fundamental types</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Klass</span><span class="o">=</span><span class="n">_fundamentalEditorMap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Klass</span><span class="p">:</span> <span class="n">widget</span><span class="o">=</span><span class="n">Klass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="o">=</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="o">=</span><span class="n">setter</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">widget</span><span class="p">:</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">StrongFocus</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span> <span class="n">widget</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">widget</span>

        <span class="c1"># sequences</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="vm">__class__</span><span class="o">==</span><span class="nb">tuple</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="c1"># we don&#39;t handle tuples of other lengths</span>
            <span class="c1"># sequence of serializables</span>
            <span class="n">T</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">Object</span><span class="p">)</span> <span class="ow">or</span> <span class="n">T</span><span class="o">==</span><span class="n">Object</span><span class="p">):</span>
                <span class="c1"># HACK!!!</span>
                <span class="c1"># per-instance traits for py-derived objects</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="s1">&#39;_instanceTraits&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_instanceTraits</span><span class="p">:</span>
                    <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_instanceTraits</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
                <span class="n">widget</span><span class="o">=</span><span class="n">SeqObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span><span class="n">trait</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="k">else</span> <span class="kc">None</span><span class="p">),</span><span class="n">shrink</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">nesting</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nesting</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">widget</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">T</span> <span class="ow">in</span> <span class="n">_fundamentalEditorMap</span><span class="p">):</span>
                <span class="n">widget</span><span class="o">=</span><span class="n">SeqFundamentalEditor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">widget</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No widget for (</span><span class="si">%s</span><span class="s1">,) in </span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="c1"># a woo.Object</span>
        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">Object</span><span class="p">)</span> <span class="ow">or</span> <span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="o">==</span><span class="n">Object</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="c1"># should handle the case of obj==None as well</span>
            <span class="n">widget</span><span class="o">=</span><span class="n">ObjectEditor</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">),</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">showType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">showType</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="k">else</span> <span class="kc">None</span><span class="p">),</span><span class="n">labelIsVar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labelIsVar</span><span class="p">,</span><span class="n">showChecks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">showChecks</span><span class="p">,</span><span class="n">showUnits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">showUnits</span><span class="p">,</span><span class="n">objManip</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objManip</span><span class="p">,</span><span class="n">nesting</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nesting</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Box</span><span class="p">);</span> <span class="n">widget</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Raised</span><span class="p">);</span> <span class="n">widget</span><span class="o">.</span><span class="n">setLineWidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">widget</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No widget for </span><span class="si">%s</span><span class="s1"> in </span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="ObjectEditor.serQLabelMenu"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.serQLabelMenu">[docs]</a>    <span class="k">def</span> <span class="nf">serQLabelMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">widget</span><span class="p">,</span><span class="n">position</span><span class="p">):</span>
        <span class="n">menu</span><span class="o">=</span><span class="n">QMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">toggleLabelIsVar</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Variables&#39;</span><span class="p">)</span>
        <span class="n">toggleLabelIsVar</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">);</span> <span class="n">toggleLabelIsVar</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labelIsVar</span><span class="p">)</span>
        <span class="n">toggleLabelIsVar</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleLabelIsVar</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">toggleShowChecks</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;Checks&#39;</span><span class="p">)</span>
        <span class="n">toggleShowChecks</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">);</span> <span class="n">toggleShowChecks</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showChecks</span><span class="p">)</span>
        <span class="n">toggleShowChecks</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleShowChecks</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">toggleShowUnits</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Units&#39;</span><span class="p">)</span>
        <span class="n">toggleShowUnits</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">);</span> <span class="n">toggleShowUnits</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showUnits</span><span class="p">)</span>
        <span class="n">toggleShowUnits</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleShowUnits</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasSer</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actionSave</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;⛁ Save&#39;</span><span class="p">)</span>
            <span class="n">actionSave</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="p">))</span>
            <span class="c1"># actionSave.triggered.connect(lambda obj=self.ser: self.saveObject(obj))</span>
        <span class="c1">#if self.path is not None:</span>
        <span class="c1">#    actionLoad=menu.addAction(u&#39;↥ Load&#39;)</span>
        <span class="c1">#    actionLoad.trigger.connect(lambda: self.loadObject)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">popup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapToGlobal</span><span class="p">(</span><span class="n">position</span><span class="p">))</span></div>
        <span class="c1">#print &#39;menu popped up at &#39;,widget.mapToGlobal(position),&#39; (local&#39;,position,&#39;)&#39;</span>
<div class="viewcode-block" id="ObjectEditor.saveObject"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.saveObject">[docs]</a>    <span class="k">def</span> <span class="nf">saveObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="c1"># print(&#39;saveObject&#39;,obj,arg2,arg3,arg4)</span>
        <span class="k">assert</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">f</span><span class="o">=</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Save object: use .json, .expr, .pickle, .html ...&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saving to:&#39;</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">woo</span><span class="o">.</span><span class="n">_monkey</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">Object_dump</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">),</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span><span class="n">fallbackFormat</span><span class="o">=</span><span class="s1">&#39;expr&#39;</span><span class="p">)</span></div>
    <span class="c1"># XXX: deprecated chunk</span>
    <span class="c1">#def loadObject(self):</span>
    <span class="c1">#    assert self.path</span>
    <span class="c1">#    f=QFileDialog.getOpenFileName(self,msg,&#39;.&#39;)</span>
    <span class="c1">#    if not f: return # no file selected</span>
    <span class="c1">#    try:</span>
    <span class="c1">#        if isObj: obj=entry.T.load(f) # be user friendly if garbage is being loaded</span>
    <span class="c1">#        else: obj=woo._monkey.io.Object_load(None,f)</span>
    <span class="c1">#        raise NotImplementedError(&#39;Loading objects to path is not yet implemented.&#39;)</span>
    <span class="c1">#        # get parent object (or parent sequence!) and use setattr/setitem to assign the object</span>
    <span class="c1">#        # parent=path.split(&#39;.&#39;).join(&#39;.&#39;)</span>
    <span class="c1">#        # eval(path)=obj</span>
    <span class="c1">#    except Exception as e:</span>
    <span class="c1">#        import traceback</span>
    <span class="c1">#        traceback.print_exc()</span>
    <span class="c1">#        showExceptionDialog(self,e)</span>
<div class="viewcode-block" id="ObjectEditor.getAttrLabelToolTip"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.getAttrLabelToolTip">[docs]</a>    <span class="k">def</span> <span class="nf">getAttrLabelToolTip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ini</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">ini</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">ini</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">ini</span><span class="p">,</span><span class="n">Object</span><span class="p">))</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="c1"># boost::python won&#39;t convert weak_ptr, catch it here</span>
            <span class="n">ini</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
        <span class="n">toolTip</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">containingClass</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="sa">u</span><span class="s1">&#39;.&lt;b&gt;&lt;i&gt;&#39;</span><span class="o">+</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="sa">u</span><span class="s1">&#39;&lt;/i&gt;&lt;/b&gt;&lt;br&gt;&#39;</span><span class="o">+</span><span class="n">_ensureUnicode</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">+</span><span class="sa">u</span><span class="s1">&#39;&lt;br&gt;&lt;small&gt;default: </span><span class="si">%s</span><span class="s1">&lt;/small&gt;&#39;</span><span class="o">%</span><span class="n">ini</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelIsVar</span><span class="p">:</span> <span class="k">return</span> <span class="n">woo</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">makeObjectHref</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">label</span><span class="p">),</span><span class="n">toolTip</span>
        <span class="k">return</span> <span class="n">entry</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span><span class="n">toolTip</span></div>
<div class="viewcode-block" id="ObjectEditor.toggleLabelIsVar"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.toggleLabelIsVar">[docs]</a>    <span class="k">def</span> <span class="nf">toggleLabelIsVar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelIsVar</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelIsVar</span> <span class="k">if</span> <span class="n">val</span><span class="o">==</span><span class="kc">None</span> <span class="k">else</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setTextToolTip</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getAttrLabelToolTip</span><span class="p">(</span><span class="n">entry</span><span class="p">),</span><span class="n">elide</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelIsVar</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="vm">__class__</span><span class="o">==</span><span class="n">ObjectEditor</span><span class="p">:</span>
                <span class="n">entry</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toggleLabelIsVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labelIsVar</span><span class="p">)</span></div>
<div class="viewcode-block" id="ObjectEditor.toggleShowChecks"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.toggleShowChecks">[docs]</a>    <span class="k">def</span> <span class="nf">toggleShowChecks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">WidgetUpdatesDisabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showChecks</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">showChecks</span> <span class="k">if</span> <span class="n">val</span><span class="o">==</span><span class="kc">None</span> <span class="k">else</span> <span class="n">val</span><span class="p">)</span>
            <span class="c1">#for g in self.entryGroups: g.showChecks=self.showChecks # propagate down</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">visible</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">entry</span><span class="o">.</span><span class="n">hidden</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showChecks</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;value&#39;</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="vm">__class__</span><span class="o">==</span><span class="n">ObjectEditor</span><span class="p">:</span>
                    <span class="n">entry</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toggleShowChecks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showChecks</span><span class="p">)</span></div>
<div class="viewcode-block" id="ObjectEditor.toggleShowUnits"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.toggleShowUnits">[docs]</a>    <span class="k">def</span> <span class="nf">toggleShowUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">WidgetUpdatesDisabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showUnits</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">showUnits</span> <span class="k">if</span> <span class="n">val</span><span class="o">==</span><span class="kc">None</span> <span class="k">else</span> <span class="n">val</span><span class="p">)</span>
            <span class="c1">#print self.showUnits</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
                <span class="n">entry</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">entry</span><span class="o">.</span><span class="n">unitChanged</span><span class="p">(</span><span class="n">forceBaseUnit</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">showUnits</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="vm">__class__</span><span class="o">==</span><span class="n">ObjectEditor</span><span class="p">:</span>
                    <span class="n">entry</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toggleShowUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showUnits</span><span class="p">)</span></div>
<div class="viewcode-block" id="ObjectEditor.objManipLabelMenu"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.objManipLabelMenu">[docs]</a>    <span class="k">def</span> <span class="nf">objManipLabelMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">entry</span><span class="p">,</span><span class="n">pos</span><span class="p">):</span>
        <span class="s1">&#39;context menu for creating/deleting/loading/saving woo.core.Object from within the editor&#39;</span>
        <span class="n">menu</span><span class="o">=</span><span class="n">QMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">isNone</span><span class="o">=</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">==</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># isinstance is false for None, but None is always (?) missing woo.core.Object anyway</span>
        <span class="n">isObj</span><span class="o">=</span><span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">),</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Object</span><span class="p">)</span> <span class="ow">or</span> <span class="n">isNone</span>
        <span class="n">default</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;↺ Default&#39;</span><span class="p">)</span>
        <span class="n">default</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">doObjManip</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span><span class="n">entry</span><span class="p">,</span><span class="n">isNone</span><span class="p">,</span><span class="n">isObj</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isObj</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">isNone</span><span class="p">:</span>
                <span class="n">newDel</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;☘ New&#39;</span><span class="p">)</span>
                <span class="n">newDel</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">doObjManip</span><span class="p">(</span><span class="s1">&#39;new&#39;</span><span class="p">,</span><span class="n">entry</span><span class="p">,</span><span class="n">isNone</span><span class="p">,</span><span class="n">isObj</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;☠  Delete&#39;</span><span class="p">)</span>
                <span class="n">d</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">doObjManip</span><span class="p">(</span><span class="s1">&#39;del&#39;</span><span class="p">,</span><span class="n">entry</span><span class="p">,</span><span class="n">isNone</span><span class="p">,</span><span class="n">isObj</span><span class="p">))</span>
                <span class="n">replace</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;⇄ Replace&#39;</span><span class="p">)</span>
                <span class="n">replace</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">doObjManip</span><span class="p">(</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span><span class="n">entry</span><span class="p">,</span><span class="n">isNone</span><span class="p">,</span><span class="n">isObj</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isNone</span><span class="p">:</span>
            <span class="n">save</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;⛁ Save&#39;</span><span class="p">)</span>
            <span class="n">save</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">doObjManip</span><span class="p">(</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="n">entry</span><span class="p">,</span><span class="n">isNone</span><span class="p">,</span><span class="n">isObj</span><span class="p">))</span>
        <span class="n">load</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;↥ Load&#39;</span><span class="p">)</span>
        <span class="n">load</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">doObjManip</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span><span class="n">entry</span><span class="p">,</span><span class="n">isNone</span><span class="p">,</span><span class="n">isObj</span><span class="p">))</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">makeLibraryBrowser</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span><span class="k">lambda</span> <span class="n">name</span><span class="p">,</span><span class="n">obj</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setFromLib</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">obj</span><span class="p">),</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="sa">u</span><span class="s1">&#39;⇈ Library&#39;</span><span class="p">)</span>
        <span class="c1"># put this into each varibles menus instead, as there is no the label at the top</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">showType</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasSer</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
            <span class="n">v</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Variables&#39;</span><span class="p">)</span>
            <span class="n">v</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">);</span> <span class="n">v</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labelIsVar</span><span class="p">)</span>
            <span class="n">v</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleLabelIsVar</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
            <span class="n">c</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;Checks&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">);</span> <span class="n">c</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showChecks</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleShowChecks</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
            <span class="n">u</span><span class="o">=</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Units&#39;</span><span class="p">)</span>
            <span class="n">u</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">);</span> <span class="n">u</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showUnits</span><span class="p">)</span>
            <span class="n">u</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleShowUnits</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>


        <span class="n">menu</span><span class="o">.</span><span class="n">popup</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mapToGlobal</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span></div>
<div class="viewcode-block" id="ObjectEditor.setFromLib"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.setFromLib">[docs]</a>    <span class="k">def</span> <span class="nf">setFromLib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">entry</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="c1"># setting library object</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">woo</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Object</span><span class="p">):</span> <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span> <span class="c1"># prevent lib object modification</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">obj</span><span class="p">)</span></div>
<div class="viewcode-block" id="ObjectEditor.doObjManip"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.doObjManip">[docs]</a>    <span class="k">def</span> <span class="nf">doObjManip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">entry</span><span class="p">,</span><span class="n">isNone</span><span class="p">,</span><span class="n">isObj</span><span class="p">):</span>
        <span class="s1">&#39;Handle menu action from objManipLabelMenu&#39;</span>
        <span class="c1"># FIXME: this is an ugly hack of using woo._monkey.io.Object_{dump,load} directly!!!</span>
        <span class="kn">import</span> <span class="nn">woo</span><span class="o">,</span> <span class="nn">woo.core</span><span class="o">,</span> <span class="nn">woo._monkey.io</span>
        <span class="c1">#print &#39;Manipulating Object&#39;,entry.obj.__class__.__name__+&#39;.&#39;+entry.name</span>
        <span class="k">if</span> <span class="n">action</span><span class="o">==</span><span class="s1">&#39;del&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">isObj</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">action</span><span class="o">==</span><span class="s1">&#39;new&#39;</span> <span class="ow">or</span> <span class="n">action</span><span class="o">==</span><span class="s1">&#39;replace&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">isObj</span>
            <span class="n">types</span><span class="o">=</span><span class="n">woo</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">childClasses</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">includeBase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">):</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="o">=</span><span class="n">NewObjectDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="o">.</span><span class="n">exec_</span><span class="p">():</span> <span class="k">return</span> <span class="c1"># cancelled</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">d</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">action</span><span class="o">==</span><span class="s1">&#39;save&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="n">isNone</span>
            <span class="n">obj</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">f</span><span class="o">=</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Save object: use .json, .expr, .pickle, .html ...&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="p">:</span> <span class="k">return</span>
            <span class="n">woo</span><span class="o">.</span><span class="n">_monkey</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">Object_dump</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">),</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span><span class="n">fallbackFormat</span><span class="o">=</span><span class="s1">&#39;expr&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">action</span><span class="o">==</span><span class="s1">&#39;load&#39;</span><span class="p">:</span>
            <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Load a </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">if</span> <span class="n">isObj</span> <span class="k">else</span> <span class="s1">&#39;Load&#39;</span>
            <span class="n">f</span><span class="o">=</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="p">:</span> <span class="k">return</span> <span class="c1"># no file selected</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">isObj</span><span class="p">:</span> <span class="n">obj</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="c1"># be user friendly if garbage is being loaded</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">obj</span><span class="o">=</span><span class="n">woo</span><span class="o">.</span><span class="n">_monkey</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">Object_load</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">traceback</span>
                <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
                <span class="n">showExceptionDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">action</span><span class="o">==</span><span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">isObj</span><span class="p">:</span>
                <span class="n">val</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">ini</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span> <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">ini</span><span class="o">!=</span><span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="c1"># don&#39;t call deepcopy on none, it fails :)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">copy</span>
                <span class="n">val</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">ini</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">raise</span> <span class="n">RuntimError</span><span class="p">(</span><span class="s1">&#39;Unknown action </span><span class="si">%s</span><span class="s1"> for object manipulation context menu!&#39;</span><span class="o">%</span><span class="n">action</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">()</span></div>

<div class="viewcode-block" id="ObjectEditor.mkStub"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.mkStub">[docs]</a>    <span class="k">def</span> <span class="nf">mkStub</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lay</span><span class="o">=</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setVerticalSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">lay</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;GUI nesting &gt; </span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">ObjectEditor</span><span class="o">.</span><span class="n">maxNest</span><span class="p">)),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="ObjectEditor.mkWidgets"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.mkWidgets">[docs]</a>    <span class="k">def</span> <span class="nf">mkWidgets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">onlyDefaultGroups</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">==</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">showType</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasSer</span><span class="p">:</span> <span class="c1"># create type label</span>
            <span class="n">lab</span><span class="o">=</span><span class="n">ObjQLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">makeObjectLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="p">,</span><span class="n">addr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">href</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="n">tooltip</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getDocstring</span><span class="p">(),</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="n">ser</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="p">,</span><span class="n">searchSlot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objQLabel</span><span class="o">=</span><span class="n">lab</span>
            <span class="n">lab</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Box</span><span class="p">);</span> <span class="n">lab</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Sunken</span><span class="p">);</span> <span class="n">lab</span><span class="o">.</span><span class="n">setLineWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">lab</span><span class="o">.</span><span class="n">qlabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span><span class="p">);</span> <span class="n">lab</span><span class="o">.</span><span class="n">qlabel</span><span class="o">.</span><span class="n">linkActivated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">woo</span><span class="o">.</span><span class="n">qt</span><span class="o">.</span><span class="n">openUrl</span><span class="p">)</span>
            <span class="c1">## attach context menu to the label</span>
            <span class="n">lab</span><span class="o">.</span><span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">CustomContextMenu</span><span class="p">)</span>
            <span class="n">lab</span><span class="o">.</span><span class="n">customContextMenuRequested</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">pos</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">serQLabelMenu</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span><span class="n">pos</span><span class="p">))</span>
            <span class="n">lab</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ClickFocus</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">=</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setVerticalSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">showType</span><span class="p">:</span>
            <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">lay</span><span class="o">.</span><span class="n">setRowStretch</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">lay</span><span class="p">)</span>

        <span class="n">maxLabelWd</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mkWidget</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">w</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">widget</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">w</span>
            <span class="c1"># else: print &#39;No value widget for&#39;,entry.obj.__class__.__name__+&#39;.&#39;+entry.name</span>
            <span class="c1">#entry.widgets[&#39;value&#39;]=entry.widget # for code compat</span>
            <span class="c1">#if not entry.widgets[&#39;value&#39;]: entry.widgets[&#39;value&#39;]=entry.widget=QFrame() # avoid None widgets</span>
            <span class="n">objPath</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">labelText</span><span class="p">,</span><span class="n">labelTooltip</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getAttrLabelToolTip</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="n">label</span><span class="o">=</span><span class="n">ObjQLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">labelText</span><span class="p">,</span><span class="n">tooltip</span><span class="o">=</span><span class="n">labelTooltip</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">objPath</span><span class="p">,</span><span class="n">elide</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelIsVar</span><span class="p">)</span>
            <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">label</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objManip</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;value&#39;</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">):</span>
                <span class="n">label</span><span class="o">.</span><span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">CustomContextMenu</span><span class="p">)</span>
                <span class="n">label</span><span class="o">.</span><span class="n">customContextMenuRequested</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">pos</span><span class="p">,</span><span class="n">entry</span><span class="o">=</span><span class="n">entry</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">objManipLabelMenu</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span><span class="n">pos</span><span class="p">))</span>
                <span class="n">label</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ClickFocus</span><span class="p">)</span>
            <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">QCheckBox</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">ch</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">]</span>
            <span class="n">ch</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showChecks</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span> <span class="n">ch</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ch</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">toggleChecked</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">unit</span><span class="p">:</span>
                <span class="c1"># frame for all unit-manipulating boxes</span>
                <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">unitLay</span><span class="o">=</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">])</span>
                <span class="n">entry</span><span class="o">.</span><span class="n">unitLayout</span><span class="o">=</span><span class="n">unitLay</span>
                <span class="n">unitLay</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">unitLay</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">unitLay</span><span class="p">)</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">altUnits</span><span class="p">)</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">prefUnit</span><span class="p">)</span>
                <span class="n">unitChoice</span><span class="o">=</span><span class="kc">False</span>
                <span class="k">for</span> <span class="n">unit</span><span class="p">,</span><span class="n">pref</span><span class="p">,</span><span class="n">alt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">prefUnit</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">altUnits</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">alt</span><span class="p">:</span> <span class="c1"># there are alternative units, we give choice therefore</span>
                        <span class="n">unitChoice</span><span class="o">=</span><span class="kc">True</span>
                        <span class="n">w</span><span class="o">=</span><span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                        <span class="n">w</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">_unicodeUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">))</span>
                        <span class="n">w</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">unitChanged</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">mult</span> <span class="ow">in</span> <span class="n">alt</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">_unicodeUnit</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
                        <span class="c1"># set preferred unit right away; when units are not shown, always use SI, however</span>
                        <span class="k">if</span> <span class="n">unit</span><span class="o">!=</span><span class="n">pref</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="c1"># this is checked in c++, should never fail</span>
                            <span class="c1"># print entry.trait.name,[i for i in range(len(alt)) if alt[i][0]==pref[0]]</span>
                            <span class="n">ii</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">alt</span><span class="p">))</span> <span class="k">if</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">pref</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">w</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">w</span><span class="o">=</span><span class="n">QLabel</span><span class="p">(</span><span class="n">_unicodeUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">),</span><span class="bp">self</span><span class="p">)</span>
                    <span class="n">unitLay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">unitChoice</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">unitChanged</span><span class="p">()</span> <span class="c1"># postpone calling this at the very end</span>
                <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showUnits</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">buttons</span><span class="p">:</span>
                <span class="n">bb</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">buttons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">bb</span><span class="p">),</span><span class="mi">3</span><span class="p">):</span>
                    <span class="n">b</span><span class="o">=</span><span class="n">QPushButton</span><span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="p">)</span>
                    <span class="n">l</span><span class="o">=</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fontMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">elidedText</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span><span class="n">Qt</span><span class="o">.</span><span class="n">ElideRight</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;&lt;code&gt;&#39;</span><span class="o">+</span><span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;&lt;/code&gt;&#39;</span><span class="p">)</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;QPushButton {text-align: left; padding-left:5px; }&#39;</span><span class="p">)</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoFocus</span><span class="p">)</span>
                    <span class="n">l</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">def</span> <span class="nf">callButton</span><span class="p">(</span><span class="n">cmd</span><span class="p">):</span>
                        <span class="n">exec</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">S</span><span class="o">=</span><span class="n">woo</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">scene</span><span class="p">))</span>
                    <span class="c1"># first arg (foo) used by the dispatch</span>
                    <span class="c1"># cmd=bb[i+1] binds the current value bb[i+1]</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">foo</span><span class="p">,</span><span class="n">cmd</span><span class="o">=</span><span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span> <span class="n">callButton</span><span class="p">(</span><span class="n">cmd</span><span class="p">))</span> 
                    <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;buttons-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="o">//</span><span class="mi">3</span><span class="p">)]</span><span class="o">=</span><span class="n">b</span>
                    <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;buttonLabels-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="o">//</span><span class="mi">3</span><span class="p">)]</span><span class="o">=</span><span class="n">l</span> 
                <span class="c1">#print &#39;Buttons&#39;,entry.trait.name,entry.trait.buttons,entry.widgets</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">groupNo</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="p">):</span>
            <span class="n">hide</span><span class="o">=</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">onlyDefaultGroups</span><span class="p">:</span>
                <span class="n">ex</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">makeExpander</span><span class="p">(</span><span class="ow">not</span> <span class="n">hide</span><span class="p">)</span> <span class="c1"># first group expanded, other hidden</span>
                <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span><span class="n">lay</span><span class="o">.</span><span class="n">rowCount</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">lay</span><span class="o">.</span><span class="n">setRowStretch</span><span class="p">(</span><span class="n">lay</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">entry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">entries</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">def</span> <span class="nf">addButtonsNow</span><span class="p">():</span>
                        <span class="n">bb</span><span class="p">,</span><span class="n">ll</span><span class="o">=</span><span class="nb">sorted</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;buttons-&#39;</span><span class="p">)]),</span><span class="nb">sorted</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;buttonLabels-&#39;</span><span class="p">)])</span>
                        <span class="k">for</span> <span class="n">b</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bb</span><span class="p">,</span><span class="n">ll</span><span class="p">):</span>
                            <span class="n">row</span><span class="o">=</span><span class="n">lay</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
                            <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">row</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                            <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">row</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                            <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;background: palette(</span><span class="si">%s</span><span class="s1">); &#39;</span><span class="o">%</span><span class="p">(</span><span class="s1">&#39;Base&#39;</span> <span class="k">if</span> <span class="n">row</span><span class="o">%</span><span class="mi">2</span> <span class="k">else</span> <span class="s1">&#39;AlternateBase&#39;</span><span class="p">))</span>
                    <span class="c1"># add buttons before</span>
                    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">buttons</span> <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">buttons</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span> <span class="n">addButtonsNow</span><span class="p">()</span>
                    <span class="n">row</span><span class="o">=</span><span class="n">lay</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
                    <span class="n">entry</span><span class="o">.</span><span class="n">gridAndRow</span><span class="o">=</span><span class="n">lay</span><span class="p">,</span><span class="n">row</span>
                    <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ClickFocus</span><span class="p">)</span>
                    <span class="c1"># entry.widgets[&#39;label&#39;].setFocusPolicy(Qt.NoFocus) # default</span>
                    <span class="n">maxLabelWd</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">maxLabelWd</span><span class="p">,</span><span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>
                    <span class="k">if</span> <span class="s1">&#39;value&#39;</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">:</span>
                        <span class="n">colSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="k">if</span> <span class="s1">&#39;unit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># use the unit column if there is no unit</span>
                        <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="n">colSpan</span><span class="p">)</span>
                        <span class="c1"># entry.widgets[&#39;value&#39;].setFocusPolicy(Qt.StrongFocus) # default</span>
                    <span class="k">if</span> <span class="s1">&#39;unit&#39;</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">:</span>
                        <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">])</span>
                        <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ClickFocus</span><span class="p">)</span> <span class="c1"># skip when keyboard-navigating</span>
                    <span class="n">lay</span><span class="o">.</span><span class="n">setRowStretch</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],:</span> <span class="c1"># entry.widgets[&#39;value&#39;]:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">w</span> <span class="ow">or</span> <span class="n">w</span><span class="o">.</span><span class="vm">__class__</span><span class="o">==</span><span class="n">ObjectEditor</span><span class="p">:</span> <span class="k">continue</span> <span class="c1"># nested editor not modified</span>
                        <span class="n">w</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;background: palette(</span><span class="si">%s</span><span class="s1">); &#39;</span><span class="o">%</span><span class="p">(</span><span class="s1">&#39;Base&#39;</span> <span class="k">if</span> <span class="n">row</span><span class="o">%</span><span class="mi">2</span> <span class="k">else</span> <span class="s1">&#39;AlternateBase&#39;</span><span class="p">))</span>
                    <span class="c1"># add buttons after</span>
                    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">buttons</span> <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">buttons</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span> <span class="n">addButtonsNow</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR while creating widget for entry </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">objPath</span><span class="p">))</span>
                    <span class="kn">import</span> <span class="nn">traceback</span>
                    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
        <span class="c1"># close all groups except the first one            </span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">g</span><span class="o">.</span><span class="n">toggleExpander</span><span class="p">()</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setColumnMinimumWidth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span><span class="nb">int</span><span class="p">(</span><span class="n">maxLabelWd</span><span class="p">))</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span><span class="n">lay</span><span class="o">.</span><span class="n">rowCount</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># expander at the very end</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setRowStretch</span><span class="p">(</span><span class="n">lay</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setColumnStretch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">],</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setColumnStretch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setColumnStretch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setColumnStretch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">],</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">()</span></div>

<div class="viewcode-block" id="ObjectEditor.search"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.search">[docs]</a>    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prevSearchText</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">searchText</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">searchText</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">()</span></div>

<div class="viewcode-block" id="ObjectEditor.refreshEvent"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.refreshEvent">[docs]</a>    <span class="k">def</span> <span class="nf">refreshEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">maxLabelWd</span><span class="o">=</span><span class="mf">0.</span>
        <span class="c1"># restore group visibility, since there is no search text anymore</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">searchText</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">prevSearchText</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entryGroups</span><span class="p">:</span>
                <span class="n">g</span><span class="o">.</span><span class="n">toggleExpander</span><span class="p">()</span> <span class="c1"># queries the group expander whether it is toggled or not</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prevSearchText</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objQLabel</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">searchMatches</span><span class="o">=</span><span class="mi">0</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasSer</span><span class="p">:</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">==</span><span class="n">e</span><span class="o">.</span><span class="n">obj</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">widget</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">e</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">hot</span><span class="p">:</span>
                <span class="n">maxLabelWd</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">maxLabelWd</span><span class="p">,</span><span class="n">e</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>
                <span class="c1"># if there is a new instance of Object, we need to make new widget and replace the old one completely</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span><span class="o">==</span><span class="n">ObjectEditor</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">hasSer</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">ser</span><span class="o">!=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                    <span class="c1"># print &#39;New ObjectEditor (%s): &#39;%e.name,e.widget.ser,&#39;-&gt;&#39;,getattr(e.obj,e.name)</span>
                    <span class="c1"># print e.widget.ser._cxxAddr,getattr(e.obj,e.name)._cxxAddr,getattr(e.obj,e.name)</span>
                    <span class="k">assert</span> <span class="n">e</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">ser</span><span class="o">==</span><span class="kc">None</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">==</span><span class="kc">None</span> <span class="ow">or</span> <span class="n">e</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">ser</span><span class="o">.</span><span class="n">_cxxAddr</span><span class="o">!=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">_cxxAddr</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">),</span><span class="n">woo</span><span class="o">.</span><span class="n">pyderived</span><span class="o">.</span><span class="n">PyWooObject</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">id</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span><span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">))</span><span class="o">!=</span><span class="nb">id</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">ser</span><span class="p">))</span>
                    <span class="n">e</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
                    <span class="n">e</span><span class="o">.</span><span class="n">widget</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mkWidget</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="n">grid</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">gridAndRow</span>
                    <span class="n">colSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="k">if</span> <span class="s1">&#39;unit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">widgets</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">widget</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="n">colSpan</span><span class="p">)</span>
                <span class="c1">## propagate the search to nested widgets; disabled for now, since the widget itself will be very likely disabled anyway, as the search result does not propagate upwards to us</span>
                <span class="c1"># if type(e.widget)==ObjectEditor: e.searchText=self.searchText</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">searchText</span><span class="p">:</span>
                    <span class="c1"># visibility might change if hideIf is defined</span>
                    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">hideIf</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">e</span><span class="o">.</span><span class="n">visible</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">searchText</span><span class="p">,</span><span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
                        <span class="n">searchMatches</span><span class="o">+=</span><span class="mi">1</span>
                        <span class="n">e</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">e</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">searchText</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">objQLabel</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">searchMatches</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1">#self.layout().setColumnMinimumWidth(self.gridCols[&#39;label&#39;],maxLabelWd)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelIsVar</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">setColumnStretch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">setColumnStretch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCols</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span></div>
<div class="viewcode-block" id="ObjectEditor.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.ObjectEditor.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span></div></div>

<div class="viewcode-block" id="makeObjectLabel"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.makeObjectLabel">[docs]</a><span class="k">def</span> <span class="nf">makeObjectLabel</span><span class="p">(</span><span class="n">ser</span><span class="p">,</span><span class="n">href</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">addr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">boldHref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">num</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">count</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">ret</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">num</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">count</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span> <span class="n">ret</span><span class="o">+=</span><span class="sa">u</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1">. &#39;</span><span class="o">%</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="n">count</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">ret</span><span class="o">+=</span><span class="sa">u</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">. &#39;</span><span class="o">%</span><span class="n">num</span>
    <span class="k">if</span> <span class="n">href</span><span class="p">:</span> <span class="n">ret</span><span class="o">+=</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39; &lt;b&gt;&#39;</span> <span class="k">if</span> <span class="n">boldHref</span> <span class="k">else</span> <span class="sa">u</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">+</span><span class="n">woo</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">makeObjectHref</span><span class="p">(</span><span class="n">ser</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;&lt;/b&gt; &#39;</span> <span class="k">if</span> <span class="n">boldHref</span> <span class="k">else</span> <span class="sa">u</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">ret</span><span class="o">+=</span><span class="n">ser</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s1">&#39; &#39;</span>
    <span class="k">if</span> <span class="n">hasActiveLabel</span><span class="p">(</span><span class="n">ser</span><span class="p">):</span> <span class="n">ret</span><span class="o">+=</span><span class="sa">u</span><span class="s1">&#39; “&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ser</span><span class="o">.</span><span class="n">label</span><span class="p">)</span><span class="o">+</span><span class="sa">u</span><span class="s1">&#39;”&#39;</span>
    <span class="c1"># do not show address if there is a label already</span>
    <span class="k">elif</span> <span class="n">addr</span> <span class="ow">and</span> <span class="n">ser</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">ret</span><span class="o">+=</span><span class="s1">&#39;0x</span><span class="si">%x</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">ser</span><span class="o">.</span><span class="n">_cxxAddr</span>
    <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="SeqObjectComboBox"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox">[docs]</a><span class="k">class</span> <span class="nc">SeqObjectComboBox</span><span class="p">(</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="n">maxShowLen</span><span class="o">=</span><span class="mi">500</span>
<div class="viewcode-block" id="SeqObjectComboBox.getItemType"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox.getItemType">[docs]</a>    <span class="k">def</span> <span class="nf">getItemType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">pyType</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">trait</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">shrink</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nesting</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">shrink</span><span class="o">=</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">trait</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">shrink</span>
        <span class="c1">#if not hasattr(self.trait,&#39;pyType&#39;): self.trait.pyType=(T,) # this is for compat with C++ (?)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">pyType</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">pyType</span><span class="o">=</span><span class="p">(</span><span class="n">T</span><span class="p">,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hot</span><span class="o">=</span><span class="kc">None</span> <span class="c1"># API compat with ObjectEditor</span>
        <span class="n">ll</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">ll</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">maxShowLen</span><span class="p">:</span>
            <span class="n">lab</span><span class="o">=</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;&lt;i&gt;Not showing sequence with </span><span class="si">%d</span><span class="s1"> (&amp;gt;</span><span class="si">%d</span><span class="s1">) items.&lt;/i&gt;&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">maxShowLen</span><span class="p">))</span>
            <span class="n">lay</span><span class="o">=</span><span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">lay</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">=</span><span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nesting</span><span class="o">=</span><span class="n">nesting</span>
        <span class="n">topLineFrame</span><span class="o">=</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">topLineLayout</span><span class="o">=</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="n">topLineFrame</span><span class="p">);</span>
        <span class="n">topLineFrame</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">topLineLayout</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">,</span> <span class="n">topLineLayout</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">l</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="sa">u</span><span class="s1">&#39;−&#39;</span><span class="p">,</span><span class="sa">u</span><span class="s1">&#39;↑&#39;</span><span class="p">,</span><span class="sa">u</span><span class="s1">&#39;↓&#39;</span><span class="p">)</span>
        <span class="n">tooltips</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span><span class="s1">&#39;Delete&#39;</span><span class="p">,</span><span class="s1">&#39;Move up&#39;</span><span class="p">,</span><span class="s1">&#39;Move down&#39;</span><span class="p">)</span>
        <span class="n">buttons</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newButton</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">killButton</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">upButton</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">downButton</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="n">QPushButton</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
        <span class="n">buttonSlots</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">killSlot</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">upSlot</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">downSlot</span><span class="p">)</span> <span class="c1"># same order as buttons</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">buttons</span><span class="p">):</span> <span class="n">b</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;QPushButton { font-size: 15pt; font-weight: bold; }&#39;</span><span class="p">);</span> <span class="n">b</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">25</span><span class="p">);</span> <span class="n">b</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="mi">30</span><span class="p">);</span> <span class="n">b</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">tooltips</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">=</span><span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setSizeAdjustPolicy</span><span class="p">(</span><span class="n">QComboBox</span><span class="o">.</span><span class="n">AdjustToContents</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">buttons</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="p">,]</span><span class="o">+</span><span class="n">buttons</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span> <span class="n">topLineLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">topLineFrame</span><span class="p">)</span> <span class="c1"># nested layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">=</span><span class="n">QScrollArea</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidgetResizable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seqEdit</span><span class="o">=</span><span class="kc">None</span> <span class="c1"># currently edited serializable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Box</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Raised</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLineWidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newDialog</span><span class="o">=</span><span class="kc">None</span> <span class="c1"># is set when new dialog is created, and destroyed when it returns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboItemCount</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># we use some inactive items with ranges instead of objects, so keep track of valid items separately</span>
        <span class="c1"># create menu for the &quot;new&quot; button</span>
        <span class="n">newMenu</span><span class="o">=</span><span class="n">QMenu</span><span class="p">();</span>
        <span class="n">newMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;☘ New&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">newSlot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cloneAction</span><span class="o">=</span><span class="n">newMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;≡ Clone&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cloneSlot</span><span class="p">)</span>
        <span class="n">newMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;↥ Load&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">loadSlot</span><span class="p">)</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">makeLibraryBrowser</span><span class="p">(</span><span class="n">newMenu</span><span class="p">,</span><span class="k">lambda</span> <span class="n">name</span><span class="p">,</span><span class="n">obj</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">libLoadSlot</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">obj</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">getItemType</span><span class="p">(),</span><span class="sa">u</span><span class="s1">&#39;⇈ Library&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newButton</span><span class="o">.</span><span class="n">setMenu</span><span class="p">(</span><span class="n">newMenu</span><span class="p">)</span>

        <span class="c1"># signals</span>
        <span class="k">for</span> <span class="n">b</span><span class="p">,</span><span class="n">slot</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">buttons</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">buttonSlots</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span> <span class="n">b</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboIndexSlot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">()</span>
        <span class="c1"># periodic refresh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshTimer</span><span class="o">=</span><span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshTimer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshTimer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="c1"># 1s should be enough</span>
        <span class="c1">#print &#39;SeqObject path is&#39;,self.path</span>
<div class="viewcode-block" id="SeqObjectComboBox.comboIndexSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox.comboIndexSlot">[docs]</a>    <span class="k">def</span> <span class="nf">comboIndexSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ix</span><span class="p">):</span> <span class="c1"># different seq item selected</span>
        <span class="n">currSeq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span>
        <span class="k">if</span> <span class="n">ix</span><span class="o">&gt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">):</span> <span class="c1"># this can happen with fake items which get activated when real item is deleted</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">ix</span><span class="o">=-</span><span class="mi">1</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> comboIndexSlot len=</span><span class="si">%d</span><span class="s1">, ix=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getItemType</span><span class="p">()</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">),</span><span class="n">ix</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">downButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">ix</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">ix</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">ix</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ix</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">ser</span><span class="o">=</span><span class="n">currSeq</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seqEdit</span><span class="o">=</span><span class="n">ObjectEditor</span><span class="p">(</span><span class="n">ser</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">showType</span><span class="o">=</span><span class="n">seqObjectShowType</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span><span class="n">nesting</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nesting</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqEdit</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shrink</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sizeHint</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">sizeHint</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sizePolicy</span><span class="p">()</span><span class="o">.</span><span class="n">setVerticalPolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">sizePolicy</span><span class="p">()</span><span class="o">.</span><span class="n">setVerticalPolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">seqEdit</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">+</span><span class="mi">10</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="n">QFrame</span><span class="p">())</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shrink</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">+</span><span class="mi">10</span><span class="p">);</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>
    <span class="c1"># XXX: deprecated chunk</span>
    <span class="c1"># def serLabel(self,ser,i=-1):</span>
    <span class="c1">#     return (&#39;&#39; if i&lt;0 else str(i)+&#39;. &#39;)+str(ser)[1:-1].replace(&#39;instance at &#39;,&#39;&#39;)</span>
<div class="viewcode-block" id="SeqObjectComboBox.refreshEvent"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox.refreshEvent">[docs]</a>    <span class="k">def</span> <span class="nf">refreshEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">forceIx</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">currSeq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
            <span class="n">comboEnabled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">isEnabled</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">comboEnabled</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboIndexSlot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># force refresh, otherwise would not happen from the initially empty state</span>
            <span class="n">ix</span><span class="p">,</span><span class="n">cnt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">comboItemCount</span> <span class="c1"># self.combo.count()</span>
            <span class="c1"># serializable currently being edited (which can be absent) or the one of which index is forced</span>
            <span class="n">ser</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqEdit</span><span class="o">.</span><span class="n">ser</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqEdit</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="n">forceIx</span><span class="o">&lt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">currSeq</span><span class="p">[</span><span class="n">forceIx</span><span class="p">]</span> 
            <span class="k">if</span> <span class="n">comboEnabled</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">==</span><span class="n">cnt</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ix</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ix</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ser</span><span class="o">==</span><span class="n">currSeq</span><span class="p">[</span><span class="n">ix</span><span class="p">])):</span> <span class="k">return</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">comboEnabled</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">return</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getItemType</span><span class="p">()</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s1">&#39; rebuilding list from scratch&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">prevIx</span><span class="o">=-</span><span class="mi">1</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">currSeq</span><span class="p">):</span>
                    <span class="n">extra</span><span class="o">=</span><span class="p">[]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">choice</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">choice</span><span class="p">):</span> <span class="n">extra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">choice</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&gt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">extra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;optional&#39;</span><span class="p">)</span>
                    <span class="n">extra</span><span class="o">=</span><span class="s1">&#39; (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extra</span><span class="p">))</span> <span class="k">if</span> <span class="n">extra</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">makeObjectLabel</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">),</span><span class="n">addr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">+</span><span class="n">extra</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">s</span><span class="o">==</span><span class="n">ser</span><span class="p">:</span> <span class="n">prevIx</span><span class="o">=</span><span class="n">i</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboItemCount</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                <span class="c1"># add extra (inactive, unselectable) items</span>
                <span class="c1"># when using range and descriptions</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">choice</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">choice</span><span class="p">))):</span>
                        <span class="n">extra</span><span class="o">=</span><span class="p">[]</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">choice</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">choice</span><span class="p">):</span> <span class="n">extra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">choice</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&gt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">extra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;optional&#39;</span><span class="p">)</span>
                        <span class="n">extra</span><span class="o">=</span><span class="s1">&#39; (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extra</span><span class="p">))</span> <span class="k">if</span> <span class="n">extra</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">. −&#39;</span><span class="o">%</span><span class="n">i</span><span class="o">+</span><span class="n">extra</span><span class="p">)</span>
                        <span class="c1"># use the hack from http://theworldwideinternet.blogspot.cz/2011/01/disabling-qcombobox-items.html to deactivate items</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setItemData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">forceIx</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span> <span class="n">newIx</span><span class="o">=</span><span class="n">forceIx</span> <span class="c1"># force the index (used from newSlot to make the new element active)</span>
                <span class="k">elif</span> <span class="n">prevIx</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span> <span class="n">newIx</span><span class="o">=</span><span class="n">prevIx</span> <span class="c1"># if found what was active before, use it</span>
                <span class="k">elif</span> <span class="n">ix</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span> <span class="n">newIx</span><span class="o">=</span><span class="n">ix</span>         <span class="c1"># otherwise use the previous index (e.g. after deletion)</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">newIx</span><span class="o">=</span><span class="mi">0</span>                  <span class="c1"># fallback to 0</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> setting index </span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getItemType</span><span class="p">()</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">newIx</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">newIx</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> EMPTY, setting index 0&#39;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getItemType</span><span class="p">()</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">enableKill</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">noGuiResize</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">&gt;</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">enableNew</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">noGuiResize</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">trait</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">enableClone</span><span class="o">=</span><span class="n">enableNew</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">killButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enableKill</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enableNew</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cloneAction</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enableClone</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error refreshing sequence (path </span><span class="si">%s</span><span class="s1">), ignored.&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="SeqObjectComboBox.newSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox.newSlot">[docs]</a>    <span class="k">def</span> <span class="nf">newSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># print &#39;newSlot called&#39;</span>
        <span class="n">dialog</span><span class="o">=</span><span class="n">NewObjectDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">getItemType</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">():</span> <span class="k">return</span> <span class="c1"># cancelled</span>
        <span class="n">ser</span><span class="o">=</span><span class="n">dialog</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
        <span class="n">ix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">currSeq</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">());</span> <span class="n">currSeq</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span><span class="n">ser</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> new item created at index </span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getItemType</span><span class="p">()</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">ix</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">(</span><span class="n">forceIx</span><span class="o">=</span><span class="n">ix</span><span class="p">)</span></div>
<div class="viewcode-block" id="SeqObjectComboBox.loadSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox.loadSlot">[docs]</a>    <span class="k">def</span> <span class="nf">loadSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">f</span><span class="o">=</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="p">:</span> <span class="k">return</span> <span class="c1"># no file selected</span>
        <span class="n">T</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getItemType</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="c1"># be user friendly if garbage is being loaded</span>
            <span class="c1"># else: obj=woo._monkey.io.Object_load(None,f)</span>
            <span class="n">currSeq</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">());</span> <span class="n">currSeq</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">obj</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">traceback</span>
            <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
            <span class="n">showExceptionDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">e</span><span class="p">)</span></div>
<div class="viewcode-block" id="SeqObjectComboBox.libLoadSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox.libLoadSlot">[docs]</a>    <span class="k">def</span> <span class="nf">libLoadSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="n">ix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">currSeq</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">());</span> <span class="n">currSeq</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">obj</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">(</span><span class="n">forceIx</span><span class="o">=</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span></div>
<div class="viewcode-block" id="SeqObjectComboBox.cloneSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox.cloneSlot">[docs]</a>    <span class="k">def</span> <span class="nf">cloneSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">currSeq</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">());</span> <span class="n">currSeq</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">currSeq</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">());</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">(</span><span class="n">forceIx</span><span class="o">=</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span></div>
<div class="viewcode-block" id="SeqObjectComboBox.killSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox.killSlot">[docs]</a>    <span class="k">def</span> <span class="nf">killSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">currSeq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span> <span class="k">del</span> <span class="n">currSeq</span><span class="p">[</span><span class="n">ix</span><span class="p">];</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">()</span></div>
<div class="viewcode-block" id="SeqObjectComboBox.upSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox.upSlot">[docs]</a>    <span class="k">def</span> <span class="nf">upSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">i</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">currSeq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span>
        <span class="n">prev</span><span class="p">,</span><span class="n">curr</span><span class="o">=</span><span class="n">currSeq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> <span class="n">currSeq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">currSeq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">curr</span><span class="p">,</span><span class="n">prev</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">(</span><span class="n">forceIx</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>
<div class="viewcode-block" id="SeqObjectComboBox.downSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox.downSlot">[docs]</a>    <span class="k">def</span> <span class="nf">downSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">i</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">currSeq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span> <span class="k">assert</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">curr</span><span class="p">,</span><span class="n">nxt</span><span class="o">=</span><span class="n">currSeq</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">];</span> <span class="n">currSeq</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">currSeq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">nxt</span><span class="p">,</span><span class="n">curr</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">(</span><span class="n">forceIx</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span></div>
<div class="viewcode-block" id="SeqObjectComboBox.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqObjectComboBox.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span> <span class="c1"># API compat with ObjectEditor</span></div></div>

<span class="n">SeqObject</span><span class="o">=</span><span class="n">SeqObjectComboBox</span>


<div class="viewcode-block" id="NewFundamentalDialog"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.NewFundamentalDialog">[docs]</a><span class="k">class</span> <span class="nc">NewFundamentalDialog</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">attrName</span><span class="p">,</span><span class="n">typeObj</span><span class="p">,</span><span class="n">typeStr</span><span class="p">):</span>
        <span class="n">QDialog</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (type </span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">attrName</span><span class="p">,</span><span class="n">typeStr</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">=</span><span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">=</span><span class="n">QScrollArea</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidgetResizable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">=</span><span class="n">QDialogButtonBox</span><span class="p">(</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Ok</span><span class="o">|</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">accepted</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">rejected</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reject</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowModality</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowModal</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">FakeObjClass</span><span class="p">:</span> <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakeObj</span><span class="o">=</span><span class="n">FakeObjClass</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrName</span><span class="o">=</span><span class="n">attrName</span>
        <span class="n">Klass</span><span class="o">=</span><span class="n">_fundamentalEditorMap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">typeObj</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">initValue</span><span class="o">=</span><span class="n">_fundamentalInitValues</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">typeObj</span><span class="p">,</span><span class="n">typeObj</span><span class="p">())</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fakeObj</span><span class="p">,</span><span class="n">attrName</span><span class="p">,</span><span class="n">initValue</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Klass</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">=</span><span class="n">Klass</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">fakeObj</span><span class="p">,</span><span class="n">attrName</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unable to construct new dialog for type </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">typeStr</span><span class="p">))</span>
<div class="viewcode-block" id="NewFundamentalDialog.result"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.NewFundamentalDialog.result">[docs]</a>    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fakeObj</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">attrName</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="NewObjectDialog"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.NewObjectDialog">[docs]</a><span class="k">class</span> <span class="nc">NewObjectDialog</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">baseClass</span><span class="p">,</span><span class="n">includeBase</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">woo.system</span>
        <span class="n">QDialog</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Create new object of type </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">baseClass</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">=</span><span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">=</span><span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">woo</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">childClasses</span><span class="p">(</span><span class="n">baseClass</span><span class="p">,</span><span class="n">includeBase</span><span class="o">=</span><span class="kc">False</span><span class="p">));</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">includeBase</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="n">baseClass</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="c1"># None is for the separator, so that indices are the same</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">baseClass</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">insertSeparator</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[(</span><span class="mi">2</span> <span class="k">if</span> <span class="n">includeBase</span> <span class="k">else</span> <span class="mi">0</span><span class="p">):]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboSlot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">=</span><span class="n">QScrollArea</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidgetResizable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">=</span><span class="n">QDialogButtonBox</span><span class="p">(</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Ok</span><span class="o">|</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">accepted</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">rejected</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reject</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboSlot</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowModality</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowModal</span><span class="p">)</span>
<div class="viewcode-block" id="NewObjectDialog.comboSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.NewObjectDialog.comboSlot">[docs]</a>    <span class="k">def</span> <span class="nf">comboSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">index</span><span class="p">]()</span> <span class="c1"># instantiate the class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="n">ObjectEditor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="p">,</span><span class="n">showType</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
<div class="viewcode-block" id="NewObjectDialog.result"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.NewObjectDialog.result">[docs]</a>    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ser</span></div>
<div class="viewcode-block" id="NewObjectDialog.sizeHint"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.NewObjectDialog.sizeHint">[docs]</a>    <span class="k">def</span> <span class="nf">sizeHint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="SeqFundamentalEditor"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor">[docs]</a><span class="k">class</span> <span class="nc">SeqFundamentalEditor</span><span class="p">(</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="c1"># maximum length of the sequence; show ellipsis in the middle if longer</span>
    <span class="c1"># this should avoid freezes in the UI due to unexpectedly long data</span>
    <span class="n">maxShowLen</span><span class="o">=</span><span class="mi">60</span>

    <span class="c1">#def focusInEvent(self,event):</span>
    <span class="c1">#    log.warning(&#39;SeqFundamentalEditor: focusInEvent&#39;)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">itemType</span><span class="p">):</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">itemType</span><span class="o">=</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">itemType</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">=</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">topLineFrame</span><span class="o">=</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="n">topLineLayout</span><span class="o">=</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="n">topLineFrame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">=</span><span class="n">QFormLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">setVerticalSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">setLabelAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formFrame</span><span class="o">=</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">formFrame</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formFrame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emptySeq</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convSpec</span><span class="o">=</span><span class="kc">None</span> <span class="c1"># cache value of unit conversions, for rows being added</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="o">=</span><span class="kc">None</span>
        <span class="c1"># ObjectEditor API compat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hot</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
        <span class="c1"># periodic refresh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshTimer</span><span class="o">=</span><span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshTimer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshTimer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="c1"># 1s should be enough</span>
<div class="viewcode-block" id="SeqFundamentalEditor.contextMenuEvent"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.contextMenuEvent">[docs]</a>    <span class="k">def</span> <span class="nf">contextMenuEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># may return -1, which is OK</span>
        <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">localPositionToIndex</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
        <span class="n">seq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">index</span><span class="o">=-</span><span class="mi">1</span>
        <span class="n">item</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">)</span>
        <span class="n">field</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span><span class="n">index</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">item</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">menu</span><span class="o">=</span><span class="n">QMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">actNew</span><span class="p">,</span><span class="n">actKill</span><span class="p">,</span><span class="n">actUp</span><span class="p">,</span><span class="n">actDown</span><span class="p">,</span><span class="n">actFromClip</span><span class="o">=</span><span class="p">[</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;☘ New&#39;</span><span class="p">,</span><span class="sa">u</span><span class="s1">&#39;☠ Remove&#39;</span><span class="p">,</span><span class="sa">u</span><span class="s1">&#39;↑ Up&#39;</span><span class="p">,</span><span class="sa">u</span><span class="s1">&#39;↓ Down&#39;</span><span class="p">,</span><span class="sa">u</span><span class="s1">&#39;↵ From clipboard&#39;</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">(</span><span class="n">actKill</span><span class="p">,</span><span class="n">actUp</span><span class="p">,</span><span class="n">actDown</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">actDown</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">actUp</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># disable until we figure out how to cancel when the no item in the menu is chosen</span>
        <span class="c1">#if field: field.setStyleSheet(&#39;QWidget { background: green }&#39;)</span>

        <span class="n">menu</span><span class="o">.</span><span class="n">popup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapToGlobal</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">()))</span>
        <span class="n">actNew</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">newSlot</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="n">actKill</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">killSlot</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="n">actUp</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">upSlot</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="n">actDown</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">downSlot</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="n">actFromClip</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fromClipSlot</span><span class="p">(</span><span class="n">index</span><span class="p">))</span></div>
        <span class="c1"># this does not work...?!</span>
        <span class="c1">#menu.destroyed.connect(lambda: field.setStyleSheet(&#39;QWidget { background : none }&#39;))</span>
<div class="viewcode-block" id="SeqFundamentalEditor.localPositionToIndex"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.localPositionToIndex">[docs]</a>    <span class="k">def</span> <span class="nf">localPositionToIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">isGlobal</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">gp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mapToGlobal</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">isGlobal</span> <span class="k">else</span> <span class="n">pos</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()):</span>
            <span class="n">w</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">wi</span> <span class="ow">in</span> <span class="n">w</span><span class="o">.</span><span class="n">widget</span><span class="p">(),</span><span class="n">i</span><span class="o">.</span><span class="n">widget</span><span class="p">():</span>
                <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="o">=</span><span class="n">wi</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span><span class="o">.</span><span class="n">getCoords</span><span class="p">();</span> <span class="n">globG</span><span class="o">=</span><span class="n">QRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapToGlobal</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">)),</span><span class="bp">self</span><span class="o">.</span><span class="n">mapToGlobal</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)))</span>
                <span class="k">if</span> <span class="n">globG</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">gp</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapList2Seq</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>
<div class="viewcode-block" id="SeqFundamentalEditor.keyFocusIndex"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.keyFocusIndex">[docs]</a>    <span class="k">def</span> <span class="nf">keyFocusIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">w</span><span class="o">=</span><span class="n">QApplication</span><span class="o">.</span><span class="n">focusWidget</span><span class="p">()</span>
        <span class="n">globPos</span><span class="o">=</span><span class="n">w</span><span class="o">.</span><span class="n">mapToGlobal</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">w</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span><span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">w</span><span class="o">.</span><span class="n">height</span><span class="p">()))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">localPositionToIndex</span><span class="p">(</span><span class="n">globPos</span><span class="p">,</span><span class="n">isGlobal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>
<div class="viewcode-block" id="SeqFundamentalEditor.keyPressEvent"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.keyPressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">keyPressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ev</span><span class="p">):</span>
        <span class="n">isModified</span><span class="o">=</span><span class="n">ev</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span><span class="o">&amp;</span><span class="n">Qt</span><span class="o">.</span><span class="n">AltModifier</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isModified</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">focusWidget</span><span class="p">():</span> <span class="k">return</span>
            <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">==</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Return</span><span class="p">:</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">focusWidget</span><span class="p">()</span><span class="o">.</span><span class="n">focusNextPrevChild</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">==</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Up</span><span class="p">:</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">focusWidget</span><span class="p">()</span><span class="o">.</span><span class="n">focusNextPrevChild</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">==</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Down</span><span class="p">:</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">focusWidget</span><span class="p">()</span><span class="o">.</span><span class="n">focusNextPrevChild</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">==</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Up</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">upSlot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyFocusIndex</span><span class="p">());</span> <span class="n">ev</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">==</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Down</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">downSlot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyFocusIndex</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">==</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Delete</span> <span class="ow">or</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">==</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Minus</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">killSlot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyFocusIndex</span><span class="p">())</span>
            <span class="n">ev</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">==</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Backspace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">killSlot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyFocusIndex</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ev</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">==</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Enter</span> <span class="ow">or</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">==</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Return</span> <span class="ow">or</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">==</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Plus</span><span class="p">:</span>
            <span class="c1"># insert after the current row</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newSlot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyFocusIndex</span><span class="p">())</span>
            <span class="n">ev</span><span class="o">.</span><span class="n">accept</span><span class="p">();</span></div>
<div class="viewcode-block" id="SeqFundamentalEditor.newSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.newSlot">[docs]</a>    <span class="k">def</span> <span class="nf">newSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span> <span class="c1"># i is the index AFTER which the new row is inserted</span>
        <span class="n">seq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span>
        <span class="n">seq</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">_fundamentalInitValues</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemType</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">itemType</span><span class="p">()))</span>
        <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span> <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Error setting new value </span><span class="si">{seq}</span><span class="s1">: </span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">item</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div>
<div class="viewcode-block" id="SeqFundamentalEditor.killSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.killSlot">[docs]</a>    <span class="k">def</span> <span class="nf">killSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
        <span class="n">seq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">));</span> <span class="k">del</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span> <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div>
<div class="viewcode-block" id="SeqFundamentalEditor.upSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.upSlot">[docs]</a>    <span class="k">def</span> <span class="nf">upSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">seq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span> <span class="k">assert</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">));</span>
        <span class="n">prev</span><span class="p">,</span><span class="n">curr</span><span class="o">=</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
        <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">curr</span><span class="p">,</span><span class="n">prev</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">(</span><span class="n">forceIx</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>
<div class="viewcode-block" id="SeqFundamentalEditor.downSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.downSlot">[docs]</a>    <span class="k">def</span> <span class="nf">downSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
        <span class="n">seq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">curr</span><span class="p">,</span><span class="n">nxt</span><span class="o">=</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">];</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">nxt</span><span class="p">,</span><span class="n">curr</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">(</span><span class="n">forceIx</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span></div>
<div class="viewcode-block" id="SeqFundamentalEditor.fromClipSlot"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.fromClipSlot">[docs]</a>    <span class="k">def</span> <span class="nf">fromClipSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">importables</span><span class="o">=</span><span class="p">{</span><span class="n">Vector3</span><span class="p">:(</span><span class="nb">float</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">Vector2</span><span class="p">:(</span><span class="nb">float</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Vector6</span><span class="p">:(</span><span class="nb">float</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">Vector2i</span><span class="p">:(</span><span class="nb">int</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Vector2i</span><span class="p">:(</span><span class="nb">int</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">Vector6i</span><span class="p">:(</span><span class="nb">int</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">Matrix3</span><span class="p">:(</span><span class="nb">float</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="nb">float</span><span class="p">:(</span><span class="nb">float</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">int</span><span class="p">:(</span><span class="nb">int</span><span class="p">,</span><span class="mi">1</span><span class="p">)}</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">importables</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Type </span><span class="si">%s</span><span class="s2"> is not text-importable&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemType</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
            <span class="n">elementType</span><span class="p">,</span><span class="n">lineLen</span><span class="o">=</span><span class="n">importables</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">itemType</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Will import lines with </span><span class="si">%d</span><span class="s1"> item(s) of type </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">lineLen</span><span class="p">,</span><span class="n">elementType</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
            <span class="c1"># get txt from clipboard</span>
            <span class="n">cb</span><span class="o">=</span><span class="n">QApplication</span><span class="o">.</span><span class="n">clipboard</span><span class="p">()</span>
            <span class="n">txt</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">cb</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Got </span><span class="si">%d</span><span class="s1"> lines from clipboard:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">txt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))),</span><span class="n">txt</span><span class="p">)</span>
            <span class="c1"># handle unit conversions here</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">mult</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">mult</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">]</span><span class="o">*</span><span class="n">lineLen</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Input will be scaled by&#39;</span><span class="p">,</span><span class="n">mult</span><span class="p">,</span><span class="s1">&#39; to match selected units&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">mult</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">]</span><span class="o">*</span><span class="n">lineLen</span>
            <span class="c1">#</span>
            <span class="n">seq</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ll</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">txt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)):</span>
                <span class="n">l</span><span class="o">=</span><span class="n">ll</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">continue</span> <span class="c1"># skip empty lines</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">!=</span><span class="n">lineLen</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Line </span><span class="si">%d</span><span class="s2"> has </span><span class="si">%d</span><span class="s2"> elements (should have </span><span class="si">%d</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">),</span><span class="n">lineLen</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Line tuple is&#39;</span><span class="p">,</span><span class="nb">tuple</span><span class="p">([</span><span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]))</span>
                <span class="n">lineItems</span><span class="o">=</span><span class="p">[</span><span class="n">elementType</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">val</span><span class="p">))</span><span class="o">*</span><span class="n">mult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l</span><span class="p">)]</span>
                <span class="k">if</span> <span class="n">lineLen</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span> <span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">lineItems</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lineItems</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># sequences of floats/ints are imported as sequence, not as sequence of tuples</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Imported sequence&#39;</span><span class="p">,</span><span class="n">seq</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">traceback</span>
            <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
            <span class="n">showExceptionDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">(</span><span class="n">forceIx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>
<div class="viewcode-block" id="SeqFundamentalEditor.mapList2Seq"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.mapList2Seq">[docs]</a>    <span class="k">def</span> <span class="nf">mapList2Seq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
        <span class="s1">&#39;return sequence (object) index from given list (widget) index.&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">:</span> <span class="k">return</span> <span class="n">l</span>
        <span class="k">if</span> <span class="n">l</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="k">return</span> <span class="n">l</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># 1 for the separator widget</span></div>
<div class="viewcode-block" id="SeqFundamentalEditor.mapSeq2List"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.mapSeq2List">[docs]</a>    <span class="k">def</span> <span class="nf">mapSeq2List</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s</span><span class="p">):</span>
        <span class="s1">&#39;return list (widget) index from given sequence (object) index. Return -1 if the item is not shown in the UI due to splitting.&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="k">return</span> <span class="n">s</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">&gt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="k">return</span> <span class="n">s</span><span class="o">+</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span> <span class="c1"># 1 for the separator widget</span></div>
<div class="viewcode-block" id="SeqFundamentalEditor.recomputeSplit"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.recomputeSplit">[docs]</a>    <span class="k">def</span> <span class="nf">recomputeSplit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">currLen</span><span class="p">):</span>
        <span class="n">l</span><span class="o">=</span><span class="n">currLen</span><span class="p">;</span> <span class="n">ml</span><span class="o">=</span><span class="n">SeqFundamentalEditor</span><span class="o">.</span><span class="n">maxShowLen</span>
        <span class="k">if</span> <span class="n">l</span><span class="o">&gt;</span><span class="n">ml</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">=</span><span class="p">(</span><span class="n">ml</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">l</span><span class="o">-</span><span class="n">ml</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">splitLen</span><span class="o">=</span><span class="n">l</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">=</span><span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">splitLen</span><span class="o">=</span><span class="mi">0</span></div>

<div class="viewcode-block" id="SeqFundamentalEditor.renumber"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.renumber">[docs]</a>    <span class="k">def</span> <span class="nf">renumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">currLen</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">:</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recomputeSplit</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()):</span>
            <span class="n">l</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">)</span>
            <span class="n">l</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">. &#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">mapList2Seq</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">splitLen</span><span class="o">=</span><span class="n">currLen</span></div>

<div class="viewcode-block" id="SeqFundamentalEditor.rebuild"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.rebuild">[docs]</a>    <span class="k">def</span> <span class="nf">rebuild</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;rebuild...&#39;</span><span class="p">)</span>
        <span class="n">currSeq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="c1"># clear everything</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;counts {self.form.rowCount()} {self.form.count()}&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">wi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="n">wi</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">wi</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">wi</span><span class="o">.</span><span class="n">widget</span><span class="p">():</span> <span class="k">continue</span>
                <span class="n">wi</span><span class="o">.</span><span class="n">focusOutEvent</span><span class="o">=</span><span class="kc">None</span>
                <span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s1">&#39;deleting widget {wi.widget()}&#39;</span><span class="p">)</span>
                <span class="c1"># for some reason, deleting does not make the thing disappear visually; hiding does, however</span>
                <span class="c1"># FIXME: this might be the reason why ever-resizing sequences eat up RAM!!</span>
                <span class="n">widget</span><span class="o">=</span><span class="n">wi</span><span class="o">.</span><span class="n">widget</span><span class="p">();</span> <span class="n">widget</span><span class="o">.</span><span class="n">hide</span><span class="p">();</span> <span class="k">del</span> <span class="n">widget</span> 
            <span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;counts after {self.form.rowCount()} {self.form.count()}&#39;</span><span class="p">)</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1">#for row in range(self.form.rowCount()): row.</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;cleared&#39;</span><span class="p">)</span>
        <span class="c1"># add everything</span>
        <span class="n">Klass</span><span class="o">=</span><span class="n">_fundamentalEditorMap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemType</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Klass</span><span class="p">:</span>
            <span class="n">errMsg</span><span class="o">=</span><span class="n">QTextEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">errMsg</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">);</span> <span class="n">errMsg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Sorry, editing sequences of </span><span class="si">%s</span><span class="s2">&#39;s is not (yet?) implemented.&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemType</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">insertRow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;&lt;b&gt;Error&lt;/b&gt;&#39;</span><span class="p">,</span><span class="n">errMsg</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">class</span> <span class="nc">ItemGetter</span><span class="p">():</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">index</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">getter</span><span class="p">,</span><span class="n">index</span>
            <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
        <span class="k">class</span> <span class="nc">ItemSetter</span><span class="p">():</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">index</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">getter</span><span class="p">,</span><span class="n">setter</span><span class="p">,</span><span class="n">index</span>
            <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">seq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">();</span> <span class="n">seq</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">val</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span> <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">recomputeSplit</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">currSeq</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">:</span>
                <span class="c1"># show separator</span>
                <span class="n">l</span><span class="o">=</span><span class="n">QLabel</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;&lt;b&gt;⋮&lt;/b&gt;&#39;</span><span class="p">);</span> <span class="n">l</span><span class="o">.</span><span class="n">font</span><span class="p">()</span><span class="o">.</span><span class="n">setPointSize</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">insertRow</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="sa">u</span><span class="s1">&#39;&lt;b&gt;⋮&lt;/b&gt;&#39;</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>
                <span class="k">continue</span> 
            <span class="n">li</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mapSeq2List</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="c1"># print &#39;item #%d mapped to field %d&#39;%(i,li)</span>
            <span class="k">if</span> <span class="n">li</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span> <span class="k">continue</span> <span class="c1"># in the split, do not show anything</span>
            <span class="n">widget</span><span class="o">=</span><span class="n">Klass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ItemGetter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">ItemSetter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">setter</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
            <span class="c1"># self.hijackWidgetEvents(widget)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">insertRow</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">. &#39;</span><span class="o">%</span><span class="n">li</span><span class="p">,</span><span class="n">widget</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;added item </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">widget</span><span class="p">)))</span>
            <span class="c1"># set units correctly</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">:</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">multiplier</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">multiplierChanged</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convSpec</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emptySeq</span><span class="o">=</span><span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">insertRow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;&lt;i&gt;empty&lt;/i&gt;&#39;</span><span class="p">,</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;&lt;i&gt;(right-click for menu)&lt;/i&gt;&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emptySeq</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;rebuilt, will refresh now&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshEvent</span><span class="p">(</span><span class="n">dontRebuild</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># avoid infinite recursion it the length would change meanwhile</span></div>

<div class="viewcode-block" id="SeqFundamentalEditor.refreshEvent"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.refreshEvent">[docs]</a>    <span class="k">def</span> <span class="nf">refreshEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dontRebuild</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">forceIx</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># log.warning(&#39;refreshEvent...&#39;)</span>
        <span class="n">currSeq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="c1">#print &#39;bbb&#39;,len(currSeq)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">!=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">emptySeq</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">dontRebuild</span><span class="p">:</span> <span class="k">return</span> <span class="c1"># length changed behind our back, just pretend nothing happened and update next time instead</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Sequence length not matching (data: {len(currSeq)}, form: {self.form.rowCount()}), rebuilding&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
            <span class="n">currSeq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getter</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">splitLen</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">renumber</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">currSeq</span><span class="p">)):</span>
            <span class="n">item</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">item</span><span class="p">:</span> <span class="k">continue</span> <span class="c1"># some error condition, oh well</span>
            <span class="n">widget</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>
            <span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s1">&#39;got item #</span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">widget</span><span class="p">)))</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">widget</span><span class="o">.</span><span class="n">hot</span><span class="p">:</span> <span class="c1"># it can be a QLabel as well</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">forceIx</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">forceIx</span><span class="o">==</span><span class="n">i</span><span class="p">:</span> <span class="n">widget</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div>
<div class="viewcode-block" id="SeqFundamentalEditor.refresh"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span> <span class="c1"># ObjectEditor API</span></div>
    <span class="c1"># propagate multiplier change to children</span>
<div class="viewcode-block" id="SeqFundamentalEditor.multiplierChanged"><a class="viewcode-back" href="../../../woo.qt.html#woo.qt.ObjectEditor.SeqFundamentalEditor.multiplierChanged">[docs]</a>    <span class="k">def</span> <span class="nf">multiplierChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">convSpec</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convSpec</span><span class="o">=</span><span class="n">convSpec</span> <span class="c1"># cache value should new rows be created</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">convSpec</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">QLabel</span><span class="p">):</span> <span class="k">continue</span> <span class="c1"># label that the sequence is empty</span>
            <span class="n">w</span><span class="o">.</span><span class="n">multiplier</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span>
            <span class="n">w</span><span class="o">.</span><span class="n">multiplierChanged</span><span class="p">(</span><span class="n">convSpec</span><span class="p">)</span></div></div>
    




</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../../index.html">Woo 1.0+rev1-git-681f22d documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qt.html" >woo.qt</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">woo.qt.ObjectEditor</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2012−2022, Václav Šmilauer &lt;eu@doxos.eu&gt;.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>